{"remainingRequest":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ianwow/development/aws-content-analysis/source/website/src/views/Collection.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ianwow/development/aws-content-analysis/source/website/src/views/Collection.vue","mtime":1638395687241},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/cache-loader/dist/cjs.js","mtime":1633407346687},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/thread-loader/dist/cjs.js","mtime":1633407346686},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/babel-loader/lib/index.js","mtime":1633407348173},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/cache-loader/dist/cjs.js","mtime":1633407346687},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/vue-loader/lib/index.js","mtime":1633407348650}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAnQC9jb21wb25lbnRzL0hlYWRlci52dWUnCmltcG9ydCBWaWRlb1RodW1ibmFpbCBmcm9tICdAL2NvbXBvbmVudHMvVmlkZW9UaHVtYm5haWwudnVlJwppbXBvcnQgTG9hZGluZyBmcm9tICdAL2NvbXBvbmVudHMvTG9hZGluZy52dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlJ1biIsCiAgY29tcG9uZW50czogewogICAgSGVhZGVyLAogICAgTG9hZGluZywKICAgIFZpZGVvVGh1bWJuYWlsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2hvd0VsYXN0aWNTZWFyY2hBbGVydDogZmFsc2UsCiAgICAgIHNob3dEYXRhcGxhbmVBbGVydDogZmFsc2UsCiAgICAgIHNob3dEZWxldGVkQWxlcnQ6IDAsCiAgICAgIG5vQXNzZXRzOiBudWxsLAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgcGVyUGFnZTogMTAsCiAgICAgIGlzQnVzeTogZmFsc2UsCiAgICAgIHVzZXJfZGVmaW5lZF9xdWVyeTogIiIsCiAgICAgIGFzc2V0X2xpc3Q6IFtdLAogICAgICBzb3J0Qnk6ICdDcmVhdGVkJywKICAgICAgc29ydERlc2M6IHRydWUsCiAgICAgIGZpZWxkczogWwogICAgICAgICAgewogICAgICAgICAgICAnVGh1bWJuYWlsJzogewogICAgICAgICAgICBsYWJlbDogIlRodW1ibmFpbCIsCiAgICAgICAgICAgIHNvcnRhYmxlOiBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICAnRmlsZW5hbWUnOiB7CiAgICAgICAgICAgIGxhYmVsOiAiRmlsZSBOYW1lIiwKICAgICAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgICAgIHRkQ2xhc3M6IFsidGFibGVXb3JkV3JhcCJdCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICdzdGF0dXMnOiB7CiAgICAgICAgICAgIGxhYmVsOiAiU3RhdHVzIiwKICAgICAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgICAgIHRkQ2xhc3M6IFsidGFibGVXb3JkV3JhcCJdCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAnYXNzZXRfaWQnOiB7CiAgICAgICAgICAgIGxhYmVsOiAnQXNzZXQgSUQnLAogICAgICAgICAgICBzb3J0YWJsZTogZmFsc2UsCiAgICAgICAgICAgIHRkQ2xhc3M6IFsidGFibGVXb3JkV3JhcCJdCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICdDcmVhdGVkJzogewogICAgICAgICAgICBsYWJlbDogIkNyZWF0ZWQiLAogICAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdGRDbGFzczogWyJ0YWJsZVdvcmRXcmFwIl0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgJ0FjdGlvbnMnOiB7CiAgICAgICAgICAgIGxhYmVsOiAnQWN0aW9ucycsCiAgICAgICAgICAgIHNvcnRhYmxlOiBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIF0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB0b3RhbFJvd3MoKSB7CiAgICAgIHJldHVybiB0aGlzLmFzc2V0X2xpc3QubGVuZ3RoCiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmlzQnVzeSA9IHRydWU7CiAgICB0aGlzLnJldHJpZXZlQW5kRm9ybWF0QXNzc2V0cygpCiAgfSwKICBtZXRob2RzOiB7CiAgICBvcGVuV2luZG93OiBmdW5jdGlvbiAodXJsKSB7CiAgICAgIHdpbmRvdy5vcGVuKHVybCk7CiAgICB9LAogICAgYXN5bmMgZGVsZXRlQXNzZXQoYXNzZXRJZCkgewogICAgICBsZXQgYXBpTmFtZSA9ICdtaWVEYXRhcGxhbmVBcGknCiAgICAgIGxldCBwYXRoID0gJ21ldGFkYXRhLycgKyBhc3NldElkCiAgICAgIGxldCByZXF1ZXN0T3B0cyA9IHsKICAgICAgICByZXNwb25zZTogdHJ1ZSwKICAgICAgfTsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCB0aGlzLiRBbXBsaWZ5LkFQSS5kZWwoYXBpTmFtZSwgcGF0aCwgcmVxdWVzdE9wdHMpOwogICAgICAgIHRoaXMuc2hvd0RlbGV0ZWRBbGVydCA9IDU7CiAgICAgICAgdGhpcy5hc3NldF9saXN0ID0gW107CiAgICAgICAgdGhpcy5yZXRyaWV2ZUFuZEZvcm1hdEFzc3NldHMoKQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMuc2hvd0RhdGFwbGFuZUFsZXJ0ID0gdHJ1ZQogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICB9CiAgICB9LAogICAgYXN5bmMgZWxhc3RpY3NlYXJjaFF1ZXJ5IChxdWVyeSkgewogICAgICAgICAgbGV0IGFwaU5hbWUgPSAnY29udGVudEFuYWx5c2lzRWxhc3RpY3NlYXJjaCc7CiAgICAgICAgICBsZXQgcGF0aCA9ICcvX3NlYXJjaCc7CiAgICAgICAgICBsZXQgYXBpUGFyYW1zID0gewogICAgICAgICAgICBoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30sCiAgICAgICAgICAgIGJvZHk6IHsKICAgICAgICAgICAgImFnZ3MiIDogewogICAgICAgICAgICAgICJkaXN0aW5jdF9hc3NldHMiIDogewogICAgICAgICAgICAgICAgInRlcm1zIiA6IHsgImZpZWxkIiA6ICJBc3NldElkLmtleXdvcmQiLCAic2l6ZSIgOiAxMDAwMCB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiB7J3EnOiBxdWVyeSwgJ19zb3VyY2UnOiAnQXNzZXRJZCd9CiAgICAgICAgICB9OwogICAgICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy4kQW1wbGlmeS5BUEkucG9zdChhcGlOYW1lLCBwYXRoLCBhcGlQYXJhbXMpOwogICAgICAgICAgaWYgKCFyZXNwb25zZSkgewogICAgICAgICAgICB0aGlzLnNob3dFbGFzdGljU2VhcmNoQWxlcnQgPSB0cnVlCiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdGhpcy5ub0Fzc2V0cyA9IGZhbHNlOwogICAgICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2U7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBzZWFyY2hDb2xsZWN0aW9uICgpIHsKICAgICAgICB0aGlzLm5vU2VhcmNoUmVzdWx0cyA9IGZhbHNlOwogICAgICAgIHRoaXMuaXNCdXN5ID0gdHJ1ZTsKICAgICAgICBsZXQgcXVlcnkgPSB0aGlzLnVzZXJfZGVmaW5lZF9xdWVyeTsKICAgICAgICAvLyBpZiBzZWFyY2ggaXMgZW1wdHkgc3RyaW5nIHRoZW4gZ2V0IGFzc2V0IGxpc3QgZnJvbSBkYXRhcGxhbmUgaW5zdGVhZCBvZiBFbGFzdGljc2VhcmNoLgogICAgICAgIGlmIChxdWVyeSA9PT0gIiIpIHsKICAgICAgICAgIHRoaXMuc2hvd0VsYXN0aWNTZWFyY2hBbGVydCA9IGZhbHNlOwogICAgICAgICAgdGhpcy5hc3NldF9saXN0ID0gW107CiAgICAgICAgICB0aGlzLnJldHJpZXZlQW5kRm9ybWF0QXNzc2V0cygpOwogICAgICAgICAgdGhpcy5pc0J1c3kgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAvLyBHZXQgdGhlIGxpc3Qgb2YgYXNzZXRzIHRoYXQgY29udGFpbiBtZXRhZGF0YSBtYXRjaGluZyB0aGUgdXNlci1zcGVjaWZpZWQgc2VhcmNoIHF1ZXJ5LgogICAgICAgICAgbGV0IGVsYXN0aWNEYXRhID0gYXdhaXQgdGhpcy5lbGFzdGljc2VhcmNoUXVlcnkocXVlcnkpOwogICAgICAgICAgaWYgKGVsYXN0aWNEYXRhLmhpdHMudG90YWwgPT09IDApIHsKICAgICAgICAgICAgLy8gdGhlIHNlYXJjaCByZXR1cm5lZCBubyBkYXRhCiAgICAgICAgICAgIHRoaXMuYXNzZXRfbGlzdCA9IFtdOwogICAgICAgICAgICB0aGlzLm5vU2VhcmNoUmVzdWx0cyA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuaXNCdXN5ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgbGV0IGFzc2V0cyA9IFtdOwogICAgICAgICAgICB0aGlzLmFzc2V0X2xpc3QgPSBbXTsKICAgICAgICAgICAgdGhpcy5ub1NlYXJjaFJlc3VsdHMgPSBmYWxzZTsKICAgICAgICAgICAgbGV0IGJ1Y2tldHMgPSBlbGFzdGljRGF0YS5hZ2dyZWdhdGlvbnMuZGlzdGluY3RfYXNzZXRzLmJ1Y2tldHM7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBidWNrZXRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgICAgbGV0IGFzc2V0SWQgPSBidWNrZXRzW2ldLmtleTsKICAgICAgICAgICAgICBsZXQgYXNzZXRJbmZvID0gYXdhaXQgdGhpcy5nZXRBc3NldEluZm9ybWF0aW9uKGFzc2V0SWQpOwogICAgICAgICAgICAgIGlmIChhc3NldEluZm8gIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIGFzc2V0cy5wdXNoKGFzc2V0SW5mbykKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYXNzZXRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICB0aGlzLm5vU2VhcmNoUmVzdWx0cyA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuaXNCdXN5ID0gZmFsc2UKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgewogICAgICAgICAgICB0aGlzLnB1c2hBc3NldHNUb1RhYmxlKGFzc2V0cyk7CiAgICAgICAgICAgIHRoaXMuaXNCdXN5ID0gZmFsc2UKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBnZXRBc3NldFdvcmtmbG93U3RhdHVzIChhc3NldElkKSB7CiAgICAgIGxldCBhcGlOYW1lID0gJ21pZVdvcmtmbG93QXBpJwogICAgICBsZXQgcGF0aCA9ICd3b3JrZmxvdy9leGVjdXRpb24vYXNzZXQvJyArIGFzc2V0SWQKICAgICAgbGV0IHJlcXVlc3RPcHRzID0gewogICAgICAgIHJlc3BvbnNlOiB0cnVlLAogICAgICB9OwogICAgICB0cnkgewogICAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJEFtcGxpZnkuQVBJLmdldChhcGlOYW1lLCBwYXRoLCByZXF1ZXN0T3B0cyk7CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGdldEFzc2V0VGh1bWJuYWlsIChidWNrZXQsIHMzS2V5KSB7CiAgICAgIGNvbnN0IGRhdGEgPSB7ICJTM0J1Y2tldCI6IGJ1Y2tldCwgIlMzS2V5IjogczNLZXkgfTsKICAgICAgbGV0IGFwaU5hbWUgPSAnbWllRGF0YXBsYW5lQXBpJwogICAgICBsZXQgcGF0aCA9ICdkb3dubG9hZCcKICAgICAgbGV0IHJlcXVlc3RPcHRzID0gewogICAgICAgIGJvZHk6IGRhdGEsCiAgICAgICAgcmVzcG9uc2U6IHRydWUsCiAgICAgICAgcmVzcG9uc2VUeXBlOiAndGV4dCcKICAgICAgfTsKICAgICAgdHJ5IHsKICAgICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRBbXBsaWZ5LkFQSS5wb3N0KGFwaU5hbWUsIHBhdGgsIHJlcXVlc3RPcHRzKTsKICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMuc2hvd0RhdGFwbGFuZUFsZXJ0ID0gdHJ1ZQogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICB9CiAgICB9LAogICAgYXN5bmMgZ2V0QXNzZXRJbmZvcm1hdGlvbiAoYXNzZXRJZCkgewogICAgICBsZXQgYXBpTmFtZSA9ICdtaWVEYXRhcGxhbmVBcGknCiAgICAgIGxldCBwYXRoID0gJ21ldGFkYXRhLycgKyBhc3NldElkCiAgICAgIGxldCByZXF1ZXN0T3B0cyA9IHsKICAgICAgICByZXNwb25zZTogdHJ1ZSwKICAgICAgfTsKICAgICAgdHJ5IHsKICAgICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRBbXBsaWZ5LkFQSS5nZXQoYXBpTmFtZSwgcGF0aCwgcmVxdWVzdE9wdHMpOwogICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy5zaG93RGF0YXBsYW5lQWxlcnQgPSB0cnVlCiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBmZXRjaEFzc2V0cyAoKSB7CiAgICAgIGxldCBhcGlOYW1lID0gJ21pZURhdGFwbGFuZUFwaScKICAgICAgbGV0IHBhdGggPSAnbWV0YWRhdGEnCiAgICAgIGxldCByZXF1ZXN0T3B0cyA9IHsKICAgICAgICByZXNwb25zZTogdHJ1ZSwKICAgICAgfTsKICAgICAgdHJ5IHsKICAgICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRBbXBsaWZ5LkFQSS5nZXQoYXBpTmFtZSwgcGF0aCwgcmVxdWVzdE9wdHMpOwogICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy5zaG93RGF0YXBsYW5lQWxlcnQgPSB0cnVlCiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBwdXNoQXNzZXRzVG9UYWJsZShhc3NldHMpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFzc2V0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgIHZhciBhc3NldElkOwogICAgICAgIGlmICh0eXBlb2YgYXNzZXRzW2ldID09PSAnb2JqZWN0JykgewogICAgICAgICAgLy8gSWYgdGhlIGFzc2V0IGxpc3QgaXMgY29taW5nIGZyb20gRWxhc3RpY3NlYXJjaCwgd2UgZ2V0IHRoZSBhc3NldElkIGxpa2UgdGhpczoKICAgICAgICAgIGFzc2V0SWQgPSBhc3NldHNbaV0uYXNzZXRfaWQKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gSWYgdGhlIGFzc2V0IGxpc3QgaXMgY29taW5nIGZyb20gdGhlIGRhdGFwbGFuZWFwaSwgd2UgZ2V0IHRoZSBhc3NldElkIGxpa2UgdGhpczoKICAgICAgICAgIGFzc2V0SWQgPSBhc3NldHNbaV0KICAgICAgICB9CiAgICAgICAgLy8gSW52b2tlIGFuIGFzeW5jaHJvbm91cyB0YXNrIHRvIGFkZCBhc3NldHMgdG8gdGhlIHRhYmxlIGluIHBhcmFsbGVsIHNvIHRoZSB0YWJsZSB1cGRhdGVzCiAgICAgICAgLy8gYXMgZmFzdCBhcyBwb3NzaWJsZS4gRm9yIGxhcmdlIG1lZGlhIGNvbGxlY3Rpb25zIHRoaXMgbWF5IHRha2Ugc2V2ZXJhbCBzZWNvbmRzLgogICAgICAgIHRoaXMucHVzaEFzc2V0VG9UYWJsZShhc3NldElkKQogICAgICB9CiAgICB9LAogICAgYXN5bmMgcHVzaEFzc2V0VG9UYWJsZSAoYXNzZXRJZCkgewogICAgICBjb25zdCBhc3NldEluZm8gPSBhd2FpdCB0aGlzLmdldEFzc2V0SW5mb3JtYXRpb24oYXNzZXRJZCk7CiAgICAgIGxldCBjcmVhdGVkID0gbmV3IERhdGUoMCk7CiAgICAgIGNyZWF0ZWQuc2V0VVRDU2Vjb25kcyhhc3NldEluZm8ucmVzdWx0cy5DcmVhdGVkKTsKICAgICAgY29uc3QgbWV0YWRhdGFfZm9sZGVyID0gIi9wcml2YXRlL2Fzc2V0cy8iK2Fzc2V0SWQKICAgICAgY29uc3Qgc291cmNlX2J1Y2tldCA9IGFzc2V0SW5mby5yZXN1bHRzLlMzQnVja2V0OwogICAgICBjb25zdCBzb3VyY2Vfa2V5ID0gYXNzZXRJbmZvLnJlc3VsdHMuUzNLZXk7CiAgICAgIGxldCBzM1VyaSA9ICdzMzovLycgKyB0aGlzLkRBVEFQTEFORV9CVUNLRVQgKyAnLycgKyBtZXRhZGF0YV9mb2xkZXI7CiAgICAgIGNvbnN0IGZpbGVuYW1lID0gc291cmNlX2tleS5zcGxpdCgiLyIpLnBvcCgpOwogICAgICAvLyBUaGUgdGh1bWJuYWlsIGlzIGNyZWF0ZWQgYnkgTWVkaWEgQ29udmVydCwgc2VlOgogICAgICAvLyBzb3VyY2Uvb3BlcmF0b3JzL3RodW1ibmFpbC9zdGFydF90aHVtYm5haWwucHkKICAgICAgbGV0IHRodW1ibmFpbFMzS2V5ID0gJ3ByaXZhdGUvYXNzZXRzLycgKyBhc3NldElkICsgJy8nICsgZmlsZW5hbWUuc3Vic3RyaW5nKDAsIGZpbGVuYW1lLmxhc3RJbmRleE9mKCIuIikpICsgJ190aHVtYm5haWwuMDAwMDAwMS5qcGcnOwogICAgICBsZXQgdGh1bWJuYWlsUzNCdWNrZXQgPSB0aGlzLkRBVEFQTEFORV9CVUNLRVQKICAgICAgLy8gSWYgaXQncyBhbiBpbWFnZSB0aGVuIE1lZGlhIENvbnZlcnQgd29uJ3QgY3JlYXRlIGEgdGh1bWJuYWlsLgogICAgICAvLyBJbiB0aGF0IGNhc2Ugd2UgdXNlIHRoZSB1cGxvYWRlZCBpbWFnZSBhcyB0aGUgdGh1bWJuYWlsLgogICAgICBjb25zdCBzdXBwb3J0ZWRfaW1hZ2VfdHlwZXMgPSBbIi5qcGciLCAiLmpwZWciLCAiLnRpZiIsICIudGlmZiIsICIucG5nIiwgIi5hcG5nIiwgIi5naWYiLCAiLmJtcCIsICIucyBndmciXTsKICAgICAgY29uc3QgbWVkaWFfdHlwZSA9IGZpbGVuYW1lLnN1YnN0cmluZyhmaWxlbmFtZS5sYXN0SW5kZXhPZigiLiIpKS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAoc3VwcG9ydGVkX2ltYWdlX3R5cGVzLmluY2x1ZGVzKG1lZGlhX3R5cGUpKSB7CiAgICAgICAgLy8gdXNlIHRoZSB1cGxvYWRlZCBpbWFnZSBhcyBhIHRodW1ibmFpbAogICAgICAgIHRodW1ibmFpbFMzS2V5ID0gc291cmNlX2tleTsKICAgICAgICB0aHVtYm5haWxTM0J1Y2tldCA9IHNvdXJjZV9idWNrZXQ7CiAgICAgIH0KICAgICAgbGV0IFt0aHVtYm5haWwsIHdvcmtmbG93U3RhdHVzXSA9IGF3YWl0IFByb21pc2UuYWxsKFt0aGlzLmdldEFzc2V0VGh1bWJuYWlsKHRodW1ibmFpbFMzQnVja2V0LCB0aHVtYm5haWxTM0tleSksIHRoaXMuZ2V0QXNzZXRXb3JrZmxvd1N0YXR1cyhhc3NldElkKV0pOwogICAgICBpZiAod29ya2Zsb3dTdGF0dXNbMF0gJiYgdGh1bWJuYWlsKQogICAgICB7CiAgICAgICAgdGhpcy5hc3NldF9saXN0LnB1c2goewogICAgICAgICAgYXNzZXRfaWQ6IGFzc2V0SWQsCiAgICAgICAgICBDcmVhdGVkOiBjcmVhdGVkLAogICAgICAgICAgRmlsZW5hbWU6IGZpbGVuYW1lLAogICAgICAgICAgc3RhdHVzOiB3b3JrZmxvd1N0YXR1c1swXS5TdGF0dXMsCiAgICAgICAgICBzdGF0ZV9tYWNoaW5lX2NvbnNvbGVfbGluazogImh0dHBzOi8vIiArIHRoaXMuQVdTX1JFR0lPTiArICIuY29uc29sZS5hd3MuYW1hem9uLmNvbS9zdGF0ZXMvaG9tZT9yZWdpb249IiArIHRoaXMuQVdTX1JFR0lPTiArICIjL2V4ZWN1dGlvbnMvZGV0YWlscy8iICsgd29ya2Zsb3dTdGF0dXNbMF0uU3RhdGVNYWNoaW5lRXhlY3V0aW9uQXJuLAogICAgICAgICAgczNfdXJpOiBzM1VyaSwKICAgICAgICAgIHNpZ25lZFVybDogdGh1bWJuYWlsLAogICAgICAgICAgdGh1bWJuYWlsSUQ6ICdfJyArIGFzc2V0SWQsCiAgICAgICAgICBUaHVtYm5haWw6ICcnLAogICAgICAgICAgQWN0aW9uczogJ1J1bicKICAgICAgICB9KQogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIHJldHJpZXZlQW5kRm9ybWF0QXNzc2V0cyAoKSB7CiAgICAgIGxldCBkYXRhID0gYXdhaXQgdGhpcy5mZXRjaEFzc2V0cygpOwogICAgICBsZXQgYXNzZXRzID0gZGF0YS5hc3NldHM7CiAgICAgIGlmIChhc3NldHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5ub0Fzc2V0cyA9IHRydWU7CiAgICAgICAgdGhpcy5ub1NlYXJjaFJlc3VsdHMgPSBmYWxzZTsKICAgICAgICB0aGlzLmlzQnVzeSA9IGZhbHNlOwogICAgICB9CiAgICAgIGVsc2UgewogICAgICAgIHRoaXMubm9Bc3NldHMgPSBmYWxzZTsKICAgICAgICB0aGlzLnB1c2hBc3NldHNUb1RhYmxlKGFzc2V0cyk7CiAgICAgICAgdGhpcy5pc0J1c3kgPSBmYWxzZQogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Collection.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsJA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Collection.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div class=\"headerTextBackground\">\n      <Header :is-collection-active=\"true\" />\n      <b-container fluid>\n        <b-alert\n          v-model=\"showElasticSearchAlert\"\n          variant=\"danger\"\n          dismissible\n        >\n          Elasticsearch error. Please check browser and elasticsearch access logs.\n        </b-alert>\n        <b-alert\n          v-model=\"showDataplaneAlert\"\n          variant=\"danger\"\n          dismissible\n        >\n          Dataplane Error. Please check browser and dataplane logs.\n        </b-alert>\n        <b-alert\n          v-model=\"showDeletedAlert\"\n          variant=\"success\"\n          dismissible\n          fade\n        >\n          Successfully Deleted Asset\n        </b-alert>\n        <b-row align-h=\"center\">\n          <h1>Media Collection</h1>\n        </b-row>\n        <b-row\n          align-h=\"center\"\n          class=\"tagline\"\n        >\n          <b>Discover insights in your media by searching for keywords, objects, or even people.</b>\n        </b-row>\n        <b-row\n          class=\"my-1\"\n          align-v=\"center\"\n          align-h=\"center\"\n        >\n          <b-col sm=\"5\">\n            <input\n              v-model=\"user_defined_query\"\n              type=\"text\"\n              placeholder=\"Search Collection...\"\n              @keyup.enter=\"searchCollection\"\n            >\n          </b-col>\n          <b-col sm=\"1\">\n            <b-button\n              size=\"lg\"\n              @click=\"searchCollection\"\n            >\n              Search\n            </b-button>\n          </b-col>\n        </b-row>\n      </b-container>\n    </div>\n    <b-container\n      fluid\n      class=\"resultsTable\"\n    >\n      <b-row>\n        <b-col>\n          <div>\n            <div class=\"column\">\n              <b-row class=\"my-1\">\n                <b-col>\n                  <b-table\n                    striped\n                    hover\n                    fixed\n                    responsive\n                    show-empty\n                    :fields=\"fields\"\n                    :items=\"asset_list\"\n                    :sort-by.sync=\"sortBy\"\n                    :sort-desc.sync=\"sortDesc\"\n                    :current-page=\"currentPage\"\n                    :per-page=\"perPage\"\n                  >\n                    <template #cell(Thumbnail)=\"data\">\n                      <VideoThumbnail\n                        :thumbnail-i-d=\"data.item.thumbnailID\"\n                        :signed-url=\"data.item.signedUrl\"\n                      />\n                    </template>\n                    <template #cell(Created)=\"data\">\n                      {{ data.item.Created.toLocaleDateString() }}<br>\n                      {{ data.item.Created.toLocaleTimeString() }}\n                    </template>\n                    <template #cell(status)=\"data\">\n                      <!-- open link in new tab -->\n                      <a v-if=\"data.item.status !== 'Queued'\" href=\"\" @click.stop.prevent=\"openWindow(data.item.state_machine_console_link)\">{{ data.item.status }}</a>\n                      <div v-if=\"data.item.status === 'Queued'\">\n                        {{ data.item.status }}\n                      </div>\n                    </template>\n                    <template #cell(Actions)=\"data\">\n                      <b-link\n                        :href=\"(`/analysis/${data.item.asset_id}`)\"\n                      >\n                        Analyze\n                      </b-link>\n                      <br>\n                      <b-link\n                        class=\"text-danger\"\n                        @click=\"deleteAsset(`${data.item.asset_id}`)\"\n                      >\n                        Delete\n                      </b-link>\n                    </template>\n                  </b-table>\n                  <div\n                    v-if=\"noAssets\"\n                  >\n                    <p>\n                      Looks like no assets have been uploaded! Try uploading <a href=\"upload\">here</a>.\n                    </p>\n                  </div>\n                  <div\n                    v-if=\"isBusy\"\n                    class=\"wrapper\"\n                  >\n                    <Loading v-if=\"isBusy\" />\n                    <p class=\"text-muted\">\n                      (Loading...)\n                    </p>\n                  </div>\n                </b-col>\n              </b-row>\n              <b-row align-h=\"center\">\n                <b-pagination\n                  v-model=\"currentPage\"\n                  :total-rows=\"totalRows\"\n                  :per-page=\"perPage\"\n                  class=\"my-0\"\n                />\n              </b-row>\n            </div>\n          </div>\n        </b-col>\n      </b-row>\n    </b-container>\n  </div>\n</template>\n\n<script>\n  import Header from '@/components/Header.vue'\n  import VideoThumbnail from '@/components/VideoThumbnail.vue'\n  import Loading from '@/components/Loading.vue'\n\n  export default {\n    name: \"Run\",\n    components: {\n      Header,\n      Loading,\n      VideoThumbnail\n    },\n    data() {\n      return {\n        showElasticSearchAlert: false,\n        showDataplaneAlert: false,\n        showDeletedAlert: 0,\n        noAssets: null,\n        currentPage: 1,\n        perPage: 10,\n        isBusy: false,\n        user_defined_query: \"\",\n        asset_list: [],\n        sortBy: 'Created',\n        sortDesc: true,\n        fields: [\n            {\n              'Thumbnail': {\n              label: \"Thumbnail\",\n              sortable: false\n              }\n            },\n            {\n              'Filename': {\n              label: \"File Name\",\n              sortable: true,\n              tdClass: [\"tableWordWrap\"]\n              }\n            },\n            {\n              'status': {\n              label: \"Status\",\n              sortable: true,\n              tdClass: [\"tableWordWrap\"]\n              }\n            },\n            {\n            'asset_id': {\n              label: 'Asset ID',\n              sortable: false,\n              tdClass: [\"tableWordWrap\"]\n              }\n            },\n            {\n              'Created': {\n              label: \"Created\",\n              sortable: true,\n              tdClass: [\"tableWordWrap\"]\n              }\n            },\n            {\n              'Actions': {\n              label: 'Actions',\n              sortable: false\n              }\n            }\n        ]\n      }\n    },\n    computed: {\n      totalRows() {\n        return this.asset_list.length\n      }\n    },\n    created: function () {\n      this.isBusy = true;\n      this.retrieveAndFormatAsssets()\n    },\n    methods: {\n      openWindow: function (url) {\n        window.open(url);\n      },\n      async deleteAsset(assetId) {\n        let apiName = 'mieDataplaneApi'\n        let path = 'metadata/' + assetId\n        let requestOpts = {\n          response: true,\n        };\n        try {\n          await this.$Amplify.API.del(apiName, path, requestOpts);\n          this.showDeletedAlert = 5;\n          this.asset_list = [];\n          this.retrieveAndFormatAsssets()\n        } catch (error) {\n          this.showDataplaneAlert = true\n          console.log(error)\n        }\n      },\n      async elasticsearchQuery (query) {\n            let apiName = 'contentAnalysisElasticsearch';\n            let path = '/_search';\n            let apiParams = {\n              headers: {'Content-Type': 'application/json'},\n              body: {\n              \"aggs\" : {\n                \"distinct_assets\" : {\n                  \"terms\" : { \"field\" : \"AssetId.keyword\", \"size\" : 10000 }\n                }\n                }\n              },\n              queryStringParameters: {'q': query, '_source': 'AssetId'}\n            };\n            let response = await this.$Amplify.API.post(apiName, path, apiParams);\n            if (!response) {\n              this.showElasticSearchAlert = true\n            }\n            else {\n              this.noAssets = false;\n              return await response;\n        }\n      },\n      async searchCollection () {\n          this.noSearchResults = false;\n          this.isBusy = true;\n          let query = this.user_defined_query;\n          // if search is empty string then get asset list from dataplane instead of Elasticsearch.\n          if (query === \"\") {\n            this.showElasticSearchAlert = false;\n            this.asset_list = [];\n            this.retrieveAndFormatAsssets();\n            this.isBusy = false;\n          }\n          else {\n            // Get the list of assets that contain metadata matching the user-specified search query.\n            let elasticData = await this.elasticsearchQuery(query);\n            if (elasticData.hits.total === 0) {\n              // the search returned no data\n              this.asset_list = [];\n              this.noSearchResults = true;\n              this.isBusy = false;\n            }\n            else {\n              let assets = [];\n              this.asset_list = [];\n              this.noSearchResults = false;\n              let buckets = elasticData.aggregations.distinct_assets.buckets;\n              for (var i = 0, len = buckets.length; i < len; i++) {\n                let assetId = buckets[i].key;\n                let assetInfo = await this.getAssetInformation(assetId);\n                if (assetInfo !== null) {\n                  assets.push(assetInfo)\n                }\n            }\n            if (assets.length === 0) {\n              this.noSearchResults = true;\n              this.isBusy = false\n            }\n            else {\n              this.pushAssetsToTable(assets);\n              this.isBusy = false\n            }\n          }\n        }\n      },\n      async getAssetWorkflowStatus (assetId) {\n        let apiName = 'mieWorkflowApi'\n        let path = 'workflow/execution/asset/' + assetId\n        let requestOpts = {\n          response: true,\n        };\n        try {\n          let response = await this.$Amplify.API.get(apiName, path, requestOpts);\n          return response.data\n        } catch (error) {\n          console.log(error)\n        }\n      },\n      async getAssetThumbnail (bucket, s3Key) {\n        const data = { \"S3Bucket\": bucket, \"S3Key\": s3Key };\n        let apiName = 'mieDataplaneApi'\n        let path = 'download'\n        let requestOpts = {\n          body: data,\n          response: true,\n          responseType: 'text'\n        };\n        try {\n          let response = await this.$Amplify.API.post(apiName, path, requestOpts);\n          return response.data\n        } catch (error) {\n          this.showDataplaneAlert = true\n          console.log(error)\n        }\n      },\n      async getAssetInformation (assetId) {\n        let apiName = 'mieDataplaneApi'\n        let path = 'metadata/' + assetId\n        let requestOpts = {\n          response: true,\n        };\n        try {\n          let response = await this.$Amplify.API.get(apiName, path, requestOpts);\n          return response.data\n        } catch (error) {\n          this.showDataplaneAlert = true\n          console.log(error)\n        }\n      },\n      async fetchAssets () {\n        let apiName = 'mieDataplaneApi'\n        let path = 'metadata'\n        let requestOpts = {\n          response: true,\n        };\n        try {\n          let response = await this.$Amplify.API.get(apiName, path, requestOpts);\n          return response.data\n        } catch (error) {\n          this.showDataplaneAlert = true\n          console.log(error)\n        }\n      },\n      async pushAssetsToTable(assets) {\n        for (var i = 0, len = assets.length; i < len; i++) {\n          var assetId;\n          if (typeof assets[i] === 'object') {\n            // If the asset list is coming from Elasticsearch, we get the assetId like this:\n            assetId = assets[i].asset_id\n          } else {\n            // If the asset list is coming from the dataplaneapi, we get the assetId like this:\n            assetId = assets[i]\n          }\n          // Invoke an asynchronous task to add assets to the table in parallel so the table updates\n          // as fast as possible. For large media collections this may take several seconds.\n          this.pushAssetToTable(assetId)\n        }\n      },\n      async pushAssetToTable (assetId) {\n        const assetInfo = await this.getAssetInformation(assetId);\n        let created = new Date(0);\n        created.setUTCSeconds(assetInfo.results.Created);\n        const metadata_folder = \"/private/assets/\"+assetId\n        const source_bucket = assetInfo.results.S3Bucket;\n        const source_key = assetInfo.results.S3Key;\n        let s3Uri = 's3://' + this.DATAPLANE_BUCKET + '/' + metadata_folder;\n        const filename = source_key.split(\"/\").pop();\n        // The thumbnail is created by Media Convert, see:\n        // source/operators/thumbnail/start_thumbnail.py\n        let thumbnailS3Key = 'private/assets/' + assetId + '/' + filename.substring(0, filename.lastIndexOf(\".\")) + '_thumbnail.0000001.jpg';\n        let thumbnailS3Bucket = this.DATAPLANE_BUCKET\n        // If it's an image then Media Convert won't create a thumbnail.\n        // In that case we use the uploaded image as the thumbnail.\n        const supported_image_types = [\".jpg\", \".jpeg\", \".tif\", \".tiff\", \".png\", \".apng\", \".gif\", \".bmp\", \".s gvg\"];\n        const media_type = filename.substring(filename.lastIndexOf(\".\")).toLowerCase();\n        if (supported_image_types.includes(media_type)) {\n          // use the uploaded image as a thumbnail\n          thumbnailS3Key = source_key;\n          thumbnailS3Bucket = source_bucket;\n        }\n        let [thumbnail, workflowStatus] = await Promise.all([this.getAssetThumbnail(thumbnailS3Bucket, thumbnailS3Key), this.getAssetWorkflowStatus(assetId)]);\n        if (workflowStatus[0] && thumbnail)\n        {\n          this.asset_list.push({\n            asset_id: assetId,\n            Created: created,\n            Filename: filename,\n            status: workflowStatus[0].Status,\n            state_machine_console_link: \"https://\" + this.AWS_REGION + \".console.aws.amazon.com/states/home?region=\" + this.AWS_REGION + \"#/executions/details/\" + workflowStatus[0].StateMachineExecutionArn,\n            s3_uri: s3Uri,\n            signedUrl: thumbnail,\n            thumbnailID: '_' + assetId,\n            Thumbnail: '',\n            Actions: 'Run'\n          })\n        }\n      },\n\n      async retrieveAndFormatAsssets () {\n        let data = await this.fetchAssets();\n        let assets = data.assets;\n        if (assets.length === 0) {\n          this.noAssets = true;\n          this.noSearchResults = false;\n          this.isBusy = false;\n        }\n        else {\n          this.noAssets = false;\n          this.pushAssetsToTable(assets);\n          this.isBusy = false\n        }\n      }\n    }\n  }\n</script>\n\n<style>\n  td {\n    vertical-align: middle;\n  }\n  .headerTextBackground {\n    background-color: #191918;\n    max-width: 100%;\n    height: auto;\n    padding-bottom: 1%;\n  }\n  .resultsTable {\n    padding-top: 1%;\n  }\n  h1 {\n    color: #ED900E;\n  }\n  a {\n    color: #ED900E;\n  }\n  .tagline {\n    color: white\n  }\n  .btn-orange {\n    color: #ED900E\n  }\n  .btn-red {\n    color: red\n  }\n  .tableWordWrap {\n    white-space:normal;\n    word-break:break-all;\n    overflow: hidden;\n    text-overflow:ellipsis;\n  }\n</style>\n"]}]}