{"remainingRequest":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ianwow/development/aws-content-analysis/source/website/src/views/UploadToAWSS3.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ianwow/development/aws-content-analysis/source/website/src/views/UploadToAWSS3.vue","mtime":1633712488562},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/cache-loader/dist/cjs.js","mtime":1633407346687},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/babel-loader/lib/index.js","mtime":1633407348173},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/cache-loader/dist/cjs.js","mtime":1633407346687},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/vue-loader/lib/index.js","mtime":1633407348650}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB2dWVEcm9wem9uZSBmcm9tICdAL2NvbXBvbmVudHMvdnVlLWRyb3B6b25lLnZ1ZSc7CmltcG9ydCBIZWFkZXIgZnJvbSAnQC9jb21wb25lbnRzL0hlYWRlci52dWUnCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCcKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICB2dWVEcm9wem9uZSwKICAgIEhlYWRlcgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJlc3RBcGkyOiAnJywKICAgICAgY3VybFdvcmtmbG93OiAnVmlkZW8nLAogICAgICBjdXJsV29ya2Zsb3dUeXBlczogWyJJbWFnZSIsICJWaWRlbyJdLAogICAgICBzaG93V29ya2Zsb3dTdGF0dXNBcGk6IGZhbHNlLAogICAgICBzaG93RXhlY3V0ZUFwaTogZmFsc2UsCiAgICAgIHNob3dHZW5lcmljT3BlcmF0b3JIZWxwOiBmYWxzZSwKICAgICAgcmVxdWVzdFVSTDogIiIsCiAgICAgIHJlcXVlc3RCb2R5OiAiIiwKICAgICAgcmVxdWVzdFR5cGU6ICIiLAogICAgICBmaWVsZHM6IFsKICAgICAgICB7CiAgICAgICAgICAnYXNzZXRfaWQnOiB7CiAgICAgICAgICAgIGxhYmVsOiAiQXNzZXQgSWQiLAogICAgICAgICAgICBzb3J0YWJsZTogZmFsc2UKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICdmaWxlX25hbWUnOiB7CiAgICAgICAgICAgIGxhYmVsOiAiRmlsZSBOYW1lIiwKICAgICAgICAgICAgc29ydGFibGU6IGZhbHNlCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB7ICd3b3JrZmxvd19zdGF0dXMnOiB7CiAgICAgICAgICAgIGxhYmVsOiAnV29ya2Zsb3cgU3RhdHVzJywKICAgICAgICAgICAgc29ydGFibGU6IGZhbHNlCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICBdLAogICAgICB0aHVtYm5haWxfcG9zaXRpb246IDEwLAogICAgICBpbnZhbGlkX2ZpbGVfdHlwZXM6IDAsCiAgICAgIHVwbG9hZF9pbl9wcm9ncmVzczogZmFsc2UsCiAgICAgIGVuYWJsZWRPcGVyYXRvcnM6IFsKICAgICAgICAibGFiZWxEZXRlY3Rpb24iLAogICAgICAgICJjZWxlYnJpdHlSZWNvZ25pdGlvbiIsCiAgICAgICAgInRleHREZXRlY3Rpb24iLAogICAgICAgICJjb250ZW50TW9kZXJhdGlvbiIsCiAgICAgICAgImZhY2VEZXRlY3Rpb24iLAogICAgICAgICJ0aHVtYm5haWwiLAogICAgICAgICJUcmFuc2NyaWJlVmlkZW8iLAogICAgICAgICJUcmFuc2xhdGUiLAogICAgICAgICJDb21wcmVoZW5kS2V5UGhyYXNlcyIsCiAgICAgICAgIkNvbXByZWhlbmRFbnRpdGllcyIsCiAgICAgICAgInNob3REZXRlY3Rpb24iLAogICAgICAgICJ0ZWNobmljYWxDdWVEZXRlY3Rpb24iCiAgICAgIF0sCiAgICAgIHZpZGVvT3BlcmF0b3JzOiBbCiAgICAgICAgeyB0ZXh0OiAiT2JqZWN0IERldGVjdGlvbiIsIHZhbHVlOiAibGFiZWxEZXRlY3Rpb24iIH0sCiAgICAgICAgeyB0ZXh0OiAiVGVjaG5pY2FsIEN1ZSBEZXRlY3Rpb24iLCB2YWx1ZTogInRlY2huaWNhbEN1ZURldGVjdGlvbiIgfSwKICAgICAgICB7IHRleHQ6ICJTaG90IERldGVjdGlvbiIsIHZhbHVlOiAic2hvdERldGVjdGlvbiIgfSwKICAgICAgICB7IHRleHQ6ICJDZWxlYnJpdHkgUmVjb2duaXRpb24iLCB2YWx1ZTogImNlbGVicml0eVJlY29nbml0aW9uIiB9LAogICAgICAgIHsgdGV4dDogIkNvbnRlbnQgTW9kZXJhdGlvbiIsIHZhbHVlOiAiY29udGVudE1vZGVyYXRpb24iIH0sCiAgICAgICAgeyB0ZXh0OiAiRmFjZSBEZXRlY3Rpb24iLCB2YWx1ZTogImZhY2VEZXRlY3Rpb24iIH0sCiAgICAgICAgeyB0ZXh0OiAiV29yZCBEZXRlY3Rpb24iLCB2YWx1ZTogInRleHREZXRlY3Rpb24iIH0sCiAgICAgICAgeyB0ZXh0OiAiRmFjZSBTZWFyY2giLCB2YWx1ZTogImZhY2VTZWFyY2giIH0sCiAgICAgICAgeyBodG1sOiAiR2VuZXJpYyBEYXRhIExvb2t1cCIsIHZhbHVlOiAiZ2VuZXJpY0RhdGFMb29rdXAiIH0sCiAgICAgIF0sCiAgICAgIGF1ZGlvT3BlcmF0b3JzOiBbeyB0ZXh0OiAiVHJhbnNjcmliZSIsIHZhbHVlOiAiVHJhbnNjcmliZVZpZGVvIiB9XSwKICAgICAgdGV4dE9wZXJhdG9yczogWwogICAgICAgIHsgdGV4dDogIkNvbXByZWhlbmQgS2V5IFBocmFzZXMiLCB2YWx1ZTogIkNvbXByZWhlbmRLZXlQaHJhc2VzIiB9LAogICAgICAgIHsgdGV4dDogIkNvbXByZWhlbmQgRW50aXRpZXMiLCB2YWx1ZTogIkNvbXByZWhlbmRFbnRpdGllcyIgfSwKICAgICAgICB7IHRleHQ6ICJUcmFuc2xhdGUiLCB2YWx1ZTogIlRyYW5zbGF0ZSIgfQogICAgICBdLAogICAgICBmYWNlQ29sbGVjdGlvbklkOiAiIiwKICAgICAgZ2VuZXJpY0RhdGFGaWxlbmFtZTogIiIsCiAgICAgIENvbXByZWhlbmRFbmNyeXB0aW9uOiBmYWxzZSwKICAgICAga21zS2V5SWQ6ICIiLAogICAgICB0cmFuc2NyaWJlTGFuZ3VhZ2U6ICJlbi1VUyIsCiAgICAgIHRyYW5zY3JpYmVMYW5ndWFnZXM6IFsKICAgICAgICB7dGV4dDogJ0FyYWJpYywgR3VsZicsIHZhbHVlOiAnYXItQUUnfSwKICAgICAgICB7dGV4dDogJ0FyYWJpYywgTW9kZXJuIFN0YW5kYXJkJywgdmFsdWU6ICdhci1TQSd9LAogICAgICAgIHt0ZXh0OiAnQ2hpbmVzZSBNYW5kYXJpbicsIHZhbHVlOiAnemgtQ04nfSwKICAgICAgICB7dGV4dDogJ0R1dGNoJywgdmFsdWU6ICdubC1OTCd9LAogICAgICAgIHt0ZXh0OiAnRW5nbGlzaCwgQXVzdHJhbGlhbicsIHZhbHVlOiAnZW4tQVUnfSwKICAgICAgICB7dGV4dDogJ0VuZ2xpc2gsIEJyaXRpc2gnLCB2YWx1ZTogJ2VuLUdCJ30sCiAgICAgICAge3RleHQ6ICdFbmdsaXNoLCBJbmRpYW4tYWNjZW50ZWQnLCB2YWx1ZTogJ2VuLUlOJ30sCiAgICAgICAge3RleHQ6ICdFbmdsaXNoLCBJcmlzaCcsIHZhbHVlOiAnZW4tSUUnfSwKICAgICAgICB7dGV4dDogJ0VuZ2xpc2gsIFNjb3R0aXNoJywgdmFsdWU6ICdlbi1BQid9LAogICAgICAgIHt0ZXh0OiAnRW5nbGlzaCwgVVMnLCB2YWx1ZTogJ2VuLVVTJ30sCiAgICAgICAge3RleHQ6ICdFbmdsaXNoLCBXZWxzaCcsIHZhbHVlOiAnZW4tV0wnfSwKICAgICAgICAvLyBEaXNhYmxlZCB1bnRpbCAnZmEnIHN1cHBvcnRlZCBieSBBV1MgVHJhbnNsYXRlCiAgICAgICAgLy8ge3RleHQ6ICdGYXJzaScsIHZhbHVlOiAnZmEtSVInfSwKICAgICAgICB7dGV4dDogJ0ZyZW5jaCcsIHZhbHVlOiAnZnItRlInfSwKICAgICAgICB7dGV4dDogJ0ZyZW5jaCwgQ2FuYWRpYW4nLCB2YWx1ZTogJ2ZyLUNBJ30sCiAgICAgICAge3RleHQ6ICdHZXJtYW4nLCB2YWx1ZTogJ2RlLURFJ30sCiAgICAgICAge3RleHQ6ICdHZXJtYW4sIFN3aXNzJywgdmFsdWU6ICdkZS1DSCd9LAogICAgICAgIHt0ZXh0OiAnSGVicmV3JywgdmFsdWU6ICdoZS1JTCd9LAogICAgICAgIHt0ZXh0OiAnSGluZGknLCB2YWx1ZTogJ2hpLUlOJ30sCiAgICAgICAge3RleHQ6ICdJbmRvbmVzaWFuJywgdmFsdWU6ICdpZC1JRCd9LAogICAgICAgIHt0ZXh0OiAnSXRhbGlhbicsIHZhbHVlOiAnaXQtSVQnfSwKICAgICAgICB7dGV4dDogJ0phcGFuZXNlJywgdmFsdWU6ICdqYS1KUCd9LAogICAgICAgIHt0ZXh0OiAnS29yZWFuJywgdmFsdWU6ICdrby1LUid9LAogICAgICAgIHt0ZXh0OiAnTWFsYXknLCB2YWx1ZTogJ21zLU1ZJ30sCiAgICAgICAge3RleHQ6ICdQb3J0dWd1ZXNlJywgdmFsdWU6ICdwdC1QVCd9LAogICAgICAgIHt0ZXh0OiAnUG9ydHVndWVzZSwgQnJhemlsaWFuJywgdmFsdWU6ICdwdC1CUid9LAogICAgICAgIHt0ZXh0OiAnUnVzc2lhbicsIHZhbHVlOiAncnUtUlUnfSwKICAgICAgICB7dGV4dDogJ1NwYW5pc2gnLCB2YWx1ZTogJ2VzLUVTJ30sCiAgICAgICAge3RleHQ6ICdTcGFuaXNoLCBVUycsIHZhbHVlOiAnZXMtVVMnfSwKICAgICAgICB7dGV4dDogJ1RhbWlsJywgdmFsdWU6ICd0YS1JTid9LAogICAgICAgIC8vIERpc2FibGVkIHVudGlsICd0ZScgc3VwcG9ydGVkIGJ5IEFXUyBUcmFuc2xhdGUKICAgICAgICAvLyB7dGV4dDogJ1RlbHVndScsIHZhbHVlOiAndGUtSU4nfSwKICAgICAgICB7dGV4dDogJ1R1cmtpc2gnLCB2YWx1ZTogJ3RyLVRSJ30sCiAgICAgIF0sCiAgICAgIHRyYW5zbGF0ZUxhbmd1YWdlczogWwogICAgICAgIHt0ZXh0OiAnQWZyaWthYW5zJywgdmFsdWU6ICdhZid9LAogICAgICAgIHt0ZXh0OiAnQWxiYW5pYW4nLCB2YWx1ZTogJ3NxJ30sCiAgICAgICAge3RleHQ6ICdBbWhhcmljJywgdmFsdWU6ICdhbSd9LAogICAgICAgIHt0ZXh0OiAnQXJhYmljJywgdmFsdWU6ICdhcid9LAogICAgICAgIHt0ZXh0OiAnQXplcmJhaWphbmknLCB2YWx1ZTogJ2F6J30sCiAgICAgICAge3RleHQ6ICdCZW5nYWxpJywgdmFsdWU6ICdibid9LAogICAgICAgIHt0ZXh0OiAnQm9zbmlhbicsIHZhbHVlOiAnYnMnfSwKICAgICAgICB7dGV4dDogJ0J1bGdhcmlhbicsIHZhbHVlOiAnYmcnfSwKICAgICAgICB7dGV4dDogJ0NoaW5lc2UgKFNpbXBsaWZpZWQpJywgdmFsdWU6ICd6aCd9LAogICAgICAgIC8vIEFXUyBUcmFuc2xhdGUgZG9lcyBub3Qgc3VwcG9ydCB0cmFuc2xhdGluZyBmcm9tIHpoIHRvIHpoLVRXCiAgICAgICAgLy8ge3RleHQ6ICdDaGluZXNlIChUcmFkaXRpb25hbCknLCB2YWx1ZTogJ3poLVRXJ30sCiAgICAgICAge3RleHQ6ICdDcm9hdGlhbicsIHZhbHVlOiAnaHInfSwKICAgICAgICB7dGV4dDogJ0N6ZWNoJywgdmFsdWU6ICdjcyd9LAogICAgICAgIHt0ZXh0OiAnRGFuaXNoJywgdmFsdWU6ICdkYSd9LAogICAgICAgIHt0ZXh0OiAnRGFyaScsIHZhbHVlOiAnZmEtQUYnfSwKICAgICAgICB7dGV4dDogJ0R1dGNoJywgdmFsdWU6ICdubCd9LAogICAgICAgIHt0ZXh0OiAnRW5nbGlzaCcsIHZhbHVlOiAnZW4nfSwKICAgICAgICB7dGV4dDogJ0VzdG9uaWFuJywgdmFsdWU6ICdldCd9LAogICAgICAgIHt0ZXh0OiAnRmlubmlzaCcsIHZhbHVlOiAnZmknfSwKICAgICAgICB7dGV4dDogJ0ZyZW5jaCcsIHZhbHVlOiAnZnInfSwKICAgICAgICB7dGV4dDogJ0ZyZW5jaCAoQ2FuYWRpYW4pJywgdmFsdWU6ICdmci1DQSd9LAogICAgICAgIHt0ZXh0OiAnR2VvcmdpYW4nLCB2YWx1ZTogJ2thJ30sCiAgICAgICAge3RleHQ6ICdHZXJtYW4nLCB2YWx1ZTogJ2RlJ30sCiAgICAgICAge3RleHQ6ICdHcmVlaycsIHZhbHVlOiAnZWwnfSwKICAgICAgICB7dGV4dDogJ0hhdXNhJywgdmFsdWU6ICdoYSd9LAogICAgICAgIHt0ZXh0OiAnSGVicmV3JywgdmFsdWU6ICdoZSd9LAogICAgICAgIHt0ZXh0OiAnSGluZGknLCB2YWx1ZTogJ2hpJ30sCiAgICAgICAge3RleHQ6ICdIdW5nYXJpYW4nLCB2YWx1ZTogJ2h1J30sCiAgICAgICAge3RleHQ6ICdJbmRvbmVzaWFuJywgdmFsdWU6ICdpZCd9LAogICAgICAgIHt0ZXh0OiAnSXRhbGlhbicsIHZhbHVlOiAnaXQnfSwKICAgICAgICB7dGV4dDogJ0phcGFuZXNlJywgdmFsdWU6ICdqYSd9LAogICAgICAgIHt0ZXh0OiAnS29yZWFuJywgdmFsdWU6ICdrbyd9LAogICAgICAgIHt0ZXh0OiAnTGF0dmlhbicsIHZhbHVlOiAnbHYnfSwKICAgICAgICB7dGV4dDogJ01hbGF5JywgdmFsdWU6ICdtcyd9LAogICAgICAgIHt0ZXh0OiAnTm9yd2VnaWFuJywgdmFsdWU6ICdubyd9LAogICAgICAgIHt0ZXh0OiAnUGVyc2lhbicsIHZhbHVlOiAnZmEnfSwKICAgICAgICB7dGV4dDogJ1Bhc2h0bycsIHZhbHVlOiAncHMnfSwKICAgICAgICB7dGV4dDogJ1BvbGlzaCcsIHZhbHVlOiAncGwnfSwKICAgICAgICB7dGV4dDogJ1BvcnR1Z3Vlc2UnLCB2YWx1ZTogJ3B0J30sCiAgICAgICAge3RleHQ6ICdSb21hbmlhbicsIHZhbHVlOiAncm8nfSwKICAgICAgICB7dGV4dDogJ1J1c3NpYW4nLCB2YWx1ZTogJ3J1J30sCiAgICAgICAge3RleHQ6ICdTZXJiaWFuJywgdmFsdWU6ICdzcid9LAogICAgICAgIHt0ZXh0OiAnU2xvdmFrJywgdmFsdWU6ICdzayd9LAogICAgICAgIHt0ZXh0OiAnU2xvdmVuaWFuJywgdmFsdWU6ICdzbCd9LAogICAgICAgIHt0ZXh0OiAnU29tYWxpJywgdmFsdWU6ICdzbyd9LAogICAgICAgIHt0ZXh0OiAnU3BhbmlzaCcsIHZhbHVlOiAnZXMnfSwKICAgICAgICB7dGV4dDogJ1N3YWhpbGknLCB2YWx1ZTogJ3N3J30sCiAgICAgICAge3RleHQ6ICdTd2VkaXNoJywgdmFsdWU6ICdzdid9LAogICAgICAgIHt0ZXh0OiAnVGFnYWxvZycsIHZhbHVlOiAndGwnfSwKICAgICAgICB7dGV4dDogJ1RhbWlsJywgdmFsdWU6ICd0YSd9LAogICAgICAgIHt0ZXh0OiAnVGhhaScsIHZhbHVlOiAndGgnfSwKICAgICAgICB7dGV4dDogJ1R1cmtpc2gnLCB2YWx1ZTogJ3RyJ30sCiAgICAgICAge3RleHQ6ICdVa3JhaW5pYW4nLCB2YWx1ZTogJ3VrJ30sCiAgICAgICAge3RleHQ6ICdVcmR1JywgdmFsdWU6ICd1cid9LAogICAgICAgIHt0ZXh0OiAnVmlldG5hbWVzZScsIHZhbHVlOiAndmknfSwKICAgICAgXSwKICAgICAgc291cmNlTGFuZ3VhZ2VDb2RlOiAiZW4iLAogICAgICB0YXJnZXRMYW5ndWFnZUNvZGU6ICJlcyIsCiAgICAgIHVwbG9hZEVycm9yTWVzc2FnZTogIiIsCiAgICAgIGludmFsaWRGaWxlTWVzc2FnZTogIiIsCiAgICAgIGludmFsaWRGaWxlTWVzc2FnZXM6IFtdLAogICAgICBzaG93SW52YWxpZEZpbGU6IGZhbHNlLAogICAgICBkaXNtaXNzU2VjczogOCwKICAgICAgZGlzbWlzc0NvdW50RG93bjogMCwKICAgICAgZXhlY3V0ZWRfYXNzZXRzOiBbXSwKICAgICAgd29ya2Zsb3dfc3RhdHVzX3BvbGxpbmc6IG51bGwsCiAgICAgIHdvcmtmbG93X2NvbmZpZzoge30sCiAgICAgIGRlc2NyaXB0aW9uOiAiQ2xpY2sgc3RhcnQgdG8gYmVnaW4uIE1lZGlhIGFuYWx5c2lzIHN0YXR1cyB3aWxsIGJlIHNob3duIGFmdGVyIHVwbG9hZCBjb21wbGV0ZXMuIiwKICAgICAgczNfZGVzdGluYXRpb246ICdzMzovLycgKyB0aGlzLkRBVEFQTEFORV9CVUNLRVQsCiAgICAgIGRyb3B6b25lT3B0aW9uczogewogICAgICAgIHVybDogJ2h0dHBzOi8vJyArIHRoaXMuREFUQVBMQU5FX0JVQ0tFVCArICcuczMuYW1hem9uYXdzLmNvbScsCiAgICAgICAgdGh1bWJuYWlsV2lkdGg6IDIwMCwKICAgICAgICBhZGRSZW1vdmVMaW5rczogdHJ1ZSwKICAgICAgICBhdXRvUHJvY2Vzc1F1ZXVlOiBmYWxzZSwKICAgICAgICAvLyBkaXNhYmxlIG5ldHdvcmsgdGltZW91dHMgKGltcG9ydGFudCBmb3IgbGFyZ2UgdXBsb2FkcykKICAgICAgICB0aW1lb3V0OiAwLAogICAgICAgIC8vIGxpbWl0IG1heCB1cGxvYWQgZmlsZSBzaXplIChpbiBNQikKICAgICAgICBtYXhGaWxlc2l6ZTogNTAwMCwKICAgICAgfSwKICAgICAgYXdzczM6IHsKICAgICAgICBzaWduaW5nVVJMOiAnJywKICAgICAgICBoZWFkZXJzOiB7fSwKICAgICAgICBwYXJhbXM6IHt9CiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZShbJ2V4ZWN1dGlvbl9oaXN0b3J5J10pLAogICAgdGV4dEZvcm1FcnJvcigpIHsKICAgICAgcmV0dXJuICIiOwogICAgfSwKICAgIGF1ZGlvRm9ybUVycm9yKCkgewogICAgICAvLyBWYWxpZGF0ZSB0cmFuc2NyaWJlIGlzIGVuYWJsZWQgaWYgYW55IHRleHQgb3BlcmF0b3IgaXMgZW5hYmxlZAogICAgICBpZiAoCiAgICAgICAgICAhdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJUcmFuc2NyaWJlVmlkZW8iKSAmJgogICAgICAgICAgKHRoaXMuZW5hYmxlZE9wZXJhdG9ycy5pbmNsdWRlcygiVHJhbnNsYXRlIikgfHwKICAgICAgICAgICAgICB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoIkNvbXByZWhlbmRFbnRpdGllcyIpIHx8CiAgICAgICAgICAgICAgdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJDb21wcmVoZW5kS2V5UGhyYXNlcyIpKQogICAgICApIHsKICAgICAgICByZXR1cm4gIlRyYW5zY3JpYmUgbXVzdCBiZSBlbmFibGVkIGlmIGFueSB0ZXh0IG9wZXJhdG9yIGlzIGVuYWJsZWQuIjsKICAgICAgfQogICAgICByZXR1cm4gIiI7CiAgICB9LAogICAgdmlkZW9Gb3JtRXJyb3IoKSB7CiAgICAgIC8vIFZhbGlkYXRlIGZhY2UgY29sbGVjdGlvbiBJRCBpZiBmYWNlIHNlYXJjaCBpcyBlbmFibGVkCiAgICAgIGlmICh0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImZhY2VTZWFyY2giKSkgewogICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGNvbGxlY3Rpb24gSUQgaXMgZGVmaW5lZAogICAgICAgIGlmICh0aGlzLmZhY2VDb2xsZWN0aW9uSWQgPT09ICIiKSB7CiAgICAgICAgICByZXR1cm4gIkZhY2UgY29sbGVjdGlvbiBuYW1lIGlzIHJlcXVpcmVkLiI7CiAgICAgICAgfQogICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGNvbGxlY3Rpb24gSUQgbWF0Y2hlcyByZXF1aXJlZCByZWdleAogICAgICAgIGVsc2UgaWYgKG5ldyBSZWdFeHAoIlteYS16QS1aMC05Xy5cXC1dIikudGVzdCh0aGlzLmZhY2VDb2xsZWN0aW9uSWQpKSB7CiAgICAgICAgICByZXR1cm4gIkZhY2UgY29sbGVjdGlvbiBuYW1lIG11c3QgbWF0Y2ggcGF0dGVybiBbYS16QS1aMC05Xy5cXFxcLV0rIjsKICAgICAgICB9CiAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgY29sbGVjdGlvbiBJRCBpcyBub3QgdG9vIGxvbmcKICAgICAgICBlbHNlIGlmICh0aGlzLmZhY2VDb2xsZWN0aW9uSWQubGVuZ3RoID4gMjU1KSB7CiAgICAgICAgICByZXR1cm4gIkZhY2UgY29sbGVjdGlvbiBuYW1lIG11c3QgaGF2ZSBmZXdlciB0aGFuIDI1NSBjaGFyYWN0ZXJzLiI7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImdlbmVyaWNEYXRhTG9va3VwIikpIHsKICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IHRoZSBjb2xsZWN0aW9uIElEIGlzIGRlZmluZWQKICAgICAgICBpZiAodGhpcy5nZW5lcmljRGF0YUZpbGVuYW1lID09PSAiIikgewogICAgICAgICAgcmV0dXJuICJHZW5lcmljIGRhdGEgZmlsZW5hbWUgaXMgcmVxdWlyZWQuIjsKICAgICAgICB9CiAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgY29sbGVjdGlvbiBJRCBtYXRjaGVzIHJlcXVpcmVkIHJlZ2V4CiAgICAgICAgZWxzZSBpZiAoIW5ldyBSZWdFeHAoIl4uK1xcLmpzb24kIikudGVzdCh0aGlzLmdlbmVyaWNEYXRhRmlsZW5hbWUpKSB7CiAgICAgICAgICByZXR1cm4gIkdlbmVyaWMgZGF0YSBmaWxlbmFtZSBtdXN0IGhhdmUgLmpzb24gZXh0ZW5zaW9uLiI7CiAgICAgICAgfQogICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGRhdGEgZmlsZW5hbWUgaXMgbm90IHRvbyBsb25nCiAgICAgICAgZWxzZSBpZiAodGhpcy5nZW5lcmljRGF0YUZpbGVuYW1lLmxlbmd0aCA+IDI1NSkgewogICAgICAgICAgcmV0dXJuICJHZW5lcmljIGRhdGEgZmlsZW5hbWUgbXVzdCBoYXZlIGZld2VyIHRoYW4gMjU1IGNoYXJhY3RlcnMuIjsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuICIiOwogICAgfSwKICAgIHZhbGlkRm9ybSgpIHsKICAgICAgbGV0IHZhbGlkU3RhdHVzID0gdHJ1ZTsKICAgICAgaWYgKAogICAgICAgICAgdGhpcy5pbnZhbGlkX2ZpbGVfdHlwZXMgfHwKICAgICAgICAgIHRoaXMudGV4dEZvcm1FcnJvciB8fAogICAgICAgICAgdGhpcy5hdWRpb0Zvcm1FcnJvciB8fAogICAgICAgICAgdGhpcy52aWRlb0Zvcm1FcnJvcgogICAgICApCiAgICAgICAgdmFsaWRTdGF0dXMgPSBmYWxzZTsKICAgICAgcmV0dXJuIHZhbGlkU3RhdHVzOwogICAgfSwKICAgIGltYWdlV29ya2Zsb3dDb25maWcoKSB7CiAgICAgIC8vIERlZmluZSB0aGUgaW1hZ2Ugd29ya2Zsb3cgYmFzZWQgb24gdXNlciBzcGVjaWZpZWQgb3B0aW9ucyBmb3Igd29ya2Zsb3cgY29uZmlndXJhdGlvbi4KICAgICAgY29uc3QgVmFsaWRhdGlvblN0YWdlID0gewogICAgICAgIE1lZGlhaW5mb0ltYWdlOiB7CiAgICAgICAgICBFbmFibGVkOiB0cnVlCiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IFJla29nbml0aW9uU3RhZ2UgPSB7CiAgICAgICAgZmFjZVNlYXJjaEltYWdlOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImZhY2VTZWFyY2giKSwKICAgICAgICAgIENvbGxlY3Rpb25JZDoKICAgICAgICAgICAgICB0aGlzLmZhY2VDb2xsZWN0aW9uSWQgPT09ICIiCiAgICAgICAgICAgICAgICAgID8gInVuZGVmaW5lZCIKICAgICAgICAgICAgICAgICAgOiB0aGlzLmZhY2VDb2xsZWN0aW9uSWQKICAgICAgICB9LAogICAgICAgIGxhYmVsRGV0ZWN0aW9uSW1hZ2U6IHsKICAgICAgICAgIEVuYWJsZWQ6IHRoaXMuZW5hYmxlZE9wZXJhdG9ycy5pbmNsdWRlcygibGFiZWxEZXRlY3Rpb24iKQogICAgICAgIH0sCiAgICAgICAgdGV4dERldGVjdGlvbkltYWdlOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoInRleHREZXRlY3Rpb24iKQogICAgICAgIH0sCiAgICAgICAgY2VsZWJyaXR5UmVjb2duaXRpb25JbWFnZTogewogICAgICAgICAgRW5hYmxlZDogdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKAogICAgICAgICAgICAgICJjZWxlYnJpdHlSZWNvZ25pdGlvbiIKICAgICAgICAgICkKICAgICAgICB9LAogICAgICAgIGNvbnRlbnRNb2RlcmF0aW9uSW1hZ2U6IHsKICAgICAgICAgIEVuYWJsZWQ6IHRoaXMuZW5hYmxlZE9wZXJhdG9ycy5pbmNsdWRlcygiY29udGVudE1vZGVyYXRpb24iKQogICAgICAgIH0sCiAgICAgICAgZmFjZURldGVjdGlvbkltYWdlOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImZhY2VEZXRlY3Rpb24iKQogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCB3b3JrZmxvd19jb25maWcgPSB7CiAgICAgICAgTmFtZTogIkNhc0ltYWdlV29ya2Zsb3ciLAogICAgICB9CiAgICAgIHdvcmtmbG93X2NvbmZpZ1siQ29uZmlndXJhdGlvbiJdID0ge30KICAgICAgd29ya2Zsb3dfY29uZmlnWyJDb25maWd1cmF0aW9uIl1bIlZhbGlkYXRpb25TdGFnZSJdID0gVmFsaWRhdGlvblN0YWdlCiAgICAgIHdvcmtmbG93X2NvbmZpZ1siQ29uZmlndXJhdGlvbiJdWyJSZWtvZ25pdGlvblN0YWdlIl0gPSBSZWtvZ25pdGlvblN0YWdlCiAgICAgIHJldHVybiB3b3JrZmxvd19jb25maWcKICAgIH0sCiAgICB2aWRlb1dvcmtmbG93Q29uZmlnKCkgewogICAgICAvLyBEZWZpbmUgdGhlIHZpZGVvIHdvcmtmbG93IGJhc2VkIG9uIHVzZXIgc3BlY2lmaWVkIG9wdGlvbnMgZm9yIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24uCiAgICAgIGNvbnN0IGRlZmF1bHRQcmVsaW1WaWRlb1N0YWdlID0gewogICAgICAgIFRodW1ibmFpbDogewogICAgICAgICAgVGh1bWJuYWlsUG9zaXRpb246IHRoaXMudGh1bWJuYWlsX3Bvc2l0aW9uLnRvU3RyaW5nKCksCiAgICAgICAgICBFbmFibGVkOiB0cnVlCiAgICAgICAgfSwKICAgICAgICBNZWRpYWluZm86IHsKICAgICAgICAgIEVuYWJsZWQ6IHRydWUKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgZGVmYXVsdFZpZGVvU3RhZ2UgPSB7CiAgICAgICAgZmFjZURldGVjdGlvbjogewogICAgICAgICAgRW5hYmxlZDogdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJmYWNlRGV0ZWN0aW9uIikKICAgICAgICB9LAogICAgICAgIHRlY2huaWNhbEN1ZURldGVjdGlvbjogewogICAgICAgICAgRW5hYmxlZDogdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJ0ZWNobmljYWxDdWVEZXRlY3Rpb24iKQogICAgICAgIH0sCiAgICAgICAgc2hvdERldGVjdGlvbjogewogICAgICAgICAgRW5hYmxlZDogdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJzaG90RGV0ZWN0aW9uIikKICAgICAgICB9LAogICAgICAgIGNlbGVicml0eVJlY29nbml0aW9uOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImNlbGVicml0eVJlY29nbml0aW9uIikKICAgICAgICB9LAogICAgICAgIGxhYmVsRGV0ZWN0aW9uOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImxhYmVsRGV0ZWN0aW9uIikKICAgICAgICB9LAogICAgICAgIGNvbnRlbnRNb2RlcmF0aW9uOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImNvbnRlbnRNb2RlcmF0aW9uIikKICAgICAgICB9LAogICAgICAgIGZhY2VTZWFyY2g6IHsKICAgICAgICAgIEVuYWJsZWQ6IHRoaXMuZW5hYmxlZE9wZXJhdG9ycy5pbmNsdWRlcygiZmFjZVNlYXJjaCIpLAogICAgICAgICAgQ29sbGVjdGlvbklkOgogICAgICAgICAgICAgIHRoaXMuZmFjZUNvbGxlY3Rpb25JZCA9PT0gIiIKICAgICAgICAgICAgICAgICAgPyAidW5kZWZpbmVkIgogICAgICAgICAgICAgICAgICA6IHRoaXMuZmFjZUNvbGxlY3Rpb25JZAogICAgICAgIH0sCiAgICAgICAgdGV4dERldGVjdGlvbjogewogICAgICAgICAgRW5hYmxlZDogdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJ0ZXh0RGV0ZWN0aW9uIikKICAgICAgICB9LAogICAgICAgIEdlbmVyaWNEYXRhTG9va3VwOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoImdlbmVyaWNEYXRhTG9va3VwIiksCiAgICAgICAgICBCdWNrZXQ6IHRoaXMuREFUQVBMQU5FX0JVQ0tFVCwKICAgICAgICAgIEtleToKICAgICAgICAgICAgICB0aGlzLmdlbmVyaWNEYXRhRmlsZW5hbWUgPT09ICIiCiAgICAgICAgICAgICAgICAgID8gInVuZGVmaW5lZCIKICAgICAgICAgICAgICAgICAgOiB0aGlzLmdlbmVyaWNEYXRhRmlsZW5hbWUKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgZGVmYXVsdEF1ZGlvU3RhZ2UgPSB7CiAgICAgICAgVHJhbnNjcmliZVZpZGVvOiB7CiAgICAgICAgICBFbmFibGVkOiB0aGlzLmVuYWJsZWRPcGVyYXRvcnMuaW5jbHVkZXMoIlRyYW5zY3JpYmVWaWRlbyIpLAogICAgICAgICAgVHJhbnNjcmliZUxhbmd1YWdlOiB0aGlzLnRyYW5zY3JpYmVMYW5ndWFnZQogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCBkZWZhdWx0VGV4dFN0YWdlID0gewogICAgICAgIFRyYW5zbGF0ZTogewogICAgICAgICAgRW5hYmxlZDogdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJUcmFuc2xhdGUiKSwKICAgICAgICAgIFNvdXJjZUxhbmd1YWdlQ29kZTogdGhpcy50cmFuc2NyaWJlTGFuZ3VhZ2Uuc3BsaXQoIi0iKVswXSwKICAgICAgICAgIFRhcmdldExhbmd1YWdlQ29kZTogdGhpcy50YXJnZXRMYW5ndWFnZUNvZGUKICAgICAgICB9LAogICAgICAgIENvbXByZWhlbmRFbnRpdGllczogewogICAgICAgICAgRW5hYmxlZDogdGhpcy5lbmFibGVkT3BlcmF0b3JzLmluY2x1ZGVzKCJDb21wcmVoZW5kRW50aXRpZXMiKQogICAgICAgIH0sCiAgICAgICAgQ29tcHJlaGVuZEtleVBocmFzZXM6IHsKICAgICAgICAgIEVuYWJsZWQ6IHRoaXMuZW5hYmxlZE9wZXJhdG9ycy5pbmNsdWRlcygiQ29tcHJlaGVuZEtleVBocmFzZXMiKQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5Db21wcmVoZW5kRW5jcnlwdGlvbiA9PT0gdHJ1ZSAmJiB0aGlzLmttc0tleUlkLmxlbmd0aCA+IDApIHsKICAgICAgICBkZWZhdWx0VGV4dFN0YWdlWyJDb21wcmVoZW5kRW50aXRpZXMiXVsiS21zS2V5SWQiXSA9IHRoaXMua21zS2V5SWQKICAgICAgICBkZWZhdWx0VGV4dFN0YWdlWyJDb21wcmVoZW5kS2V5UGhyYXNlcyJdWyJLbXNLZXlJZCJdID0gdGhpcy5rbXNLZXlJZAogICAgICB9CiAgICAgIGNvbnN0IGRlZmF1bHRUZXh0U3ludGhlc2lzU3RhZ2UgPSB7CiAgICAgICAgLy8gUG9sbHkgaXMgYXZhaWxhYmxlIGluIHRoZSBNSUVDb21wbGV0ZVdvcmtmbG93IGJ1dCBub3QgdXNlZCBpbiB0aGUgZnJvbnQtZW5kLCBzbyB3ZSd2ZSBkaXNhYmxlZCBpdCBoZXJlLgogICAgICAgIFBvbGx5OiB7CiAgICAgICAgICBFbmFibGVkOiBmYWxzZQogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCB3b3JrZmxvd19jb25maWcgPSB7CiAgICAgICAgTmFtZTogIkNhc1ZpZGVvV29ya2Zsb3ciLAogICAgICB9CiAgICAgIHdvcmtmbG93X2NvbmZpZ1siQ29uZmlndXJhdGlvbiJdID0ge30KICAgICAgd29ya2Zsb3dfY29uZmlnWyJDb25maWd1cmF0aW9uIl1bImRlZmF1bHRQcmVsaW1WaWRlb1N0YWdlIl0gPSBkZWZhdWx0UHJlbGltVmlkZW9TdGFnZQogICAgICB3b3JrZmxvd19jb25maWdbIkNvbmZpZ3VyYXRpb24iXVsiZGVmYXVsdFZpZGVvU3RhZ2UiXSA9IGRlZmF1bHRWaWRlb1N0YWdlCiAgICAgIHdvcmtmbG93X2NvbmZpZ1siQ29uZmlndXJhdGlvbiJdWyJkZWZhdWx0QXVkaW9TdGFnZSJdID0gZGVmYXVsdEF1ZGlvU3RhZ2UKICAgICAgd29ya2Zsb3dfY29uZmlnWyJDb25maWd1cmF0aW9uIl1bImRlZmF1bHRUZXh0U3RhZ2UiXSA9IGRlZmF1bHRUZXh0U3RhZ2UKICAgICAgd29ya2Zsb3dfY29uZmlnWyJDb25maWd1cmF0aW9uIl1bImRlZmF1bHRUZXh0U3ludGhlc2lzU3RhZ2UiXSA9IGRlZmF1bHRUZXh0U3ludGhlc2lzU3RhZ2UKICAgICAgcmV0dXJuIHdvcmtmbG93X2NvbmZpZwogICAgfSwKICAgIGN1cmxXb3JrZmxvd0V4ZWN1dGlvbigpIHsKICAgICAgLy8gZ2V0IGN1cmwgY29tbWFuZCB0byByZXF1ZXN0IHdvcmtmbG93IGV4ZWN1dGlvbgogICAgICByZXR1cm4gJ2F3c3NjdXJsIC1YIFBPU1QgLS1yZWdpb24gJysgdGhpcy5BV1NfUkVHSU9OICsnIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIC0tZGF0YSBcJycrSlNPTi5zdHJpbmdpZnkodGhpcy53b3JrZmxvd0NvbmZpZ1dpdGhJbnB1dCkrJ1wnICcrdGhpcy5XT1JLRkxPV19BUElfRU5EUE9JTlQrJ3dvcmtmbG93L2V4ZWN1dGlvbicKICAgIH0sCiAgICBzYW1wbGVfZmlsZSgpIHsKICAgICAgaWYgKHRoaXMuY3VybFdvcmtmbG93ID09PSAiVmlkZW8iKSB7CiAgICAgICAgcmV0dXJuICJTQU1QTEVfVklERU8uTVA0IgogICAgICB9CiAgICAgIGVsc2UgaWYgKHRoaXMuY3VybFdvcmtmbG93ID09PSAiSW1hZ2UiKSB7CiAgICAgICAgcmV0dXJuICJTQU1QTEVfSU1BR0UuUE5HIgogICAgICB9CiAgICB9LAogICAgY3VybEV4ZWN1dGlvbkhpc3RvcnkoKSB7CiAgICAgIC8vIGdldCBjdXJsIGNvbW1hbmQgdG8gcmVxdWVzdCBleGVjdXRpb24gaGlzdG9yeQogICAgICByZXR1cm4gJ2F3c2N1cmwgLVggR0VUIC0tcmVnaW9uICcrIHRoaXMuQVdTX1JFR0lPTiArJyAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiAnK3RoaXMuV09SS0ZMT1dfQVBJX0VORFBPSU5UKyd3b3JrZmxvdy9leGVjdXRpb24vYXNzZXQve2Fzc2V0X2lkfScKICAgIH0sCiAgICB3b3JrZmxvd0NvbmZpZ1dpdGhJbnB1dCgpIHsKICAgICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBqdXN0IHVzZWQgdG8gcHJldHR5IHByaW50IHRoZSByZXN0IGFwaQogICAgICAvLyBmb3Igd29ya2Zsb3cgZXhlY3V0aW9uIGluIGEgcG9wdXAgbW9kYWwKICAgICAgbGV0IGRhdGEgPSB7fQogICAgICBpZiAodGhpcy5jdXJsV29ya2Zsb3cgPT09ICJWaWRlbyIpIHsKICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnZpZGVvV29ya2Zsb3dDb25maWcpKTsKICAgICAgICBkYXRhWyJOYW1lIl0gPSAiQ2FzVmlkZW9Xb3JrZmxvdyIKICAgICAgfQogICAgICBlbHNlIGlmICh0aGlzLmN1cmxXb3JrZmxvdyA9PT0gIkltYWdlIikgewogICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuaW1hZ2VXb3JrZmxvd0NvbmZpZykpOwogICAgICAgIGRhdGFbIk5hbWUiXSA9ICJDYXNJbWFnZVdvcmtmbG93IgogICAgICB9CiAgICAgIGRhdGFbIklucHV0Il0gPSB7CiAgICAgICAgIk1lZGlhIjogewogICAgICAgICAgIlZpZGVvIjogewogICAgICAgICAgICAiUzNCdWNrZXQiOiB0aGlzLkRBVEFQTEFORV9CVUNLRVQsCiAgICAgICAgICAgICJTM0tleSI6IHRoaXMuc2FtcGxlX2ZpbGUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGRhdGEKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuJHJvdXRlLnF1ZXJ5LmFzc2V0KSB7CiAgICAgIHRoaXMuaGFzQXNzZXRQYXJhbSA9IHRydWU7CiAgICAgIHRoaXMuYXNzZXRJZFBhcmFtID0gdGhpcy4kcm91dGUucXVlcnkuYXNzZXQ7CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuZXhlY3V0ZWRfYXNzZXRzID0gdGhpcy5leGVjdXRpb25faGlzdG9yeTsKICAgIHRoaXMucG9sbFdvcmtmbG93U3RhdHVzKCk7CiAgfSwKICBiZWZvcmVEZXN0cm95ICgpIHsKICAgIGNsZWFySW50ZXJ2YWwodGhpcy53b3JrZmxvd19zdGF0dXNfcG9sbGluZykKICB9LAogIG1ldGhvZHM6IHsKICAgIHNlbGVjdEFsbDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuZW5hYmxlZE9wZXJhdG9ycyA9IFsKICAgICAgICAibGFiZWxEZXRlY3Rpb24iLAogICAgICAgICJ0ZXh0RGV0ZWN0aW9uIiwKICAgICAgICAiY2VsZWJyaXR5UmVjb2duaXRpb24iLAogICAgICAgICJjb250ZW50TW9kZXJhdGlvbiIsCiAgICAgICAgImZhY2VEZXRlY3Rpb24iLAogICAgICAgICJ0aHVtYm5haWwiLAogICAgICAgICJUcmFuc2NyaWJlVmlkZW8iLAogICAgICAgICJUcmFuc2xhdGUiLAogICAgICAgICJDb21wcmVoZW5kS2V5UGhyYXNlcyIsCiAgICAgICAgIkNvbXByZWhlbmRFbnRpdGllcyIsCiAgICAgICAgInRlY2huaWNhbEN1ZURldGVjdGlvbiIsCiAgICAgICAgInNob3REZXRlY3Rpb24iCiAgICAgIF07CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZW5hYmxlZE9wZXJhdG9ycykKICAgIH0sCiAgICBjbGVhckFsbDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuZW5hYmxlZE9wZXJhdG9ycyA9IFtdOwogICAgfSwKICAgIG9wZW5XaW5kb3c6IGZ1bmN0aW9uKHVybCkgewogICAgICB3aW5kb3cub3Blbih1cmwsICJub29wZW5lcixub3JlZmVyZXIiKTsKICAgIH0sCiAgICBjb3VudERvd25DaGFuZ2VkKGRpc21pc3NDb3VudERvd24pIHsKICAgICAgdGhpcy5kaXNtaXNzQ291bnREb3duID0gZGlzbWlzc0NvdW50RG93bjsKICAgIH0sCiAgICBzM1VwbG9hZEVycm9yKGVycm9yKSB7CiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgLy8gZGlzcGxheSBhbGVydAogICAgICB0aGlzLnVwbG9hZEVycm9yTWVzc2FnZSA9IGVycm9yOwogICAgICB0aGlzLmRpc21pc3NDb3VudERvd24gPSB0aGlzLmRpc21pc3NTZWNzOwogICAgfSwKICAgIGZpbGVBZGRlZDogZnVuY3Rpb24oIGZpbGUgKQogICAgewogICAgICBsZXQgZXJyb3JNZXNzYWdlID0gJyc7CiAgICAgIGlmICghKGZpbGUudHlwZSkubWF0Y2goL2ltYWdlXC8uK3x2aWRlb1wvLit8YXBwbGljYXRpb25cL214ZnxhcHBsaWNhdGlvblwvanNvbi9nKSkgewogICAgICAgIGlmIChmaWxlLnR5cGUgPT09ICIiKQogICAgICAgICAgZXJyb3JNZXNzYWdlID0gIlVuc3VwcG9ydGVkIGZpbGUgdHlwZTogdW5rbm93biI7CiAgICAgICAgZWxzZQogICAgICAgICAgZXJyb3JNZXNzYWdlID0gIlVuc3VwcG9ydGVkIGZpbGUgdHlwZTogIiArIGZpbGUudHlwZTsKICAgICAgICB0aGlzLmludmFsaWRGaWxlTWVzc2FnZXMucHVzaChlcnJvck1lc3NhZ2UpOwogICAgICAgIHRoaXMuc2hvd0ludmFsaWRGaWxlID0gdHJ1ZQogICAgICB9CiAgICB9LAogICAgZmlsZVJlbW92ZWQ6IGZ1bmN0aW9uKCBmaWxlICkKICAgIHsKICAgICAgbGV0IGVycm9yTWVzc2FnZSA9ICcnOwogICAgICBpZiAoIShmaWxlLnR5cGUpLm1hdGNoKC9pbWFnZVwvLit8dmlkZW9cLy4rfGFwcGxpY2F0aW9uXC9teGZ8YXBwbGljYXRpb25cL2pzb24vZykpIHsKICAgICAgICBpZiAoZmlsZS50eXBlID09PSAiIikKICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICJVbnN1cHBvcnRlZCBmaWxlIHR5cGU6IHVua25vd24iOwogICAgICAgIGVsc2UKICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICJVbnN1cHBvcnRlZCBmaWxlIHR5cGU6ICIgKyBmaWxlLnR5cGU7CiAgICAgIH0KICAgICAgdGhpcy5pbnZhbGlkRmlsZU1lc3NhZ2VzID0gdGhpcy5pbnZhbGlkRmlsZU1lc3NhZ2VzLmZpbHRlcihmdW5jdGlvbih2YWx1ZSl7IHJldHVybiB2YWx1ZSAhPSBlcnJvck1lc3NhZ2V9KQogICAgICBpZiAodGhpcy5pbnZhbGlkRmlsZU1lc3NhZ2VzLmxlbmd0aCA9PT0gMCApIHRoaXMuc2hvd0ludmFsaWRGaWxlID0gZmFsc2U7CiAgICB9LAogICAgcnVuV29ya2Zsb3c6IGFzeW5jIGZ1bmN0aW9uKGZpbGUpIHsKICAgICAgY29uc3Qgdm0gPSB0aGlzOwogICAgICBsZXQgbWVkaWFfdHlwZSA9IG51bGw7CiAgICAgIGxldCBzM0tleSA9IG51bGw7CiAgICAgIGlmICgiczNfa2V5IiBpbiBmaWxlKSB7CiAgICAgICAgbWVkaWFfdHlwZSA9IGZpbGUudHlwZTsKICAgICAgICBzM0tleSA9IGZpbGUuczNfa2V5OyAvLyBhZGQgaW4gcHVibGljIHNpbmNlIGFtcGxpZnkgcHJlcGVuZHMgdGhhdCB0byBhbGwga2V5cwogICAgICB9IGVsc2UgewogICAgICAgIG1lZGlhX3R5cGUgPSB0aGlzLiRyb3V0ZS5xdWVyeS5tZWRpYVR5cGU7CiAgICAgICAgczNLZXkgPSB0aGlzLiRyb3V0ZS5xdWVyeS5zM2tleS5zcGxpdCgiLyIpLnBvcCgpOwogICAgICB9CiAgICAgIGlmICh0aGlzLmhhc0Fzc2V0UGFyYW0pIHsKICAgICAgICBpZiAobWVkaWFfdHlwZSA9PT0gInZpZGVvIikgewogICAgICAgICAgdGhpcy53b3JrZmxvd19jb25maWcgPSB2bS52aWRlb1dvcmtmbG93Q29uZmlnOwogICAgICAgICAgdGhpcy53b3JrZmxvd19jb25maWdbIklucHV0Il0gPSB7IEFzc2V0SWQ6IHRoaXMuYXNzZXRJZFBhcmFtLCBNZWRpYTogeyBWaWRlbzoge30gfSB9OwogICAgICAgIH0gZWxzZSBpZiAobWVkaWFfdHlwZSA9PT0gImltYWdlIikgewogICAgICAgICAgdGhpcy53b3JrZmxvd19jb25maWcgPSB2bS5pbWFnZVdvcmtmbG93Q29uZmlnOwogICAgICAgICAgdGhpcy53b3JrZmxvd19jb25maWdbIklucHV0Il0gPSB7IEFzc2V0SWQ6IHRoaXMuYXNzZXRJZFBhcmFtLCBNZWRpYTogeyBJbWFnZToge30gfSB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2bS5zM1VwbG9hZEVycm9yKAogICAgICAgICAgICAgICJVbnN1cHBvcnRlZCBtZWRpYSB0eXBlLCAiICsgdGhpcy4kcm91dGUucXVlcnkubWVkaWFUeXBlICsgIi4iCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAobWVkaWFfdHlwZS5tYXRjaCgvaW1hZ2UvZykpIHsKICAgICAgICAgIHRoaXMud29ya2Zsb3dfY29uZmlnID0gdm0uaW1hZ2VXb3JrZmxvd0NvbmZpZzsKICAgICAgICAgIHRoaXMud29ya2Zsb3dfY29uZmlnWyJJbnB1dCJdID0gewogICAgICAgICAgICBNZWRpYTogewogICAgICAgICAgICAgIEltYWdlOiB7CiAgICAgICAgICAgICAgICBTM0J1Y2tldDogdGhpcy5EQVRBUExBTkVfQlVDS0VULAogICAgICAgICAgICAgICAgUzNLZXk6IHMzS2V5CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICgKICAgICAgICAgICAgbWVkaWFfdHlwZS5tYXRjaCgvdmlkZW8vZykgfHwgbWVkaWFfdHlwZSA9PT0gImFwcGxpY2F0aW9uL214ZiIKICAgICAgICApIHsKICAgICAgICAgIHRoaXMud29ya2Zsb3dfY29uZmlnID0gdm0udmlkZW9Xb3JrZmxvd0NvbmZpZzsKICAgICAgICAgIHRoaXMud29ya2Zsb3dfY29uZmlnWyJJbnB1dCJdID0gewogICAgICAgICAgICBNZWRpYTogewogICAgICAgICAgICAgIFZpZGVvOiB7CiAgICAgICAgICAgICAgICBTM0J1Y2tldDogdGhpcy5EQVRBUExBTkVfQlVDS0VULAogICAgICAgICAgICAgICAgUzNLZXk6IHMzS2V5CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAobWVkaWFfdHlwZSA9PT0gImFwcGxpY2F0aW9uL2pzb24iKSB7CiAgICAgICAgICAvLyBKU09OIGZpbGVzIG1heSBiZSB1cGxvYWRlZCBmb3IgdGhlIGdlbmVyaWNEYXRhTG9va3VwIG9wZXJhdG9yLCBidXQKICAgICAgICAgIC8vIHdlIHdvbid0IHJ1biBhIHdvcmtmbG93IGZvciBqc29uIGZpbGUgdHlwZXMuCiAgICAgICAgICAvL2NvbnNvbGUubG9nKCJEYXRhIGZpbGUgaGFzIGJlZW4gdXBsb2FkZWQgdG8gczM6Ly8iICsgbG9jYXRpb24uczNPYmplY3RMb2NhdGlvbi5maWVsZHMua2V5KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdm0uczNVcGxvYWRFcnJvcigiVW5zdXBwb3J0ZWQgbWVkaWEgdHlwZTogIiArIG1lZGlhX3R5cGUgKyAiLiIpOwogICAgICAgIH0KICAgICAgfQogICAgICBjb25zb2xlLmxvZygid29ya2Zsb3cgZXhlY3V0aW9uIGNvbmZpZ3VyYXRpb246IikKICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkodGhpcy53b3JrZmxvd19jb25maWcpKQogICAgICBsZXQgYXBpTmFtZSA9ICdtaWVXb3JrZmxvd0FwaScKICAgICAgbGV0IHBhdGggPSAnd29ya2Zsb3cvZXhlY3V0aW9uJwogICAgICBsZXQgcmVxdWVzdE9wdHMgPSB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgIH0sCiAgICAgICAgcmVzcG9uc2U6IHRydWUsCiAgICAgICAgYm9keTogdGhpcy53b3JrZmxvd19jb25maWcsCiAgICAgICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiB7fSAvLyBvcHRpb25hbAogICAgICB9OwogICAgICB0cnkgewogICAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJEFtcGxpZnkuQVBJLnBvc3QoYXBpTmFtZSwgcGF0aCwgcmVxdWVzdE9wdHMpOwogICAgICAgIGxldCBhc3NldF9pZCA9IHJlc3BvbnNlLmRhdGEuQXNzZXRJZDsKICAgICAgICBsZXQgd2ZfaWQgPSByZXNwb25zZS5kYXRhLklkOwogICAgICAgIGxldCBleGVjdXRlZF9hc3NldCA9IHsKICAgICAgICAgIGFzc2V0X2lkOiBhc3NldF9pZCwKICAgICAgICAgIGZpbGVfbmFtZTogczNLZXkucmVwbGFjZSgncHVibGljL3VwbG9hZC8nLCAnJyksCiAgICAgICAgICB3b3JrZmxvd19zdGF0dXM6ICIiLAogICAgICAgICAgc3RhdGVfbWFjaGluZV9jb25zb2xlX2xpbms6ICIiLAogICAgICAgICAgd2ZfaWQ6IHdmX2lkCiAgICAgICAgfTsKICAgICAgICB2bS5leGVjdXRlZF9hc3NldHMucHVzaChleGVjdXRlZF9hc3NldCk7CiAgICAgICAgdm0uZ2V0V29ya2Zsb3dTdGF0dXMod2ZfaWQpOwogICAgICAgIHRoaXMuaGFzQXNzZXRQYXJhbSA9IGZhbHNlOwogICAgICAgIHRoaXMuYXNzZXRJZFBhcmFtID0gIiI7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICAgICJFUlJPUjogRmFpbGVkIHRvIHN0YXJ0IHdvcmtmbG93LiBDaGVjayBXb3JrZmxvdyBBUEkgbG9ncy4iCiAgICAgICAgKTsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGdldFdvcmtmbG93U3RhdHVzKHdmX2lkKSB7CiAgICAgIGNvbnN0IHZtID0gdGhpczsKICAgICAgbGV0IGFwaU5hbWUgPSAnbWllV29ya2Zsb3dBcGknCiAgICAgIGxldCBwYXRoID0gICJ3b3JrZmxvdy9leGVjdXRpb24vIiArIHdmX2lkCiAgICAgIGxldCByZXF1ZXN0T3B0cyA9IHsKICAgICAgICBoZWFkZXJzOiB7fSwKICAgICAgICByZXNwb25zZTogdHJ1ZSwKICAgICAgICBxdWVyeVN0cmluZ1BhcmFtZXRlcnM6IHt9IC8vIG9wdGlvbmFsCiAgICAgIH07CiAgICAgIHRyeSB7CiAgICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy4kQW1wbGlmeS5BUEkuZ2V0KGFwaU5hbWUsIHBhdGgsIHJlcXVlc3RPcHRzKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZtLmV4ZWN1dGVkX2Fzc2V0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHZtLmV4ZWN1dGVkX2Fzc2V0c1tpXS53Zl9pZCA9PT0gd2ZfaWQpIHsKICAgICAgICAgICAgdm0uZXhlY3V0ZWRfYXNzZXRzW2ldLndvcmtmbG93X3N0YXR1cyA9IHJlc3BvbnNlLmRhdGEuU3RhdHVzOwogICAgICAgICAgICB2bS5leGVjdXRlZF9hc3NldHNbaV0uc3RhdGVfbWFjaGluZV9jb25zb2xlX2xpbmsgPQogICAgICAgICAgICAgICAgImh0dHBzOi8vIiArIHRoaXMuQVdTX1JFR0lPTiArICIuY29uc29sZS5hd3MuYW1hem9uLmNvbS9zdGF0ZXMvaG9tZT9yZWdpb249IiArIHRoaXMuQVdTX1JFR0lPTiArICIjL2V4ZWN1dGlvbnMvZGV0YWlscy8iICsgcmVzcG9uc2UuZGF0YS5TdGF0ZU1hY2hpbmVFeGVjdXRpb25Bcm47CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInVwZGF0ZUV4ZWN1dGVkQXNzZXRzIiwgdm0uZXhlY3V0ZWRfYXNzZXRzKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZygiRVJST1I6IEZhaWxlZCB0byBnZXQgd29ya2Zsb3cgc3RhdHVzIik7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgIH0KICAgIH0sCiAgICBwb2xsV29ya2Zsb3dTdGF0dXMoKSB7CiAgICAgIC8vIFBvbGwgZnJlcXVlbmN5IGluIG1pbGxpc2Vjb25kcwogICAgICBjb25zdCBwb2xsX2ZyZXF1ZW5jeSA9IDUwMDA7CiAgICAgIHRoaXMud29ya2Zsb3dfc3RhdHVzX3BvbGxpbmcgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgdGhpcy5leGVjdXRlZF9hc3NldHMuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBpdGVtLndvcmtmbG93X3N0YXR1cyA9PT0gIiIgfHwKICAgICAgICAgICAgICBpdGVtLndvcmtmbG93X3N0YXR1cyA9PT0gIlN0YXJ0ZWQiIHx8CiAgICAgICAgICAgICAgaXRlbS53b3JrZmxvd19zdGF0dXMgPT09ICJRdWV1ZWQiCiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy5nZXRXb3JrZmxvd1N0YXR1cyhpdGVtLndmX2lkKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSwgcG9sbF9mcmVxdWVuY3kpOwogICAgfSwKICAgIHVwbG9hZEZpbGVzKCkgewogICAgICBjb25zb2xlLmxvZygiVXBsb2FkaW5nIHRvIHMzOi8vIiArIHRoaXMuREFUQVBMQU5FX0JVQ0tFVCwpOwogICAgICB0aGlzLiRyZWZzLm15VnVlRHJvcHpvbmUucHJvY2Vzc1F1ZXVlKCk7CiAgICB9LAogICAgY2xlYXJIaXN0b3J5KCkgewogICAgICB0aGlzLmV4ZWN1dGVkX2Fzc2V0cyA9IFtdOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VwZGF0ZUV4ZWN1dGVkQXNzZXRzJywgdGhpcy5leGVjdXRlZF9hc3NldHMpOwoKICAgIH0KICB9Cn0K"},{"version":3,"sources":["UploadToAWSS3.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8OA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"UploadToAWSS3.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <Header :is-upload-active=\"true\" />\n    <br>\n    <b-container>\n      <b-alert\n        :show=\"dismissCountDown\"\n        dismissible\n        variant=\"danger\"\n        @dismissed=\"dismissCountDown=0\"\n        @dismiss-count-down=\"countDownChanged\"\n      >\n        {{ uploadErrorMessage }}\n      </b-alert>\n      <b-alert\n        :show=\"showInvalidFile\"\n        variant=\"danger\"\n      >\n        {{ invalidFileMessages[invalidFileMessages.length-1] }}\n      </b-alert>\n      <h1>Upload Content</h1>\n      <p>{{ description }}</p>\n      <vue-dropzone\n        id=\"dropzone\"\n        ref=\"myVueDropzone\"\n        :awss3=\"awss3\"\n        :options=\"dropzoneOptions\"\n        @vdropzone-s3-upload-error=\"s3UploadError\"\n        @vdropzone-file-added=\"fileAdded\"\n        @vdropzone-removed-file=\"fileRemoved\"\n        @vdropzone-success=\"runWorkflow\"\n        @vdropzone-sending=\"upload_in_progress=true\"\n        @vdropzone-queue-complete=\"upload_in_progress=false\"\n      />\n      <br>\n      <b-button v-b-toggle.collapse-2 class=\"m-1\">\n        Configure Workflow\n      </b-button>\n      <b-button v-if=\"validForm && upload_in_progress===false\" variant=\"primary\" @click=\"uploadFiles\">\n        Upload and Run Workflow\n      </b-button>\n      <b-button v-else disabled variant=\"primary\" @click=\"uploadFiles\">\n        Upload and Run Workflow\n      </b-button>\n      <br>\n      <!-- TODO: add a drop-down option in this modal to choose update workflow, then update workflowConfigWithInput to include the appropriate workflow config -->\n      <b-button\n        :pressed=\"false\"\n        size=\"sm\"\n        variant=\"link\"\n        class=\"text-decoration-none\"\n        @click=\"showExecuteApi = true\"\n      >\n        Show API request to run workflow\n      </b-button>\n      <b-modal\n        v-model=\"showExecuteApi\"\n        scrollable\n        title=\"REST API\"\n        ok-only\n      >\n        <label>Workflow Type:</label>\n        <b-form-group>\n          <b-form-radio-group\n              id=\"curlable-workflows\"\n              v-model=\"curlWorkflow\"\n              name=\"curlable-workflows\"\n          >\n          <b-form-radio  value=\"Video\">Video</b-form-radio>\n          <b-form-radio  value=\"Image\">Image</b-form-radio>\n          </b-form-radio-group>\n        </b-form-group>\n        <label>Request URL:</label>\n        <pre v-highlightjs><code class=\"bash\">POST {{ WORKFLOW_API_ENDPOINT }}workflow/execution</code></pre>\n        <label>Request data:</label>\n        <pre v-highlightjs=\"JSON.stringify(workflowConfigWithInput)\"><code class=\"json\"></code></pre>\n        <label>Sample command:</label>\n        <p>Be sure to replace \"{{ sample_file }}\" with the S3 key of an actual file.</p>\n        <pre v-highlightjs=\"curlWorkflowExecution\"><code class=\"bash\"></code></pre>\n      </b-modal>\n      <br>\n      <span v-if=\"upload_in_progress\" class=\"text-secondary\">Upload in progress</span>\n      <b-container v-if=\"upload_in_progress\">\n        <b-spinner label=\"upload_in_progress\" />\n      </b-container>\n      <br>\n      <b-collapse id=\"collapse-2\">\n        <b-container class=\"text-left\">\n          <b-card-group deck>\n            <b-card header=\"Vision Operators\">\n              <b-form-group>\n                <b-form-checkbox-group\n                  id=\"checkbox-group-1\"\n                  v-model=\"enabledOperators\"\n                  :options=\"videoOperators\"\n                  name=\"flavour-1\"\n                ></b-form-checkbox-group>\n                <label>Thumbnail position: </label>\n                <b-form-input v-model=\"thumbnail_position\" type=\"range\" min=\"1\" max=\"20\" step=\"1\"></b-form-input> {{ thumbnail_position }} sec\n                <b-form-input v-if=\"enabledOperators.includes('genericDataLookup')\" id=\"generic_data_filename\" v-model=\"genericDataFilename\" placeholder=\"Enter S3 key for data file\" ></b-form-input>\n                <b-button\n                  v-if=\"enabledOperators.includes('genericDataLookup')\"\n                  :pressed=\"false\"\n                  size=\"sm\"\n                  variant=\"link\"\n                  class=\"text-decoration-none\"\n                  @click=\"showGenericOperatorHelp = true\"\n                >\n                  How do I use generic data?\n                </b-button>\n                <b-modal\n                  v-model=\"showGenericOperatorHelp\"\n                  scrollable\n                  title=\"Using generic metadata\"\n                  ok-only\n                >\n                  This option allows you to use a precomputed JSON dataset as metadata for a video. The file must be located in <code>s3://{{ DATAPLANE_BUCKET }}/</code>. Specify the S3 key for your JSON file in the workflow configuration form.\n                  <br><br>\n                  You may upload json files alongside media files on this page. In that case, enter <code>public/upload/[filename.json]</code> as the S3 key for the data file.\n                  <br><br>\n                  The <code>generic_data_lookup.py</code> operator loads the specified JSON data into the asset metadata table in DynamoDB. It requires that the JSON data be a dict, not a list. Don't forget to extend the OpenSearch (aka Elasticsearch) consumer (source/consumer/lambda_handler.py) if you want the generic data to be indexed so it can be searchable and rendered in this front-end application.\n                </b-modal>\n\n                <b-form-input v-if=\"enabledOperators.includes('faceSearch')\" id=\"face_collection_id\" v-model=\"faceCollectionId\" placeholder=\"Enter face collection id\"></b-form-input>\n              </b-form-group>\n              <div v-if=\"videoFormError\" style=\"color:red\">\n                {{ videoFormError }}\n              </div>\n            </b-card>\n            <b-card header=\"Audio Operators\">\n              <b-form-group>\n                <b-form-checkbox-group\n                  id=\"checkbox-group-2\"\n                  v-model=\"enabledOperators\"\n                  :options=\"audioOperators\"\n                  name=\"flavour-2\"\n                ></b-form-checkbox-group>\n                <div v-if=\"enabledOperators.includes('Transcribe')\">\n                  <label>Source Language</label>\n                  <b-form-select v-model=\"transcribeLanguage\" :options=\"transcribeLanguages\"></b-form-select>\n                </div>\n              </b-form-group>\n              <div v-if=\"audioFormError\" style=\"color:red\">\n                {{ audioFormError }}\n              </div>\n            </b-card>\n            <b-card header=\"Text Operators\">\n              <b-form-group>\n                <b-form-checkbox-group\n                  id=\"checkbox-group-3\"\n                  v-model=\"enabledOperators\"\n                  :options=\"textOperators\"\n                  name=\"flavour-3\"\n                ></b-form-checkbox-group>\n                <div v-if=\"enabledOperators.includes('Translate')\">\n                  <label>Translation Source Language</label>\n                  <b-form-select v-model=\"transcribeLanguage\" :options=\"transcribeLanguages\"></b-form-select>\n                  <label>Translation Target Language</label>\n                  <b-form-select v-model=\"targetLanguageCode\" :options=\"translateLanguages\"></b-form-select>\n                </div>\n                <b-form-checkbox\n                  v-if=\"enabledOperators.includes('ComprehendEntities') || enabledOperators.includes('ComprehendKeyPhrases')\"\n                  v-model=\"ComprehendEncryption\"\n                >\n                  Encrypt Comprehend job\n                </b-form-checkbox>\n                <b-form-input\n                  v-if=\"ComprehendEncryption && (enabledOperators.includes('ComprehendEntities') || enabledOperators.includes('ComprehendKeyPhrases'))\"\n                  v-model=\"kmsKeyId\"\n                  placeholder=\"Enter KMS key ID\"\n                ></b-form-input>\n              </b-form-group>\n              <div v-if=\"textFormError\" style=\"color:red\">\n                {{ textFormError }}\n              </div>\n            </b-card>\n          </b-card-group>\n          <div align=\"right\">\n            <button type=\"button\" class=\"btn btn-link\" @click=\"selectAll\">\n              Select All\n            </button>\n            <button type=\"button\" class=\"btn btn-link\" @click=\"clearAll\">\n              Clear All\n            </button>\n          </div>\n        </b-container>\n      </b-collapse>\n    </b-container>\n    <b-container v-if=\"executed_assets.length > 0\">\n      <label>\n        Execution History\n      </label>\n      <b-table\n        :fields=\"fields\"\n        bordered\n        hover\n        small\n        responsive\n        show-empty\n        fixed\n        :items=\"executed_assets\"\n      >\n        <template #cell(workflow_status)=\"data\">\n          <a v-if=\"data.item.workflow_status !== 'Queued'\" href=\"\" @click.stop.prevent=\"openWindow(data.item.state_machine_console_link)\">{{ data.item.workflow_status }}</a>\n          <div v-if=\"data.item.workflow_status === 'Queued'\">\n            {{ data.item.workflow_status }}\n          </div>\n        </template>\n      </b-table>\n      <b-button size=\"sm\" @click=\"clearHistory\">\n        Clear History\n      </b-button>\n      <br>\n      <b-button\n        :pressed=\"false\"\n        size=\"sm\"\n        variant=\"link\"\n        class=\"text-decoration-none\"\n        @click=\"showWorkflowStatusApi = true\"\n      >\n        Show API request to get execution history\n      </b-button>\n      <b-modal\n        v-model=\"showWorkflowStatusApi\"\n        title=\"REST API\"\n        ok-only\n      >\n        <label>Request URL:</label>\n        <pre v-highlightjs><code class=\"bash\">GET {{ WORKFLOW_API_ENDPOINT }}workflow/execution/asset/{asset_id}</code></pre>\n        <label>Sample command:</label>\n        <p>Be sure to replace <b>{asset_id}</b> with a valid asset ID.</p>\n        <pre v-highlightjs=\"curlExecutionHistory\"><code class=\"bash\"></code></pre>\n      </b-modal>\n    </b-container>\n  </div>\n</template>\n\n<script>\nimport vueDropzone from '@/components/vue-dropzone.vue';\nimport Header from '@/components/Header.vue'\nimport { mapState } from 'vuex'\n\nexport default {\n  components: {\n    vueDropzone,\n    Header\n  },\n  data() {\n    return {\n      restApi2: '',\n      curlWorkflow: 'Video',\n      curlWorkflowTypes: [\"Image\", \"Video\"],\n      showWorkflowStatusApi: false,\n      showExecuteApi: false,\n      showGenericOperatorHelp: false,\n      requestURL: \"\",\n      requestBody: \"\",\n      requestType: \"\",\n      fields: [\n        {\n          'asset_id': {\n            label: \"Asset Id\",\n            sortable: false\n          }\n        },\n        {\n          'file_name': {\n            label: \"File Name\",\n            sortable: false\n          }\n        },\n        { 'workflow_status': {\n            label: 'Workflow Status',\n            sortable: false\n          }\n        }\n      ],\n      thumbnail_position: 10,\n      invalid_file_types: 0,\n      upload_in_progress: false,\n      enabledOperators: [\n        \"labelDetection\",\n        \"celebrityRecognition\",\n        \"textDetection\",\n        \"contentModeration\",\n        \"faceDetection\",\n        \"thumbnail\",\n        \"TranscribeVideo\",\n        \"Translate\",\n        \"ComprehendKeyPhrases\",\n        \"ComprehendEntities\",\n        \"shotDetection\",\n        \"technicalCueDetection\"\n      ],\n      videoOperators: [\n        { text: \"Object Detection\", value: \"labelDetection\" },\n        { text: \"Technical Cue Detection\", value: \"technicalCueDetection\" },\n        { text: \"Shot Detection\", value: \"shotDetection\" },\n        { text: \"Celebrity Recognition\", value: \"celebrityRecognition\" },\n        { text: \"Content Moderation\", value: \"contentModeration\" },\n        { text: \"Face Detection\", value: \"faceDetection\" },\n        { text: \"Word Detection\", value: \"textDetection\" },\n        { text: \"Face Search\", value: \"faceSearch\" },\n        { html: \"Generic Data Lookup\", value: \"genericDataLookup\" },\n      ],\n      audioOperators: [{ text: \"Transcribe\", value: \"TranscribeVideo\" }],\n      textOperators: [\n        { text: \"Comprehend Key Phrases\", value: \"ComprehendKeyPhrases\" },\n        { text: \"Comprehend Entities\", value: \"ComprehendEntities\" },\n        { text: \"Translate\", value: \"Translate\" }\n      ],\n      faceCollectionId: \"\",\n      genericDataFilename: \"\",\n      ComprehendEncryption: false,\n      kmsKeyId: \"\",\n      transcribeLanguage: \"en-US\",\n      transcribeLanguages: [\n        {text: 'Arabic, Gulf', value: 'ar-AE'},\n        {text: 'Arabic, Modern Standard', value: 'ar-SA'},\n        {text: 'Chinese Mandarin', value: 'zh-CN'},\n        {text: 'Dutch', value: 'nl-NL'},\n        {text: 'English, Australian', value: 'en-AU'},\n        {text: 'English, British', value: 'en-GB'},\n        {text: 'English, Indian-accented', value: 'en-IN'},\n        {text: 'English, Irish', value: 'en-IE'},\n        {text: 'English, Scottish', value: 'en-AB'},\n        {text: 'English, US', value: 'en-US'},\n        {text: 'English, Welsh', value: 'en-WL'},\n        // Disabled until 'fa' supported by AWS Translate\n        // {text: 'Farsi', value: 'fa-IR'},\n        {text: 'French', value: 'fr-FR'},\n        {text: 'French, Canadian', value: 'fr-CA'},\n        {text: 'German', value: 'de-DE'},\n        {text: 'German, Swiss', value: 'de-CH'},\n        {text: 'Hebrew', value: 'he-IL'},\n        {text: 'Hindi', value: 'hi-IN'},\n        {text: 'Indonesian', value: 'id-ID'},\n        {text: 'Italian', value: 'it-IT'},\n        {text: 'Japanese', value: 'ja-JP'},\n        {text: 'Korean', value: 'ko-KR'},\n        {text: 'Malay', value: 'ms-MY'},\n        {text: 'Portuguese', value: 'pt-PT'},\n        {text: 'Portuguese, Brazilian', value: 'pt-BR'},\n        {text: 'Russian', value: 'ru-RU'},\n        {text: 'Spanish', value: 'es-ES'},\n        {text: 'Spanish, US', value: 'es-US'},\n        {text: 'Tamil', value: 'ta-IN'},\n        // Disabled until 'te' supported by AWS Translate\n        // {text: 'Telugu', value: 'te-IN'},\n        {text: 'Turkish', value: 'tr-TR'},\n      ],\n      translateLanguages: [\n        {text: 'Afrikaans', value: 'af'},\n        {text: 'Albanian', value: 'sq'},\n        {text: 'Amharic', value: 'am'},\n        {text: 'Arabic', value: 'ar'},\n        {text: 'Azerbaijani', value: 'az'},\n        {text: 'Bengali', value: 'bn'},\n        {text: 'Bosnian', value: 'bs'},\n        {text: 'Bulgarian', value: 'bg'},\n        {text: 'Chinese (Simplified)', value: 'zh'},\n        // AWS Translate does not support translating from zh to zh-TW\n        // {text: 'Chinese (Traditional)', value: 'zh-TW'},\n        {text: 'Croatian', value: 'hr'},\n        {text: 'Czech', value: 'cs'},\n        {text: 'Danish', value: 'da'},\n        {text: 'Dari', value: 'fa-AF'},\n        {text: 'Dutch', value: 'nl'},\n        {text: 'English', value: 'en'},\n        {text: 'Estonian', value: 'et'},\n        {text: 'Finnish', value: 'fi'},\n        {text: 'French', value: 'fr'},\n        {text: 'French (Canadian)', value: 'fr-CA'},\n        {text: 'Georgian', value: 'ka'},\n        {text: 'German', value: 'de'},\n        {text: 'Greek', value: 'el'},\n        {text: 'Hausa', value: 'ha'},\n        {text: 'Hebrew', value: 'he'},\n        {text: 'Hindi', value: 'hi'},\n        {text: 'Hungarian', value: 'hu'},\n        {text: 'Indonesian', value: 'id'},\n        {text: 'Italian', value: 'it'},\n        {text: 'Japanese', value: 'ja'},\n        {text: 'Korean', value: 'ko'},\n        {text: 'Latvian', value: 'lv'},\n        {text: 'Malay', value: 'ms'},\n        {text: 'Norwegian', value: 'no'},\n        {text: 'Persian', value: 'fa'},\n        {text: 'Pashto', value: 'ps'},\n        {text: 'Polish', value: 'pl'},\n        {text: 'Portuguese', value: 'pt'},\n        {text: 'Romanian', value: 'ro'},\n        {text: 'Russian', value: 'ru'},\n        {text: 'Serbian', value: 'sr'},\n        {text: 'Slovak', value: 'sk'},\n        {text: 'Slovenian', value: 'sl'},\n        {text: 'Somali', value: 'so'},\n        {text: 'Spanish', value: 'es'},\n        {text: 'Swahili', value: 'sw'},\n        {text: 'Swedish', value: 'sv'},\n        {text: 'Tagalog', value: 'tl'},\n        {text: 'Tamil', value: 'ta'},\n        {text: 'Thai', value: 'th'},\n        {text: 'Turkish', value: 'tr'},\n        {text: 'Ukrainian', value: 'uk'},\n        {text: 'Urdu', value: 'ur'},\n        {text: 'Vietnamese', value: 'vi'},\n      ],\n      sourceLanguageCode: \"en\",\n      targetLanguageCode: \"es\",\n      uploadErrorMessage: \"\",\n      invalidFileMessage: \"\",\n      invalidFileMessages: [],\n      showInvalidFile: false,\n      dismissSecs: 8,\n      dismissCountDown: 0,\n      executed_assets: [],\n      workflow_status_polling: null,\n      workflow_config: {},\n      description: \"Click start to begin. Media analysis status will be shown after upload completes.\",\n      s3_destination: 's3://' + this.DATAPLANE_BUCKET,\n      dropzoneOptions: {\n        url: 'https://' + this.DATAPLANE_BUCKET + '.s3.amazonaws.com',\n        thumbnailWidth: 200,\n        addRemoveLinks: true,\n        autoProcessQueue: false,\n        // disable network timeouts (important for large uploads)\n        timeout: 0,\n        // limit max upload file size (in MB)\n        maxFilesize: 5000,\n      },\n      awss3: {\n        signingURL: '',\n        headers: {},\n        params: {}\n      }\n    }\n  },\n  computed: {\n    ...mapState(['execution_history']),\n    textFormError() {\n      return \"\";\n    },\n    audioFormError() {\n      // Validate transcribe is enabled if any text operator is enabled\n      if (\n          !this.enabledOperators.includes(\"TranscribeVideo\") &&\n          (this.enabledOperators.includes(\"Translate\") ||\n              this.enabledOperators.includes(\"ComprehendEntities\") ||\n              this.enabledOperators.includes(\"ComprehendKeyPhrases\"))\n      ) {\n        return \"Transcribe must be enabled if any text operator is enabled.\";\n      }\n      return \"\";\n    },\n    videoFormError() {\n      // Validate face collection ID if face search is enabled\n      if (this.enabledOperators.includes(\"faceSearch\")) {\n        // Validate that the collection ID is defined\n        if (this.faceCollectionId === \"\") {\n          return \"Face collection name is required.\";\n        }\n        // Validate that the collection ID matches required regex\n        else if (new RegExp(\"[^a-zA-Z0-9_.\\\\-]\").test(this.faceCollectionId)) {\n          return \"Face collection name must match pattern [a-zA-Z0-9_.\\\\\\\\-]+\";\n        }\n        // Validate that the collection ID is not too long\n        else if (this.faceCollectionId.length > 255) {\n          return \"Face collection name must have fewer than 255 characters.\";\n        }\n      }\n      if (this.enabledOperators.includes(\"genericDataLookup\")) {\n        // Validate that the collection ID is defined\n        if (this.genericDataFilename === \"\") {\n          return \"Generic data filename is required.\";\n        }\n        // Validate that the collection ID matches required regex\n        else if (!new RegExp(\"^.+\\\\.json$\").test(this.genericDataFilename)) {\n          return \"Generic data filename must have .json extension.\";\n        }\n        // Validate that the data filename is not too long\n        else if (this.genericDataFilename.length > 255) {\n          return \"Generic data filename must have fewer than 255 characters.\";\n        }\n      }\n      return \"\";\n    },\n    validForm() {\n      let validStatus = true;\n      if (\n          this.invalid_file_types ||\n          this.textFormError ||\n          this.audioFormError ||\n          this.videoFormError\n      )\n        validStatus = false;\n      return validStatus;\n    },\n    imageWorkflowConfig() {\n      // Define the image workflow based on user specified options for workflow configuration.\n      const ValidationStage = {\n        MediainfoImage: {\n          Enabled: true\n        }\n      }\n      const RekognitionStage = {\n        faceSearchImage: {\n          Enabled: this.enabledOperators.includes(\"faceSearch\"),\n          CollectionId:\n              this.faceCollectionId === \"\"\n                  ? \"undefined\"\n                  : this.faceCollectionId\n        },\n        labelDetectionImage: {\n          Enabled: this.enabledOperators.includes(\"labelDetection\")\n        },\n        textDetectionImage: {\n          Enabled: this.enabledOperators.includes(\"textDetection\")\n        },\n        celebrityRecognitionImage: {\n          Enabled: this.enabledOperators.includes(\n              \"celebrityRecognition\"\n          )\n        },\n        contentModerationImage: {\n          Enabled: this.enabledOperators.includes(\"contentModeration\")\n        },\n        faceDetectionImage: {\n          Enabled: this.enabledOperators.includes(\"faceDetection\")\n        }\n      }\n      const workflow_config = {\n        Name: \"CasImageWorkflow\",\n      }\n      workflow_config[\"Configuration\"] = {}\n      workflow_config[\"Configuration\"][\"ValidationStage\"] = ValidationStage\n      workflow_config[\"Configuration\"][\"RekognitionStage\"] = RekognitionStage\n      return workflow_config\n    },\n    videoWorkflowConfig() {\n      // Define the video workflow based on user specified options for workflow configuration.\n      const defaultPrelimVideoStage = {\n        Thumbnail: {\n          ThumbnailPosition: this.thumbnail_position.toString(),\n          Enabled: true\n        },\n        Mediainfo: {\n          Enabled: true\n        }\n      }\n      const defaultVideoStage = {\n        faceDetection: {\n          Enabled: this.enabledOperators.includes(\"faceDetection\")\n        },\n        technicalCueDetection: {\n          Enabled: this.enabledOperators.includes(\"technicalCueDetection\")\n        },\n        shotDetection: {\n          Enabled: this.enabledOperators.includes(\"shotDetection\")\n        },\n        celebrityRecognition: {\n          Enabled: this.enabledOperators.includes(\"celebrityRecognition\")\n        },\n        labelDetection: {\n          Enabled: this.enabledOperators.includes(\"labelDetection\")\n        },\n        contentModeration: {\n          Enabled: this.enabledOperators.includes(\"contentModeration\")\n        },\n        faceSearch: {\n          Enabled: this.enabledOperators.includes(\"faceSearch\"),\n          CollectionId:\n              this.faceCollectionId === \"\"\n                  ? \"undefined\"\n                  : this.faceCollectionId\n        },\n        textDetection: {\n          Enabled: this.enabledOperators.includes(\"textDetection\")\n        },\n        GenericDataLookup: {\n          Enabled: this.enabledOperators.includes(\"genericDataLookup\"),\n          Bucket: this.DATAPLANE_BUCKET,\n          Key:\n              this.genericDataFilename === \"\"\n                  ? \"undefined\"\n                  : this.genericDataFilename\n        }\n      }\n      const defaultAudioStage = {\n        TranscribeVideo: {\n          Enabled: this.enabledOperators.includes(\"TranscribeVideo\"),\n          TranscribeLanguage: this.transcribeLanguage\n        }\n      }\n      const defaultTextStage = {\n        Translate: {\n          Enabled: this.enabledOperators.includes(\"Translate\"),\n          SourceLanguageCode: this.transcribeLanguage.split(\"-\")[0],\n          TargetLanguageCode: this.targetLanguageCode\n        },\n        ComprehendEntities: {\n          Enabled: this.enabledOperators.includes(\"ComprehendEntities\")\n        },\n        ComprehendKeyPhrases: {\n          Enabled: this.enabledOperators.includes(\"ComprehendKeyPhrases\")\n        }\n      }\n      if (this.ComprehendEncryption === true && this.kmsKeyId.length > 0) {\n        defaultTextStage[\"ComprehendEntities\"][\"KmsKeyId\"] = this.kmsKeyId\n        defaultTextStage[\"ComprehendKeyPhrases\"][\"KmsKeyId\"] = this.kmsKeyId\n      }\n      const defaultTextSynthesisStage = {\n        // Polly is available in the MIECompleteWorkflow but not used in the front-end, so we've disabled it here.\n        Polly: {\n          Enabled: false\n        }\n      }\n      const workflow_config = {\n        Name: \"CasVideoWorkflow\",\n      }\n      workflow_config[\"Configuration\"] = {}\n      workflow_config[\"Configuration\"][\"defaultPrelimVideoStage\"] = defaultPrelimVideoStage\n      workflow_config[\"Configuration\"][\"defaultVideoStage\"] = defaultVideoStage\n      workflow_config[\"Configuration\"][\"defaultAudioStage\"] = defaultAudioStage\n      workflow_config[\"Configuration\"][\"defaultTextStage\"] = defaultTextStage\n      workflow_config[\"Configuration\"][\"defaultTextSynthesisStage\"] = defaultTextSynthesisStage\n      return workflow_config\n    },\n    curlWorkflowExecution() {\n      // get curl command to request workflow execution\n      return 'awsscurl -X POST --region '+ this.AWS_REGION +' -H \"Content-Type: application/json\" --data \\''+JSON.stringify(this.workflowConfigWithInput)+'\\' '+this.WORKFLOW_API_ENDPOINT+'workflow/execution'\n    },\n    sample_file() {\n      if (this.curlWorkflow === \"Video\") {\n        return \"SAMPLE_VIDEO.MP4\"\n      }\n      else if (this.curlWorkflow === \"Image\") {\n        return \"SAMPLE_IMAGE.PNG\"\n      }\n    },\n    curlExecutionHistory() {\n      // get curl command to request execution history\n      return 'awscurl -X GET --region '+ this.AWS_REGION +' -H \"Content-Type: application/json\" '+this.WORKFLOW_API_ENDPOINT+'workflow/execution/asset/{asset_id}'\n    },\n    workflowConfigWithInput() {\n      // This function is just used to pretty print the rest api\n      // for workflow execution in a popup modal\n      let data = {}\n      if (this.curlWorkflow === \"Video\") {\n        data = JSON.parse(JSON.stringify(this.videoWorkflowConfig));\n        data[\"Name\"] = \"CasVideoWorkflow\"\n      }\n      else if (this.curlWorkflow === \"Image\") {\n        data = JSON.parse(JSON.stringify(this.imageWorkflowConfig));\n        data[\"Name\"] = \"CasImageWorkflow\"\n      }\n      data[\"Input\"] = {\n        \"Media\": {\n          \"Video\": {\n            \"S3Bucket\": this.DATAPLANE_BUCKET,\n            \"S3Key\": this.sample_file\n          }\n        }\n      }\n      return data\n    }\n  },\n  created: function() {\n    if (this.$route.query.asset) {\n      this.hasAssetParam = true;\n      this.assetIdParam = this.$route.query.asset;\n    }\n  },\n  mounted: function() {\n    this.executed_assets = this.execution_history;\n    this.pollWorkflowStatus();\n  },\n  beforeDestroy () {\n    clearInterval(this.workflow_status_polling)\n  },\n  methods: {\n    selectAll: function() {\n      this.enabledOperators = [\n        \"labelDetection\",\n        \"textDetection\",\n        \"celebrityRecognition\",\n        \"contentModeration\",\n        \"faceDetection\",\n        \"thumbnail\",\n        \"TranscribeVideo\",\n        \"Translate\",\n        \"ComprehendKeyPhrases\",\n        \"ComprehendEntities\",\n        \"technicalCueDetection\",\n        \"shotDetection\"\n      ];\n      console.log(this.enabledOperators)\n    },\n    clearAll: function() {\n      this.enabledOperators = [];\n    },\n    openWindow: function(url) {\n      window.open(url, \"noopener,noreferer\");\n    },\n    countDownChanged(dismissCountDown) {\n      this.dismissCountDown = dismissCountDown;\n    },\n    s3UploadError(error) {\n      console.log(error);\n      // display alert\n      this.uploadErrorMessage = error;\n      this.dismissCountDown = this.dismissSecs;\n    },\n    fileAdded: function( file )\n    {\n      let errorMessage = '';\n      if (!(file.type).match(/image\\/.+|video\\/.+|application\\/mxf|application\\/json/g)) {\n        if (file.type === \"\")\n          errorMessage = \"Unsupported file type: unknown\";\n        else\n          errorMessage = \"Unsupported file type: \" + file.type;\n        this.invalidFileMessages.push(errorMessage);\n        this.showInvalidFile = true\n      }\n    },\n    fileRemoved: function( file )\n    {\n      let errorMessage = '';\n      if (!(file.type).match(/image\\/.+|video\\/.+|application\\/mxf|application\\/json/g)) {\n        if (file.type === \"\")\n          errorMessage = \"Unsupported file type: unknown\";\n        else\n          errorMessage = \"Unsupported file type: \" + file.type;\n      }\n      this.invalidFileMessages = this.invalidFileMessages.filter(function(value){ return value != errorMessage})\n      if (this.invalidFileMessages.length === 0 ) this.showInvalidFile = false;\n    },\n    runWorkflow: async function(file) {\n      const vm = this;\n      let media_type = null;\n      let s3Key = null;\n      if (\"s3_key\" in file) {\n        media_type = file.type;\n        s3Key = file.s3_key; // add in public since amplify prepends that to all keys\n      } else {\n        media_type = this.$route.query.mediaType;\n        s3Key = this.$route.query.s3key.split(\"/\").pop();\n      }\n      if (this.hasAssetParam) {\n        if (media_type === \"video\") {\n          this.workflow_config = vm.videoWorkflowConfig;\n          this.workflow_config[\"Input\"] = { AssetId: this.assetIdParam, Media: { Video: {} } };\n        } else if (media_type === \"image\") {\n          this.workflow_config = vm.imageWorkflowConfig;\n          this.workflow_config[\"Input\"] = { AssetId: this.assetIdParam, Media: { Image: {} } };\n        } else {\n          vm.s3UploadError(\n              \"Unsupported media type, \" + this.$route.query.mediaType + \".\"\n          );\n        }\n      } else {\n        if (media_type.match(/image/g)) {\n          this.workflow_config = vm.imageWorkflowConfig;\n          this.workflow_config[\"Input\"] = {\n            Media: {\n              Image: {\n                S3Bucket: this.DATAPLANE_BUCKET,\n                S3Key: s3Key\n              }\n            }\n          }\n        } else if (\n            media_type.match(/video/g) || media_type === \"application/mxf\"\n        ) {\n          this.workflow_config = vm.videoWorkflowConfig;\n          this.workflow_config[\"Input\"] = {\n            Media: {\n              Video: {\n                S3Bucket: this.DATAPLANE_BUCKET,\n                S3Key: s3Key\n              }\n            }\n          };\n        } else if (media_type === \"application/json\") {\n          // JSON files may be uploaded for the genericDataLookup operator, but\n          // we won't run a workflow for json file types.\n          //console.log(\"Data file has been uploaded to s3://\" + location.s3ObjectLocation.fields.key);\n          return;\n        } else {\n          vm.s3UploadError(\"Unsupported media type: \" + media_type + \".\");\n        }\n      }\n      console.log(\"workflow execution configuration:\")\n      console.log(JSON.stringify(this.workflow_config))\n      let apiName = 'mieWorkflowApi'\n      let path = 'workflow/execution'\n      let requestOpts = {\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        response: true,\n        body: this.workflow_config,\n        queryStringParameters: {} // optional\n      };\n      try {\n        let response = await this.$Amplify.API.post(apiName, path, requestOpts);\n        let asset_id = response.data.AssetId;\n        let wf_id = response.data.Id;\n        let executed_asset = {\n          asset_id: asset_id,\n          file_name: s3Key.replace('public/upload/', ''),\n          workflow_status: \"\",\n          state_machine_console_link: \"\",\n          wf_id: wf_id\n        };\n        vm.executed_assets.push(executed_asset);\n        vm.getWorkflowStatus(wf_id);\n        this.hasAssetParam = false;\n        this.assetIdParam = \"\";\n      } catch (error) {\n        console.log(\n            \"ERROR: Failed to start workflow. Check Workflow API logs.\"\n        );\n        console.log(error)\n      }\n    },\n    async getWorkflowStatus(wf_id) {\n      const vm = this;\n      let apiName = 'mieWorkflowApi'\n      let path =  \"workflow/execution/\" + wf_id\n      let requestOpts = {\n        headers: {},\n        response: true,\n        queryStringParameters: {} // optional\n      };\n      try {\n        let response = await this.$Amplify.API.get(apiName, path, requestOpts);\n        for (let i = 0; i < vm.executed_assets.length; i++) {\n          if (vm.executed_assets[i].wf_id === wf_id) {\n            vm.executed_assets[i].workflow_status = response.data.Status;\n            vm.executed_assets[i].state_machine_console_link =\n                \"https://\" + this.AWS_REGION + \".console.aws.amazon.com/states/home?region=\" + this.AWS_REGION + \"#/executions/details/\" + response.data.StateMachineExecutionArn;\n            break;\n          }\n        }\n        this.$store.commit(\"updateExecutedAssets\", vm.executed_assets);\n      } catch (error) {\n        console.log(\"ERROR: Failed to get workflow status\");\n        console.log(error)\n      }\n    },\n    pollWorkflowStatus() {\n      // Poll frequency in milliseconds\n      const poll_frequency = 5000;\n      this.workflow_status_polling = setInterval(() => {\n        this.executed_assets.forEach(item => {\n          if (\n              item.workflow_status === \"\" ||\n              item.workflow_status === \"Started\" ||\n              item.workflow_status === \"Queued\"\n          ) {\n            this.getWorkflowStatus(item.wf_id);\n          }\n        });\n      }, poll_frequency);\n    },\n    uploadFiles() {\n      console.log(\"Uploading to s3://\" + this.DATAPLANE_BUCKET,);\n      this.$refs.myVueDropzone.processQueue();\n    },\n    clearHistory() {\n      this.executed_assets = [];\n      this.$store.commit('updateExecutedAssets', this.executed_assets);\n\n    }\n  }\n}\n</script>\n<style>\ninput[type=text] {\n  width: 100%;\n  padding: 12px 20px;\n  margin: 8px 0;\n  box-sizing: border-box;\n}\n\nlabel {\n  font-weight: bold;\n}\n\n.note {\n  color: red;\n  font-family: \"Courier New\"\n}\n</style>\n"]}]}