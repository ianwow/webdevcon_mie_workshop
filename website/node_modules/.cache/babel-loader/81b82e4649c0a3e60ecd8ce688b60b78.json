{"remainingRequest":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/thread-loader/dist/cjs.js!/Users/ianwow/development/aws-content-analysis/source/website/node_modules/babel-loader/lib/index.js!/Users/ianwow/development/aws-content-analysis/source/website/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/ianwow/development/aws-content-analysis/source/website/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ianwow/development/aws-content-analysis/source/website/src/components/FaceDetection.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ianwow/development/aws-content-analysis/source/website/src/components/FaceDetection.vue","mtime":1637348724761},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/cache-loader/dist/cjs.js","mtime":1633407346687},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/thread-loader/dist/cjs.js","mtime":1633407346686},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/babel-loader/lib/index.js","mtime":1633407348173},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/cache-loader/dist/cjs.js","mtime":1633407346687},{"path":"/Users/ianwow/development/aws-content-analysis/source/website/node_modules/vue-loader/lib/index.js","mtime":1633407348650}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9pYW53b3cvZGV2ZWxvcG1lbnQvYXdzLWNvbnRlbnQtYW5hbHlzaXMvc291cmNlL3dlYnNpdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIi9Vc2Vycy9pYW53b3cvZGV2ZWxvcG1lbnQvYXdzLWNvbnRlbnQtYW5hbHlzaXMvc291cmNlL3dlYnNpdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL2lhbndvdy9kZXZlbG9wbWVudC9hd3MtY29udGVudC1hbmFseXNpcy9zb3VyY2Uvd2Vic2l0ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci50by1maXhlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IExvYWRpbmcgZnJvbSAnQC9jb21wb25lbnRzL0xvYWRpbmcudnVlJzsKaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICd2dWV4JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJGYWNlRGV0ZWN0aW9uIiwKICBjb21wb25lbnRzOiB7CiAgICBMb2FkaW5nOiBMb2FkaW5nCiAgfSwKICBwcm9wczogewogICAgbWVkaWFUeXBlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIiIKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJsQ29tbWFuZDogJycsCiAgICAgIHNlYXJjaFF1ZXJ5OiAnJywKICAgICAgc2hvd0VsYXN0aWNzZWFyY2hBcGlSZXF1ZXN0OiBmYWxzZSwKICAgICAgQ29uZmlkZW5jZTogOTAsCiAgICAgIGhpZ2hfY29uZmlkZW5jZV9kYXRhOiBbXSwKICAgICAgZWxhc3RpY3NlYXJjaF9kYXRhOiBbXSwKICAgICAgY291bnRfZGlzdGluY3RfbGFiZWxzOiAwLAogICAgICBjb3VudF9sYWJlbHM6IDAsCiAgICAgIGlzQnVzeTogZmFsc2UsCiAgICAgIG9wZXJhdG9yOiAnZmFjZV9kZXRlY3Rpb24nLAogICAgICBjYW52YXNSZWZyZXNoSW50ZXJ2YWw6IHVuZGVmaW5lZCwKICAgICAgdGltZXNlcmllczogbmV3IE1hcCgpLAogICAgICBzZWxlY3RlZExhYmVsOiAnJywKICAgICAgYm94ZXNfYXZhaWxhYmxlOiBbXSwKICAgICAgbG93ZXJDb25maWRlbmNlOiBmYWxzZSwKICAgICAgbG93ZXJDb25maWRlbmNlTWVzc2FnZTogJ1RyeSBsb3dlcmluZyBjb25maWRlbmNlIHRocmVzaG9sZCcKICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtYXBTdGF0ZShbJ3BsYXllciddKSksIHt9LCB7CiAgICBzb3J0ZWRfdW5pcXVlX2xhYmVsczogZnVuY3Rpb24gc29ydGVkX3VuaXF1ZV9sYWJlbHMoKSB7CiAgICAgIC8vIFRoaXMgZnVuY3Rpb24gc29ydHMgYW5kIGNvdW50cyB1bmlxdWUgbGFiZWxzIGZvciBtb3VzZSBvdmVyIGV2ZW50cyBvbiBsYWJlbCBidXR0b25zCiAgICAgIHZhciBlc19kYXRhID0gdGhpcy5lbGFzdGljc2VhcmNoX2RhdGE7CiAgICAgIHZhciB1bmlxdWVfbGFiZWxzID0gbmV3IE1hcCgpOyAvLyBzb3J0IGFuZCBjb3VudCB1bmlxdWUgbGFiZWxzIGZvciBsYWJlbCBtb3VzZSBvdmVyIGV2ZW50cwoKICAgICAgZXNfZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgICAgICB1bmlxdWVfbGFiZWxzLnNldChyZWNvcmQuTmFtZSwgdW5pcXVlX2xhYmVscy5nZXQocmVjb3JkLk5hbWUpID8gdW5pcXVlX2xhYmVscy5nZXQocmVjb3JkLk5hbWUpICsgMSA6IDEpOwoKICAgICAgICBpZiAocmVjb3JkLkJvdW5kaW5nQm94KSB7CiAgICAgICAgICAvLyBTYXZlIHRoaXMgbGFiZWwgbmFtZSB0byBhIGxpc3Qgb2YgbGFiZWxzIHRoYXQgaGF2ZSBib3VuZGluZyBib3hlcwogICAgICAgICAgdGhpcy5zYXZlQm94ZWRMYWJlbChyZWNvcmQuTmFtZSk7CiAgICAgICAgfQogICAgICB9LmJpbmQodGhpcykpOwogICAgICB2YXIgc29ydGVkX3VuaXF1ZV9sYWJlbHMgPSBuZXcgTWFwKF90b0NvbnN1bWFibGVBcnJheSh1bmlxdWVfbGFiZWxzLmVudHJpZXMoKSkuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgcmV0dXJuIGJbMV0gLSBhWzFdOwogICAgICB9KSk7IC8vIElmIEVsYXN0aWNzZWFyY2ggcmV0dXJuZWQgdW5kZWZpbmVkIGxhYmVscyB0aGVuIGRlbGV0ZSB0aGVtOgoKICAgICAgc29ydGVkX3VuaXF1ZV9sYWJlbHMuZGVsZXRlKHVuZGVmaW5lZCk7CiAgICAgIHRoaXMuY291bnRMYWJlbHMoc29ydGVkX3VuaXF1ZV9sYWJlbHMuc2l6ZSwgZXNfZGF0YS5sZW5ndGgpOwogICAgICByZXR1cm4gc29ydGVkX3VuaXF1ZV9sYWJlbHM7CiAgICB9CiAgfSksCiAgd2F0Y2g6IHsKICAgIC8vIFRoZXNlIHdhdGNoZXMgdXBkYXRlIHRoZSBsaW5lIGNoYXJ0CiAgICBzZWxlY3RlZExhYmVsOiBmdW5jdGlvbiBzZWxlY3RlZExhYmVsKCkgewogICAgICB0aGlzLmNoYXJ0RGF0YSgpOwogICAgfSwKICAgIGVsYXN0aWNzZWFyY2hfZGF0YTogZnVuY3Rpb24gZWxhc3RpY3NlYXJjaF9kYXRhKCkgewogICAgICB0aGlzLmNoYXJ0RGF0YSgpOwogICAgfQogIH0sCiAgZGVhY3RpdmF0ZWQ6IGZ1bmN0aW9uIGRlYWN0aXZhdGVkKCkgewogICAgY29uc29sZS5sb2coJ2FjdGl2YXRlZCBjb21wb25lbnQ6JywgdGhpcy5vcGVyYXRvcik7CiAgICB0aGlzLmJveGVzX2F2YWlsYWJsZSA9IFtdOwogICAgdGhpcy5zZWxlY3RlZExhYmVsID0gJyc7CiAgICBjbGVhckludGVydmFsKHRoaXMuY2FudmFzUmVmcmVzaEludGVydmFsKTsKICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7CiAgICB2YXIgY3R4OwogICAgaWYgKGNhbnZhcykgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICBpZiAoY3R4KSBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7CiAgfSwKICBhY3RpdmF0ZWQ6IGZ1bmN0aW9uIGFjdGl2YXRlZCgpIHsKICAgIGNvbnNvbGUubG9nKCdhY3RpdmF0ZWQgY29tcG9uZW50OicsIHRoaXMub3BlcmF0b3IpOwogICAgdGhpcy5mZXRjaEFzc2V0RGF0YSgpOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0Q3VybENvbW1hbmQoKTsKICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLmhpZ2hfY29uZmlkZW5jZV9kYXRhID0gW107CiAgICB0aGlzLmVsYXN0aWNzZWFyY2hfZGF0YSA9IFtdOwogICAgdGhpcy5jb3VudF9kaXN0aW5jdF9sYWJlbHMgPSAwOwogICAgdGhpcy5jb3VudF9sYWJlbHMgPSAwOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0Q3VybENvbW1hbmQ6IGZ1bmN0aW9uIGdldEN1cmxDb21tYW5kKCkgewogICAgICB0aGlzLnNlYXJjaFF1ZXJ5ID0gJ0Fzc2V0SWQ6JyArIHRoaXMuJHJvdXRlLnBhcmFtcy5hc3NldF9pZCArICcgQ29uZmlkZW5jZTo+JyArIHRoaXMuQ29uZmlkZW5jZSArICcgT3BlcmF0b3I6JyArIHRoaXMub3BlcmF0b3I7IC8vIGdldCBjdXJsIGNvbW1hbmQgdG8gc2VhcmNoIGVsYXN0aWNzZWFyY2gKCiAgICAgIHRoaXMuY3VybENvbW1hbmQgPSAnYXdzY3VybCAtWCBHRVQgLS1wcm9maWxlIGRlZmF1bHQgLS1zZXJ2aWNlIGVzIC0tcmVnaW9uICcgKyB0aGlzLkFXU19SRUdJT04gKyAnIFwnJyArIHRoaXMuU0VBUkNIX0VORFBPSU5UICsgJy9fc2VhcmNoP3E9JyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLnNlYXJjaFF1ZXJ5KSArICdcJyc7CiAgICB9LAogICAgZmV0Y2hBc3NldERhdGE6IGZ1bmN0aW9uIGZldGNoQXNzZXREYXRhKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgYXBpTmFtZSwgcGF0aCwgYXBpUGFyYW1zLCByZXNwb25zZSwgcmVzdWx0LCBkYXRhLCBlc19kYXRhLCBpLCBsZW4sIGl0ZW0sIGVtb3Rpb24sIGVtb3Rpb25zTGVuOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFwaU5hbWUgPSAnY29udGVudEFuYWx5c2lzRWxhc3RpY3NlYXJjaCc7CiAgICAgICAgICAgICAgICBwYXRoID0gJy9fc2VhcmNoJzsKICAgICAgICAgICAgICAgIGFwaVBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgJ3EnOiBfdGhpcy5zZWFyY2hRdWVyeSwKICAgICAgICAgICAgICAgICAgICAnZGVmYXVsdF9vcGVyYXRvcic6ICdBTkQnLAogICAgICAgICAgICAgICAgICAgICdzaXplJzogMTAwMDAKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRBbXBsaWZ5LkFQSS5nZXQoYXBpTmFtZSwgcGF0aCwgYXBpUGFyYW1zKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLnNob3dFbGFzdGljU2VhcmNoQWxlcnQgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IHJlc3VsdC5oaXRzLmhpdHM7CiAgICAgICAgICAgICAgICBlc19kYXRhID0gW107CgogICAgICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID09PSAwICYmIF90aGlzLkNvbmZpZGVuY2UgPiA1NSkgewogICAgICAgICAgICAgICAgICBfdGhpcy5sb3dlckNvbmZpZGVuY2UgPSB0cnVlOwogICAgICAgICAgICAgICAgICBfdGhpcy5sb3dlckNvbmZpZGVuY2VNZXNzYWdlID0gJ1RyeSBsb3dlcmluZyBjb25maWRlbmNlIHRocmVzaG9sZCc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpcy5sb3dlckNvbmZpZGVuY2UgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGRhdGEubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpdGVtID0gZGF0YVtpXS5fc291cmNlOwoKICAgICAgICAgICAgICAgICAgICBpZiAoIkVtb3Rpb25zIiBpbiBpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVtb3Rpb24gPSAwLCBlbW90aW9uc0xlbiA9IGl0ZW0uRW1vdGlvbnMubGVuZ3RoOyBlbW90aW9uIDwgZW1vdGlvbnNMZW47IGVtb3Rpb24rKykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5FbW90aW9uc1tlbW90aW9uXS5Db25maWRlbmNlID49IF90aGlzLkNvbmZpZGVuY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBlc19kYXRhLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5hbWUiOiBpdGVtLkVtb3Rpb25zW2Vtb3Rpb25dLlR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGltZXN0YW1wIjogaXRlbS5UaW1lc3RhbXAKICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJCZWFyZCIgaW4gaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uQmVhcmQuQ29uZmlkZW5jZSA+IF90aGlzLkNvbmZpZGVuY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXNfZGF0YS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAiTmFtZSI6ICJCZWFyZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJFeWVnbGFzc2VzIiBpbiBpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5FeWVnbGFzc2VzLkNvbmZpZGVuY2UgPiBfdGhpcy5Db25maWRlbmNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVzX2RhdGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIk5hbWUiOiAiRXllZ2xhc3NlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJFeWVzT3BlbiIgaW4gaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uRXllc09wZW4uQ29uZmlkZW5jZSA+IF90aGlzLkNvbmZpZGVuY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXNfZGF0YS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAiTmFtZSI6ICJFeWVzT3BlbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJNb3V0aE9wZW4iIGluIGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLk1vdXRoT3Blbi5Db25maWRlbmNlID4gX3RoaXMuQ29uZmlkZW5jZSkgewogICAgICAgICAgICAgICAgICAgICAgICBlc19kYXRhLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICJOYW1lIjogIk1vdXRoT3BlbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJNdXN0YWNoZSIgaW4gaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uTXVzdGFjaGUuQ29uZmlkZW5jZSA+IF90aGlzLkNvbmZpZGVuY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXNfZGF0YS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAiTmFtZSI6ICJNdXN0YWNoZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJTbWlsZSIgaW4gaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uU21pbGUuQ29uZmlkZW5jZSA+IF90aGlzLkNvbmZpZGVuY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXNfZGF0YS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAiTmFtZSI6ICJTbWlsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJTdW5nbGFzc2VzIiBpbiBpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5TdW5nbGFzc2VzLkNvbmZpZGVuY2UgPiBfdGhpcy5Db25maWRlbmNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVzX2RhdGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIk5hbWUiOiAiU3VuZ2xhc3NlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCJHZW5kZXIiIGluIGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgIGVzX2RhdGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICJOYW1lIjogaXRlbS5HZW5kZXIuVmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJUaW1lc3RhbXAiOiBpdGVtLlRpbWVzdGFtcAogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoIkJvdW5kaW5nQm94IiBpbiBpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICBlc19kYXRhLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAiTmFtZSI6ICJGYWNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRpbWVzdGFtcCI6IGl0ZW0uVGltZXN0YW1wLAogICAgICAgICAgICAgICAgICAgICAgICAiQ29uZmlkZW5jZSI6IGl0ZW0uQ29uZmlkZW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgIkJvdW5kaW5nQm94IjogewogICAgICAgICAgICAgICAgICAgICAgICAgICJXaWR0aCI6IGl0ZW0uQm91bmRpbmdCb3guV2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIkhlaWdodCI6IGl0ZW0uQm91bmRpbmdCb3guSGVpZ2h0LAogICAgICAgICAgICAgICAgICAgICAgICAgICJMZWZ0IjogaXRlbS5Cb3VuZGluZ0JveC5MZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICAgICJUb3AiOiBpdGVtLkJvdW5kaW5nQm94LlRvcAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpcy5lbGFzdGljc2VhcmNoX2RhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVzX2RhdGEpKTsKICAgICAgICAgICAgICAgIF90aGlzLmlzQnVzeSA9IGZhbHNlOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNhdmVCb3hlZExhYmVsOiBmdW5jdGlvbiBzYXZlQm94ZWRMYWJlbChsYWJlbF9uYW1lKSB7CiAgICAgIGlmICghdGhpcy5ib3hlc19hdmFpbGFibGUuaW5jbHVkZXMobGFiZWxfbmFtZSkpIHsKICAgICAgICB0aGlzLmJveGVzX2F2YWlsYWJsZS5wdXNoKGxhYmVsX25hbWUpOwogICAgICB9CiAgICB9LAogICAgY291bnRMYWJlbHM6IGZ1bmN0aW9uIGNvdW50TGFiZWxzKHVuaXF1ZV9jb3VudCwgdG90YWxfY291bnQpIHsKICAgICAgdGhpcy5jb3VudF9kaXN0aW5jdF9sYWJlbHMgPSB1bmlxdWVfY291bnQ7CiAgICAgIHRoaXMuY291bnRfbGFiZWxzID0gdG90YWxfY291bnQ7CiAgICB9LAogICAgc2F2ZUZpbGU6IGZ1bmN0aW9uIHNhdmVGaWxlKCkgewogICAgICB2YXIgZWxhc3RpY3NlYXJjaF9kYXRhID0gSlNPTi5zdHJpbmdpZnkodGhpcy5lbGFzdGljc2VhcmNoX2RhdGEpOwogICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtlbGFzdGljc2VhcmNoX2RhdGFdLCB7CiAgICAgICAgdHlwZTogJ3RleHQvcGxhaW4nCiAgICAgIH0pOwogICAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50cycpLAogICAgICAgICAgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgYS5kb3dubG9hZCA9ICJkYXRhLmpzb24iOwogICAgICBhLmhyZWYgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgYS5kYXRhc2V0LmRvd25sb2FkdXJsID0gWyd0ZXh0L2pzb24nLCBhLmRvd25sb2FkLCBhLmhyZWZdLmpvaW4oJzonKTsKICAgICAgZS5pbml0RXZlbnQoJ2NsaWNrJywgdHJ1ZSwgZmFsc2UsIHdpbmRvdywgMCwgMCwgMCwgMCwgMCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGwpOwogICAgICBhLmRpc3BhdGNoRXZlbnQoZSk7CiAgICB9LAogICAgdXBkYXRlQ29uZmlkZW5jZTogZnVuY3Rpb24gdXBkYXRlQ29uZmlkZW5jZShldmVudCkgewogICAgICB0aGlzLmlzQnVzeSA9IHRydWU7CiAgICAgIHRoaXMuQ29uZmlkZW5jZSA9IGV2ZW50LnRhcmdldC52YWx1ZTsKCiAgICAgIGlmICh0aGlzLm1lZGlhVHlwZSA9PT0gInZpZGVvIikgewogICAgICAgIC8vIHJlZHJhdyBtYXJrZXJzIG9uIHZpZGVvIHRpbWVsaW5lCiAgICAgICAgdGhpcy5wbGF5ZXIubWFya2Vycy5yZW1vdmVBbGwoKTsKICAgICAgfQoKICAgICAgdGhpcy5nZXRDdXJsQ29tbWFuZCgpOwogICAgICB0aGlzLmZldGNoQXNzZXREYXRhKCk7CiAgICB9LAogICAgLy8gdXBkYXRlTWFya2VycyB1cGRhdGVzIG1hcmtlcnMgaW4gdGhlIHZpZGVvIHBsYXllciBhbmQgaXMgY2FsbGVkIHdoZW4gc29tZW9uZSBjbGlja3Mgb24gYSBsYWJlbCBidXR0b24KICAgIHVwZGF0ZU1hcmtlcnM6IGZ1bmN0aW9uIHVwZGF0ZU1hcmtlcnMobGFiZWwpIHsKICAgICAgLy8gY2xlYXIgY2FudmFzIGZvciByZWRyYXdpbmcKICAgICAgdGhpcy5ib3hlc19hdmFpbGFibGUgPSBbXTsKICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNhbnZhc1JlZnJlc2hJbnRlcnZhbCk7CiAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7CiAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwogICAgICBjdHguc3Ryb2tlU3R5bGUgPSAicmVkIjsKICAgICAgY3R4LmZvbnQgPSAiMTVweCBBcmlhbCI7CiAgICAgIGN0eC50ZXh0QWxpZ24gPSAiY2VudGVyIjsKICAgICAgY3R4LnRleHRCYXNlbGluZSA9ICJtaWRkbGUiOwogICAgICBjdHguZmlsbFN0eWxlID0gInJlZCI7CgogICAgICBpZiAodGhpcy5zZWxlY3RlZExhYmVsID09PSBsYWJlbCkgewogICAgICAgIC8vIGtlZXAgdGhlIGNhbnZhcyBjbGVhciBjYW52YXMgaWYgdXNlciBjbGlja2VkIHRoZSBsYWJlbCBidXR0b24gYSBzZWNvbmQgY29uc2VjdXRpdmUgdGltZQogICAgICAgIHRoaXMuc2VsZWN0ZWRMYWJlbCA9ICIiOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5zZWxlY3RlZExhYmVsID0gbGFiZWw7IC8vIGluaXRpYWxpemUgbGlzdHMgb2YgYm94ZXMgYW5kIG1hcmtlcnMgdG8gYmUgZHJhd24KCiAgICAgIHZhciBib3hNYXAgPSBuZXcgTWFwKCk7CiAgICAgIHZhciBtYXJrZXJzID0gW107CiAgICAgIHZhciBlc19kYXRhID0gdGhpcy5lbGFzdGljc2VhcmNoX2RhdGE7CiAgICAgIHZhciBpbnN0YW5jZSA9IDA7CiAgICAgIHZhciBpID0gMDsKICAgICAgZXNfZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgICAgICBpZiAocmVjb3JkLk5hbWUgPT09IGxhYmVsKSB7CiAgICAgICAgICBtYXJrZXJzLnB1c2goewogICAgICAgICAgICAndGltZSc6IHJlY29yZC5UaW1lc3RhbXAgLyAxMDAwLAogICAgICAgICAgICAndGV4dCc6IHJlY29yZC5OYW1lLAogICAgICAgICAgICAnb3ZlcmxheVRleHQnOiByZWNvcmQuTmFtZQogICAgICAgICAgfSk7IC8vIFNhdmUgYm91bmRpbmcgYm94IGluZm8gaWYgaXQgZXhpc3RzCgogICAgICAgICAgaWYgKHJlY29yZC5Cb3VuZGluZ0JveCkgewogICAgICAgICAgICAvLyBUT0RPOiBtb3ZlIGltYWdlIHByb2Nlc3NpbmcgdG8gYSBzZXBhcmF0ZSBjb21wb25lbnQKICAgICAgICAgICAgaWYgKHRoaXMubWVkaWFUeXBlID09PSAiaW1hZ2UiKSB7CiAgICAgICAgICAgICAgdmFyIGJveGluZm8gPSB7CiAgICAgICAgICAgICAgICAnaW5zdGFuY2UnOiBpLAogICAgICAgICAgICAgICAgJ25hbWUnOiByZWNvcmQuTmFtZSwKICAgICAgICAgICAgICAgICdjb25maWRlbmNlJzogKHJlY29yZC5Db25maWRlbmNlICogMSkudG9GaXhlZCgyKSwKICAgICAgICAgICAgICAgICd4JzogcmVjb3JkLkJvdW5kaW5nQm94LkxlZnQgKiBjYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICAneSc6IHJlY29yZC5Cb3VuZGluZ0JveC5Ub3AgKiBjYW52YXMuaGVpZ2h0LAogICAgICAgICAgICAgICAgJ3dpZHRoJzogcmVjb3JkLkJvdW5kaW5nQm94LldpZHRoICogY2FudmFzLndpZHRoLAogICAgICAgICAgICAgICAgJ2hlaWdodCc6IHJlY29yZC5Cb3VuZGluZ0JveC5IZWlnaHQgKiBjYW52YXMuaGVpZ2h0CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBib3hNYXAuc2V0KGkrKywgW2JveGluZm9dKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBVc2UgdGltZSByZXNvbHV0aW9uIG9mIDAuMSBzZWNvbmQKICAgICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gTWF0aC5yb3VuZChyZWNvcmQuVGltZXN0YW1wIC8gMTAwKTsKCiAgICAgICAgICAgICAgaWYgKGJveE1hcC5oYXModGltZXN0YW1wKSkgewogICAgICAgICAgICAgICAgdmFyIF9ib3hpbmZvID0gewogICAgICAgICAgICAgICAgICAnaW5zdGFuY2UnOiBpbnN0YW5jZSsrLAogICAgICAgICAgICAgICAgICAndGltZXN0YW1wJzogTWF0aC5jZWlsKHJlY29yZC5UaW1lc3RhbXAgLyAxMDApLAogICAgICAgICAgICAgICAgICAnbmFtZSc6IHJlY29yZC5OYW1lLAogICAgICAgICAgICAgICAgICAnY29uZmlkZW5jZSc6IChyZWNvcmQuQ29uZmlkZW5jZSAqIDEpLnRvRml4ZWQoMiksCiAgICAgICAgICAgICAgICAgICd4JzogcmVjb3JkLkJvdW5kaW5nQm94LkxlZnQgKiBjYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICd5JzogcmVjb3JkLkJvdW5kaW5nQm94LlRvcCAqIGNhbnZhcy5oZWlnaHQsCiAgICAgICAgICAgICAgICAgICd3aWR0aCc6IHJlY29yZC5Cb3VuZGluZ0JveC5XaWR0aCAqIGNhbnZhcy53aWR0aCwKICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6IHJlY29yZC5Cb3VuZGluZ0JveC5IZWlnaHQgKiBjYW52YXMuaGVpZ2h0CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgYm94TWFwLmdldCh0aW1lc3RhbXApLnB1c2goX2JveGluZm8pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IDA7CiAgICAgICAgICAgICAgICB2YXIgX2JveGluZm8yID0gewogICAgICAgICAgICAgICAgICAnaW5zdGFuY2UnOiBpbnN0YW5jZSsrLAogICAgICAgICAgICAgICAgICAndGltZXN0YW1wJzogTWF0aC5jZWlsKHJlY29yZC5UaW1lc3RhbXAgLyAxMDApLAogICAgICAgICAgICAgICAgICAnbmFtZSc6IHJlY29yZC5OYW1lLAogICAgICAgICAgICAgICAgICAnY29uZmlkZW5jZSc6IChyZWNvcmQuQ29uZmlkZW5jZSAqIDEpLnRvRml4ZWQoMiksCiAgICAgICAgICAgICAgICAgICd4JzogcmVjb3JkLkJvdW5kaW5nQm94LkxlZnQgKiBjYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICd5JzogcmVjb3JkLkJvdW5kaW5nQm94LlRvcCAqIGNhbnZhcy5oZWlnaHQsCiAgICAgICAgICAgICAgICAgICd3aWR0aCc6IHJlY29yZC5Cb3VuZGluZ0JveC5XaWR0aCAqIGNhbnZhcy53aWR0aCwKICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6IHJlY29yZC5Cb3VuZGluZ0JveC5IZWlnaHQgKiBjYW52YXMuaGVpZ2h0CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgYm94TWFwLnNldCh0aW1lc3RhbXAsIFtfYm94aW5mbzJdKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0uYmluZCh0aGlzKSk7CgogICAgICBpZiAoYm94TWFwLnNpemUgPiAwKSB7CiAgICAgICAgdGhpcy5kcmF3Qm94ZXMoYm94TWFwKTsKICAgICAgfSAvLyBUT0RPOiBtb3ZlIGltYWdlIHByb2Nlc3NpbmcgdG8gYSBzZXBhcmF0ZSBjb21wb25lbnQKCgogICAgICBpZiAodGhpcy5tZWRpYVR5cGUgPT09ICJ2aWRlbyIpIHsKICAgICAgICAvLyByZWRyYXcgbWFya2VycyBvbiB2aWRlbyB0aW1lbGluZQogICAgICAgIHRoaXMucGxheWVyLm1hcmtlcnMucmVtb3ZlQWxsKCk7CiAgICAgICAgdGhpcy5wbGF5ZXIubWFya2Vycy5hZGQobWFya2Vycyk7CiAgICAgIH0KICAgIH0sCiAgICBkcmF3Qm94ZXM6IGZ1bmN0aW9uIGRyYXdCb3hlcyhib3hNYXApIHsKICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKTsKICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOyAvLyBUT0RPOiBtb3ZlIGltYWdlIHByb2Nlc3NpbmcgdG8gYSBzZXBhcmF0ZSBjb21wb25lbnQKCiAgICAgIGlmICh0aGlzLm1lZGlhVHlwZSA9PT0gImltYWdlIikgewogICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gInJlZCI7CiAgICAgICAgY3R4LmZvbnQgPSAiMTVweCBBcmlhbCI7CiAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAibWlkZGxlIjsKICAgICAgICBjdHguZmlsbFN0eWxlID0gInJlZCI7IC8vIEZvciBlYWNoIGJveCBpbnN0YW5jZS4uLgoKICAgICAgICBib3hNYXAuZm9yRWFjaChmdW5jdGlvbiAoaSkgewogICAgICAgICAgdmFyIGRyYXdNZSA9IGlbMF07CgogICAgICAgICAgaWYgKGRyYXdNZSkgewogICAgICAgICAgICBjdHgucmVjdChkcmF3TWUueCwgZHJhd01lLnksIGRyYXdNZS53aWR0aCwgZHJhd01lLmhlaWdodCk7IC8vIERyYXcgb2JqZWN0IG5hbWUgYW5kIGNvbmZpZGVuY2Ugc2NvcmUKCiAgICAgICAgICAgIGN0eC5maWxsVGV4dChkcmF3TWUubmFtZSArICIgKCIgKyBkcmF3TWUuY29uZmlkZW5jZSArICIlKSIsIGRyYXdNZS54ICsgZHJhd01lLndpZHRoIC8gMiwgZHJhd01lLnkgLSAxMCk7CiAgICAgICAgICAgIGN0eC5zdHJva2UoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsgLy8gbm93IHJldHVybiBzbyB3ZSBhdm9pZCByZW5kZXJpbmcgYW55IG9mIHRoZSB2aWRlbyByZWxhdGVkIGNvbXBvbmVudHMgYmVsb3cKCiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIElmIHVzZXIganVzdCBjbGlja2VkIGEgbmV3IGxhYmVsLi4uCgoKICAgICAgaWYgKHRoaXMuY2FudmFzUmVmcmVzaEludGVydmFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAvLyAuLi50aGVuIHJlc2V0IHRoZSBvbGQgY2FudmFzIHJlZnJlc2ggaW50ZXJ2YWwuCiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNhbnZhc1JlZnJlc2hJbnRlcnZhbCk7CiAgICAgIH0gLy8gTG9vayBmb3IgYW5kIGRyYXcgYm91bmRpbmcgYm94ZXMgZXZlcnkgMTAwbXMKCgogICAgICB2YXIgaW50ZXJ2YWxfbXMgPSAxMDA7CiAgICAgIHZhciBlcmFzZV9vbl9pdGVyYXRpb24gPSAyOwogICAgICB2YXIgaSA9IDA7CiAgICAgIHRoaXMuY2FudmFzUmVmcmVzaEludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgIGkrKzsgLy8gZXJhc2Ugb2xkIGJvdW5kaW5nIGJveGVzCgogICAgICAgIGlmICghdGhpcy5wbGF5ZXIucGF1c2VkKCkgJiYgaSAlIGVyYXNlX29uX2l0ZXJhdGlvbiA9PT0gMCkgewogICAgICAgICAgaSA9IDA7CiAgICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7CiAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAicmVkIjsKICAgICAgICAgIGN0eC5mb250ID0gIjE1cHggQXJpYWwiOwogICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9ICJtaWRkbGUiOwogICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICJyZWQiOwogICAgICAgIH0gLy8gR2V0IGN1cnJlbnQgcGxheWVyIHRpbWVzdGFtcCB0byB0aGUgbmVhcmVzdCAxLzEwdGggc2Vjb25kCgoKICAgICAgICB2YXIgcGxheWVyX3RpbWVzdGFtcCA9IE1hdGgucm91bmQodGhpcy5wbGF5ZXIuY3VycmVudFRpbWUoKSAqIDEwLjApOyAvLyBJZiB3ZSBoYXZlIGEgYm94IGZvciB0aGUgcGxheWVyJ3MgdGltZXN0YW1wLi4uCgogICAgICAgIGlmIChib3hNYXAuaGFzKHBsYXllcl90aW1lc3RhbXApKSB7CiAgICAgICAgICBpID0gMDsKICAgICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICJyZWQiOwogICAgICAgICAgY3R4LmZvbnQgPSAiMTVweCBBcmlhbCI7CiAgICAgICAgICBjdHgudGV4dEFsaWduID0gImNlbnRlciI7CiAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gIm1pZGRsZSI7CiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gInJlZCI7IC8vIC4uLnRoZW4gZ2V0IGEgbGlzdCBvZiBib3ggaW5zdGFuY2VzCgogICAgICAgICAgdmFyIGluc3RhbmNlX2xpc3QgPSBib3hNYXAuZ2V0KHBsYXllcl90aW1lc3RhbXApLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS5pbnN0YW5jZTsKICAgICAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAodiwgaSwgYSkgewogICAgICAgICAgICByZXR1cm4gYS5pbmRleE9mKHYpID09PSBpOwogICAgICAgICAgfSk7IC8vIEZvciBlYWNoIGJveCBpbnN0YW5jZS4uLgoKICAgICAgICAgIGluc3RhbmNlX2xpc3QuZm9yRWFjaChmdW5jdGlvbiAoaSkgewogICAgICAgICAgICAvLyAuLi5nZXQgYWxsIG9mIHRoZSBib3hlcyBiZWxvbmdpbmcgdG8gdGhpcyBpbnN0YW5jZQogICAgICAgICAgICAvLyBhdCB0aGUgY3VycmVudCB0aW1lc3RhbXAuCiAgICAgICAgICAgIHZhciBib3hlcyA9IGJveE1hcC5nZXQocGxheWVyX3RpbWVzdGFtcCkuZmlsdGVyKGZ1bmN0aW9uIChib3gpIHsKICAgICAgICAgICAgICByZXR1cm4gYm94Lmluc3RhbmNlID09PSBpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYm94ZXMuZm9yRWFjaChmdW5jdGlvbiAoZHJhd01lKSB7CiAgICAgICAgICAgICAgaWYgKGRyYXdNZSkgewogICAgICAgICAgICAgICAgY3R4LnJlY3QoZHJhd01lLngsIGRyYXdNZS55LCBkcmF3TWUud2lkdGgsIGRyYXdNZS5oZWlnaHQpOyAvLyBEcmF3IG9iamVjdCBuYW1lIGFuZCBjb25maWRlbmNlIHNjb3JlCgogICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KGRyYXdNZS5uYW1lICsgIiAoIiArIGRyYXdNZS5jb25maWRlbmNlICsgIiUpIiwgZHJhd01lLnggKyBkcmF3TWUud2lkdGggLyAyLCBkcmF3TWUueSAtIDEwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgfQogICAgICB9LmJpbmQodGhpcyksIGludGVydmFsX21zKTsKICAgIH0sCiAgICBjaGFydERhdGE6IGZ1bmN0aW9uIGNoYXJ0RGF0YSgpIHsKICAgICAgdmFyIHRpbWVzZXJpZXMgPSBuZXcgTWFwKCk7CgogICAgICBmdW5jdGlvbiBzYXZlVGltZXN0YW1wKG1pbGxpc2Vjb25kKSB7CiAgICAgICAgaWYgKHRpbWVzZXJpZXMuaGFzKG1pbGxpc2Vjb25kKSkgewogICAgICAgICAgdGltZXNlcmllcy5zZXQobWlsbGlzZWNvbmQsIHsKICAgICAgICAgICAgIngiOiBtaWxsaXNlY29uZCwKICAgICAgICAgICAgInkiOiB0aW1lc2VyaWVzLmdldChtaWxsaXNlY29uZCkueSArIDEKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aW1lc2VyaWVzLnNldChtaWxsaXNlY29uZCwgewogICAgICAgICAgICAieCI6IG1pbGxpc2Vjb25kLAogICAgICAgICAgICAieSI6IDEKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGVzX2RhdGEgPSB0aGlzLmVsYXN0aWNzZWFyY2hfZGF0YTsKICAgICAgZXNfZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgICAgICAvLyBEZWZpbmUgdGltZXN0YW1wIHdpdGggbWlsbGlzZWNvbmQgcmVzb2x1dGlvbgogICAgICAgIHZhciBtaWxsaXNlY29uZCA9IE1hdGgucm91bmQocmVjb3JkLlRpbWVzdGFtcCk7CgogICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTGFiZWwpIHsKICAgICAgICAgIC8vIE5vIGxhYmVsIGhhcyBiZWVuIHNlbGVjdGVkLCBzbyBlbnVtZXJhdGUgdGltZXN0YW1wcyBmb3IgYWxsIGxhYmVsIG5hbWVzLgogICAgICAgICAgaWYgKHJlY29yZC5OYW1lID09PSB0aGlzLnNlbGVjdGVkTGFiZWwpIHsKICAgICAgICAgICAgc2F2ZVRpbWVzdGFtcChtaWxsaXNlY29uZCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIExhYmVsIGlzIHVuZGVmaW5lZC4gRW51bWVyYXRlIHRpbWVzdGFtcHMgZm9yIGFsbCBsYWJlbCBuYW1lcy4KICAgICAgICAgIHNhdmVUaW1lc3RhbXAobWlsbGlzZWNvbmQpOwogICAgICAgIH0KICAgICAgfS5iaW5kKHRoaXMpKTsgLy9zb3J0IHRoZSB0aW1lc2VyaWVzIG1hcCBieSBpdHMgbWlsbGlzZWNvbmQga2V5CgogICAgICB2YXIgb3JkZXJlZF90aW1lc2VyaWVzID0gbmV3IE1hcChfdG9Db25zdW1hYmxlQXJyYXkodGltZXNlcmllcy5lbnRyaWVzKCkpLnNsaWNlKCkuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgIHJldHVybiBhWzBdIC0gYlswXTsKICAgICAgfSkpOwogICAgICB2YXIgY2hhcnRUdXBsZXMgPSBBcnJheS5mcm9tKG9yZGVyZWRfdGltZXNlcmllcy52YWx1ZXMoKSk7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgndXBkYXRlVGltZXNlcmllcycsIGNoYXJ0VHVwbGVzKTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCd1cGRhdGVTZWxlY3RlZExhYmVsJywgdGhpcy5zZWxlY3RlZExhYmVsKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["FaceDetection.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmHA,OAAA,OAAA,MAAA,0BAAA;AACA,SAAA,QAAA,QAAA,MAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,eADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA,OAAA,EAAA;AADA,GAFA;AAKA,EAAA,KAAA,EAAA;AACA,IAAA,SAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA;AADA,GALA;AAWA,EAAA,IAXA,kBAWA;AACA,WAAA;AACA,MAAA,WAAA,EAAA,EADA;AAEA,MAAA,WAAA,EAAA,EAFA;AAGA,MAAA,2BAAA,EAAA,KAHA;AAIA,MAAA,UAAA,EAAA,EAJA;AAKA,MAAA,oBAAA,EAAA,EALA;AAMA,MAAA,kBAAA,EAAA,EANA;AAOA,MAAA,qBAAA,EAAA,CAPA;AAQA,MAAA,YAAA,EAAA,CARA;AASA,MAAA,MAAA,EAAA,KATA;AAUA,MAAA,QAAA,EAAA,gBAVA;AAWA,MAAA,qBAAA,EAAA,SAXA;AAYA,MAAA,UAAA,EAAA,IAAA,GAAA,EAZA;AAaA,MAAA,aAAA,EAAA,EAbA;AAcA,MAAA,eAAA,EAAA,EAdA;AAeA,MAAA,eAAA,EAAA,KAfA;AAgBA,MAAA,sBAAA,EAAA;AAhBA,KAAA;AAkBA,GA9BA;AA+BA,EAAA,QAAA,kCACA,QAAA,CAAA,CAAA,QAAA,CAAA,CADA;AAEA,IAAA,oBAFA,kCAEA;AACA;AACA,UAAA,OAAA,GAAA,KAAA,kBAAA;AACA,UAAA,aAAA,GAAA,IAAA,GAAA,EAAA,CAHA,CAIA;;AACA,MAAA,OAAA,CAAA,OAAA,CAAA,UAAA,MAAA,EAAA;AACA,QAAA,aAAA,CAAA,GAAA,CAAA,MAAA,CAAA,IAAA,EAAA,aAAA,CAAA,GAAA,CAAA,MAAA,CAAA,IAAA,IAAA,aAAA,CAAA,GAAA,CAAA,MAAA,CAAA,IAAA,IAAA,CAAA,GAAA,CAAA;;AACA,YAAA,MAAA,CAAA,WAAA,EAAA;AACA;AACA,eAAA,cAAA,CAAA,MAAA,CAAA,IAAA;AACA;AACA,OANA,CAMA,IANA,CAMA,IANA,CAAA;AAOA,UAAA,oBAAA,GAAA,IAAA,GAAA,CAAA,mBAAA,aAAA,CAAA,OAAA,EAAA,EAAA,KAAA,GAAA,IAAA,CAAA,UAAA,CAAA,EAAA,CAAA;AAAA,eAAA,CAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA,CAAA,CAAA;AAAA,OAAA,CAAA,CAAA,CAZA,CAaA;;AACA,MAAA,oBAAA,CAAA,MAAA,CAAA,SAAA;AACA,WAAA,WAAA,CAAA,oBAAA,CAAA,IAAA,EAAA,OAAA,CAAA,MAAA;AACA,aAAA,oBAAA;AACA;AAnBA,IA/BA;AAoDA,EAAA,KAAA,EAAA;AACA;AACA,IAAA,aAAA,EAAA,yBAAA;AACA,WAAA,SAAA;AACA,KAJA;AAKA,IAAA,kBAAA,EAAA,8BAAA;AACA,WAAA,SAAA;AACA;AAPA,GApDA;AA6DA,EAAA,WAAA,EAAA,uBAAA;AACA,IAAA,OAAA,CAAA,GAAA,CAAA,sBAAA,EAAA,KAAA,QAAA;AACA,SAAA,eAAA,GAAA,EAAA;AACA,SAAA,aAAA,GAAA,EAAA;AACA,IAAA,aAAA,CAAA,KAAA,qBAAA,CAAA;AACA,QAAA,MAAA,GAAA,QAAA,CAAA,cAAA,CAAA,QAAA,CAAA;AACA,QAAA,GAAA;AACA,QAAA,MAAA,EAAA,GAAA,GAAA,MAAA,CAAA,UAAA,CAAA,IAAA,CAAA;AACA,QAAA,GAAA,EAAA,GAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA;AACA,GAtEA;AAuEA,EAAA,SAAA,EAAA,qBAAA;AACA,IAAA,OAAA,CAAA,GAAA,CAAA,sBAAA,EAAA,KAAA,QAAA;AACA,SAAA,cAAA;AACA,GA1EA;AA2EA,EAAA,OAAA,EAAA,mBAAA;AACA,SAAA,cAAA;AACA,GA7EA;AA8EA,EAAA,aAAA,EAAA,yBAAA;AACA,SAAA,oBAAA,GAAA,EAAA;AACA,SAAA,kBAAA,GAAA,EAAA;AACA,SAAA,qBAAA,GAAA,CAAA;AACA,SAAA,YAAA,GAAA,CAAA;AACA,GAnFA;AAoFA,EAAA,OAAA,EAAA;AACA,IAAA,cADA,4BACA;AACA,WAAA,WAAA,GAAA,aAAA,KAAA,MAAA,CAAA,MAAA,CAAA,QAAA,GAAA,eAAA,GAAA,KAAA,UAAA,GAAA,YAAA,GAAA,KAAA,QAAA,CADA,CAEA;;AACA,WAAA,WAAA,GAAA,4DAAA,KAAA,UAAA,GAAA,KAAA,GAAA,KAAA,eAAA,GAAA,aAAA,GAAA,kBAAA,CAAA,KAAA,WAAA,CAAA,GAAA,IAAA;AACA,KALA;AAMA,IAAA,cANA,4BAMA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,OADA,GACA,8BADA;AAEA,gBAAA,IAFA,GAEA,UAFA;AAGA,gBAAA,SAHA,GAGA;AACA,kBAAA,OAAA,EAAA;AAAA,oCAAA;AAAA,mBADA;AAEA,kBAAA,qBAAA,EAAA;AAAA,yBAAA,KAAA,CAAA,WAAA;AAAA,wCAAA,KAAA;AAAA,4BAAA;AAAA;AAFA,iBAHA;AAAA;AAAA,uBAOA,KAAA,CAAA,QAAA,CAAA,GAAA,CAAA,GAAA,CAAA,OAAA,EAAA,IAAA,EAAA,SAAA,CAPA;;AAAA;AAOA,gBAAA,QAPA;;AAAA,oBAQA,QARA;AAAA;AAAA;AAAA;;AASA,gBAAA,KAAA,CAAA,sBAAA,GAAA,IAAA;AATA;AAAA;;AAAA;AAAA;AAAA,uBAYA,QAZA;;AAAA;AAYA,gBAAA,MAZA;AAaA,gBAAA,IAbA,GAaA,MAAA,CAAA,IAAA,CAAA,IAbA;AAcA,gBAAA,OAdA,GAcA,EAdA;;AAeA,oBAAA,IAAA,CAAA,MAAA,KAAA,CAAA,IAAA,KAAA,CAAA,UAAA,GAAA,EAAA,EAAA;AACA,kBAAA,KAAA,CAAA,eAAA,GAAA,IAAA;AACA,kBAAA,KAAA,CAAA,sBAAA,GAAA,mCAAA;AACA,iBAHA,MAGA;AACA,kBAAA,KAAA,CAAA,eAAA,GAAA,KAAA;;AACA,uBAAA,CAAA,GAAA,CAAA,EAAA,GAAA,GAAA,IAAA,CAAA,MAAA,EAAA,CAAA,GAAA,GAAA,EAAA,CAAA,EAAA,EAAA;AACA,oBAAA,IADA,GACA,IAAA,CAAA,CAAA,CAAA,CAAA,OADA;;AAEA,wBAAA,cAAA,IAAA,EAAA;AACA,2BAAA,OAAA,GAAA,CAAA,EAAA,WAAA,GAAA,IAAA,CAAA,QAAA,CAAA,MAAA,EAAA,OAAA,GAAA,WAAA,EAAA,OAAA,EAAA,EAAA;AACA,4BAAA,IAAA,CAAA,QAAA,CAAA,OAAA,EAAA,UAAA,IAAA,KAAA,CAAA,UAAA,EAAA;AACA,0BAAA,OAAA,CAAA,IAAA,CAAA;AAAA,oCAAA,IAAA,CAAA,QAAA,CAAA,OAAA,EAAA,IAAA;AAAA,yCAAA,IAAA,CAAA;AAAA,2BAAA;AACA;AACA;AACA;;AACA,wBAAA,WAAA,IAAA,EAAA;AACA,0BAAA,IAAA,CAAA,KAAA,CAAA,UAAA,GAAA,KAAA,CAAA,UAAA,EAAA;AACA,wBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,kCAAA,OAAA;AAAA,uCAAA,IAAA,CAAA;AAAA,yBAAA;AACA;AACA;;AACA,wBAAA,gBAAA,IAAA,EAAA;AACA,0BAAA,IAAA,CAAA,UAAA,CAAA,UAAA,GAAA,KAAA,CAAA,UAAA,EAAA;AACA,wBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,kCAAA,YAAA;AAAA,uCAAA,IAAA,CAAA;AAAA,yBAAA;AACA;AACA;;AACA,wBAAA,cAAA,IAAA,EAAA;AACA,0BAAA,IAAA,CAAA,QAAA,CAAA,UAAA,GAAA,KAAA,CAAA,UAAA,EAAA;AACA,wBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,kCAAA,UAAA;AAAA,uCAAA,IAAA,CAAA;AAAA,yBAAA;AACA;AACA;;AACA,wBAAA,eAAA,IAAA,EAAA;AACA,0BAAA,IAAA,CAAA,SAAA,CAAA,UAAA,GAAA,KAAA,CAAA,UAAA,EAAA;AACA,wBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,kCAAA,WAAA;AAAA,uCAAA,IAAA,CAAA;AAAA,yBAAA;AACA;AACA;;AACA,wBAAA,cAAA,IAAA,EAAA;AACA,0BAAA,IAAA,CAAA,QAAA,CAAA,UAAA,GAAA,KAAA,CAAA,UAAA,EAAA;AACA,wBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,kCAAA,UAAA;AAAA,uCAAA,IAAA,CAAA;AAAA,yBAAA;AACA;AACA;;AACA,wBAAA,WAAA,IAAA,EAAA;AACA,0BAAA,IAAA,CAAA,KAAA,CAAA,UAAA,GAAA,KAAA,CAAA,UAAA,EAAA;AACA,wBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,kCAAA,OAAA;AAAA,uCAAA,IAAA,CAAA;AAAA,yBAAA;AACA;AACA;;AACA,wBAAA,gBAAA,IAAA,EAAA;AACA,0BAAA,IAAA,CAAA,UAAA,CAAA,UAAA,GAAA,KAAA,CAAA,UAAA,EAAA;AACA,wBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,kCAAA,YAAA;AAAA,uCAAA,IAAA,CAAA;AAAA,yBAAA;AACA;AACA;;AACA,wBAAA,YAAA,IAAA,EAAA;AACA,sBAAA,OAAA,CAAA,IAAA,CAAA;AAAA,gCAAA,IAAA,CAAA,MAAA,CAAA,KAAA;AAAA,qCAAA,IAAA,CAAA;AAAA,uBAAA;AACA;;AACA,wBAAA,iBAAA,IAAA,EAAA;AACA,sBAAA,OAAA,CAAA,IAAA,CAAA;AACA,gCAAA,MADA;AAEA,qCAAA,IAAA,CAAA,SAFA;AAGA,sCAAA,IAAA,CAAA,UAHA;AAIA,uCAAA;AACA,mCAAA,IAAA,CAAA,WAAA,CAAA,KADA;AAEA,oCAAA,IAAA,CAAA,WAAA,CAAA,MAFA;AAGA,kCAAA,IAAA,CAAA,WAAA,CAAA,IAHA;AAIA,iCAAA,IAAA,CAAA,WAAA,CAAA;AAJA;AAJA,uBAAA;AAWA;AACA;AACA;;AACA,gBAAA,KAAA,CAAA,kBAAA,GAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,OAAA,CAAA,CAAA;AACA,gBAAA,KAAA,CAAA,MAAA,GAAA,KAAA;;AAnFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqFA,KA3FA;AA4FA,IAAA,cA5FA,0BA4FA,UA5FA,EA4FA;AACA,UAAA,CAAA,KAAA,eAAA,CAAA,QAAA,CAAA,UAAA,CAAA,EAAA;AACA,aAAA,eAAA,CAAA,IAAA,CAAA,UAAA;AACA;AACA,KAhGA;AAiGA,IAAA,WAjGA,uBAiGA,YAjGA,EAiGA,WAjGA,EAiGA;AACA,WAAA,qBAAA,GAAA,YAAA;AACA,WAAA,YAAA,GAAA,WAAA;AACA,KApGA;AAqGA,IAAA,QArGA,sBAqGA;AACA,UAAA,kBAAA,GAAA,IAAA,CAAA,SAAA,CAAA,KAAA,kBAAA,CAAA;AACA,UAAA,IAAA,GAAA,IAAA,IAAA,CAAA,CAAA,kBAAA,CAAA,EAAA;AAAA,QAAA,IAAA,EAAA;AAAA,OAAA,CAAA;AACA,UAAA,CAAA,GAAA,QAAA,CAAA,WAAA,CAAA,aAAA,CAAA;AAAA,UACA,CAAA,GAAA,QAAA,CAAA,aAAA,CAAA,GAAA,CADA;AAEA,MAAA,CAAA,CAAA,QAAA,GAAA,WAAA;AACA,MAAA,CAAA,CAAA,IAAA,GAAA,MAAA,CAAA,GAAA,CAAA,eAAA,CAAA,IAAA,CAAA;AACA,MAAA,CAAA,CAAA,OAAA,CAAA,WAAA,GAAA,CAAA,WAAA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,IAAA,EAAA,IAAA,CAAA,GAAA,CAAA;AACA,MAAA,CAAA,CAAA,SAAA,CAAA,OAAA,EAAA,IAAA,EAAA,KAAA,EAAA,MAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,CAAA,EAAA,IAAA;AACA,MAAA,CAAA,CAAA,aAAA,CAAA,CAAA;AACA,KA/GA;AAgHA,IAAA,gBAhHA,4BAgHA,KAhHA,EAgHA;AACA,WAAA,MAAA,GAAA,IAAA;AACA,WAAA,UAAA,GAAA,KAAA,CAAA,MAAA,CAAA,KAAA;;AACA,UAAA,KAAA,SAAA,KAAA,OAAA,EAAA;AACA;AACA,aAAA,MAAA,CAAA,OAAA,CAAA,SAAA;AACA;;AACA,WAAA,cAAA;AACA,WAAA,cAAA;AACA,KAzHA;AA0HA;AACA,IAAA,aA3HA,yBA2HA,KA3HA,EA2HA;AACA;AACA,WAAA,eAAA,GAAA,EAAA;AACA,MAAA,aAAA,CAAA,KAAA,qBAAA,CAAA;AACA,UAAA,MAAA,GAAA,QAAA,CAAA,cAAA,CAAA,QAAA,CAAA;AACA,UAAA,GAAA,GAAA,MAAA,CAAA,UAAA,CAAA,IAAA,CAAA;AACA,MAAA,GAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA;AACA,MAAA,GAAA,CAAA,WAAA,GAAA,KAAA;AACA,MAAA,GAAA,CAAA,IAAA,GAAA,YAAA;AACA,MAAA,GAAA,CAAA,SAAA,GAAA,QAAA;AACA,MAAA,GAAA,CAAA,YAAA,GAAA,QAAA;AACA,MAAA,GAAA,CAAA,SAAA,GAAA,KAAA;;AACA,UAAA,KAAA,aAAA,KAAA,KAAA,EAAA;AACA;AACA,aAAA,aAAA,GAAA,EAAA;AACA;AACA;;AACA,WAAA,aAAA,GAAA,KAAA,CAjBA,CAkBA;;AACA,UAAA,MAAA,GAAA,IAAA,GAAA,EAAA;AACA,UAAA,OAAA,GAAA,EAAA;AACA,UAAA,OAAA,GAAA,KAAA,kBAAA;AACA,UAAA,QAAA,GAAA,CAAA;AACA,UAAA,CAAA,GAAA,CAAA;AACA,MAAA,OAAA,CAAA,OAAA,CAAA,UAAA,MAAA,EAAA;AACA,YAAA,MAAA,CAAA,IAAA,KAAA,KAAA,EAAA;AACA,UAAA,OAAA,CAAA,IAAA,CAAA;AAAA,oBAAA,MAAA,CAAA,SAAA,GAAA,IAAA;AAAA,oBAAA,MAAA,CAAA,IAAA;AAAA,2BAAA,MAAA,CAAA;AAAA,WAAA,EADA,CAEA;;AACA,cAAA,MAAA,CAAA,WAAA,EAAA;AACA;AACA,gBAAA,KAAA,SAAA,KAAA,OAAA,EAAA;AACA,kBAAA,OAAA,GAAA;AACA,4BAAA,CADA;AAEA,wBAAA,MAAA,CAAA,IAFA;AAGA,8BAAA,CAAA,MAAA,CAAA,UAAA,GAAA,CAAA,EAAA,OAAA,CAAA,CAAA,CAHA;AAIA,qBAAA,MAAA,CAAA,WAAA,CAAA,IAAA,GAAA,MAAA,CAAA,KAJA;AAKA,qBAAA,MAAA,CAAA,WAAA,CAAA,GAAA,GAAA,MAAA,CAAA,MALA;AAMA,yBAAA,MAAA,CAAA,WAAA,CAAA,KAAA,GAAA,MAAA,CAAA,KANA;AAOA,0BAAA,MAAA,CAAA,WAAA,CAAA,MAAA,GAAA,MAAA,CAAA;AAPA,eAAA;AASA,cAAA,MAAA,CAAA,GAAA,CAAA,CAAA,EAAA,EAAA,CAAA,OAAA,CAAA;AACA,aAXA,MAWA;AACA;AACA,kBAAA,SAAA,GAAA,IAAA,CAAA,KAAA,CAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAAA;;AACA,kBAAA,MAAA,CAAA,GAAA,CAAA,SAAA,CAAA,EAAA;AACA,oBAAA,QAAA,GAAA;AACA,8BAAA,QAAA,EADA;AAEA,+BAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAFA;AAGA,0BAAA,MAAA,CAAA,IAHA;AAIA,gCAAA,CAAA,MAAA,CAAA,UAAA,GAAA,CAAA,EAAA,OAAA,CAAA,CAAA,CAJA;AAKA,uBAAA,MAAA,CAAA,WAAA,CAAA,IAAA,GAAA,MAAA,CAAA,KALA;AAMA,uBAAA,MAAA,CAAA,WAAA,CAAA,GAAA,GAAA,MAAA,CAAA,MANA;AAOA,2BAAA,MAAA,CAAA,WAAA,CAAA,KAAA,GAAA,MAAA,CAAA,KAPA;AAQA,4BAAA,MAAA,CAAA,WAAA,CAAA,MAAA,GAAA,MAAA,CAAA;AARA,iBAAA;AAUA,gBAAA,MAAA,CAAA,GAAA,CAAA,SAAA,EAAA,IAAA,CAAA,QAAA;AACA,eAZA,MAYA;AACA,gBAAA,QAAA,GAAA,CAAA;AACA,oBAAA,SAAA,GAAA;AACA,8BAAA,QAAA,EADA;AAEA,+BAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAFA;AAGA,0BAAA,MAAA,CAAA,IAHA;AAIA,gCAAA,CAAA,MAAA,CAAA,UAAA,GAAA,CAAA,EAAA,OAAA,CAAA,CAAA,CAJA;AAKA,uBAAA,MAAA,CAAA,WAAA,CAAA,IAAA,GAAA,MAAA,CAAA,KALA;AAMA,uBAAA,MAAA,CAAA,WAAA,CAAA,GAAA,GAAA,MAAA,CAAA,MANA;AAOA,2BAAA,MAAA,CAAA,WAAA,CAAA,KAAA,GAAA,MAAA,CAAA,KAPA;AAQA,4BAAA,MAAA,CAAA,WAAA,CAAA,MAAA,GAAA,MAAA,CAAA;AARA,iBAAA;AAUA,gBAAA,MAAA,CAAA,GAAA,CAAA,SAAA,EAAA,CAAA,SAAA,CAAA;AACA;AACA;AACA;AACA;AACA,OAjDA,CAiDA,IAjDA,CAiDA,IAjDA,CAAA;;AAkDA,UAAA,MAAA,CAAA,IAAA,GAAA,CAAA,EAAA;AACA,aAAA,SAAA,CAAA,MAAA;AACA,OA5EA,CA6EA;;;AACA,UAAA,KAAA,SAAA,KAAA,OAAA,EAAA;AACA;AACA,aAAA,MAAA,CAAA,OAAA,CAAA,SAAA;AACA,aAAA,MAAA,CAAA,OAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,KA9MA;AA+MA,IAAA,SAAA,EAAA,mBAAA,MAAA,EAAA;AACA,UAAA,MAAA,GAAA,QAAA,CAAA,cAAA,CAAA,QAAA,CAAA;AACA,UAAA,GAAA,GAAA,MAAA,CAAA,UAAA,CAAA,IAAA,CAAA,CAFA,CAGA;;AACA,UAAA,KAAA,SAAA,KAAA,OAAA,EAAA;AACA,QAAA,GAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA;AACA,QAAA,GAAA,CAAA,SAAA;AACA,QAAA,GAAA,CAAA,WAAA,GAAA,KAAA;AACA,QAAA,GAAA,CAAA,IAAA,GAAA,YAAA;AACA,QAAA,GAAA,CAAA,SAAA,GAAA,QAAA;AACA,QAAA,GAAA,CAAA,YAAA,GAAA,QAAA;AACA,QAAA,GAAA,CAAA,SAAA,GAAA,KAAA,CAPA,CAQA;;AACA,QAAA,MAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA,cAAA,MAAA,GAAA,CAAA,CAAA,CAAA,CAAA;;AACA,cAAA,MAAA,EAAA;AACA,YAAA,GAAA,CAAA,IAAA,CAAA,MAAA,CAAA,CAAA,EAAA,MAAA,CAAA,CAAA,EAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA,EADA,CAEA;;AACA,YAAA,GAAA,CAAA,QAAA,CAAA,MAAA,CAAA,IAAA,GAAA,IAAA,GAAA,MAAA,CAAA,UAAA,GAAA,IAAA,EAAA,MAAA,CAAA,CAAA,GAAA,MAAA,CAAA,KAAA,GAAA,CAAA,EAAA,MAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,MAAA;AACA;AACA,SARA,EATA,CAkBA;;AACA;AACA,OAxBA,CAyBA;;;AACA,UAAA,KAAA,qBAAA,KAAA,SAAA,EAAA;AACA;AACA,QAAA,aAAA,CAAA,KAAA,qBAAA,CAAA;AACA,OA7BA,CA8BA;;;AACA,UAAA,WAAA,GAAA,GAAA;AACA,UAAA,kBAAA,GAAA,CAAA;AACA,UAAA,CAAA,GAAA,CAAA;AACA,WAAA,qBAAA,GAAA,WAAA,CAAA,YAAA;AACA,QAAA,CAAA,GADA,CAEA;;AACA,YAAA,CAAA,KAAA,MAAA,CAAA,MAAA,EAAA,IAAA,CAAA,GAAA,kBAAA,KAAA,CAAA,EAAA;AACA,UAAA,CAAA,GAAA,CAAA;AACA,UAAA,GAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA;AACA,UAAA,GAAA,CAAA,SAAA;AACA,UAAA,GAAA,CAAA,WAAA,GAAA,KAAA;AACA,UAAA,GAAA,CAAA,IAAA,GAAA,YAAA;AACA,UAAA,GAAA,CAAA,SAAA,GAAA,QAAA;AACA,UAAA,GAAA,CAAA,YAAA,GAAA,QAAA;AACA,UAAA,GAAA,CAAA,SAAA,GAAA,KAAA;AACA,SAZA,CAaA;;;AACA,YAAA,gBAAA,GAAA,IAAA,CAAA,KAAA,CAAA,KAAA,MAAA,CAAA,WAAA,KAAA,IAAA,CAAA,CAdA,CAeA;;AACA,YAAA,MAAA,CAAA,GAAA,CAAA,gBAAA,CAAA,EAAA;AACA,UAAA,CAAA,GAAA,CAAA;AACA,UAAA,GAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA;AACA,UAAA,GAAA,CAAA,SAAA;AACA,UAAA,GAAA,CAAA,WAAA,GAAA,KAAA;AACA,UAAA,GAAA,CAAA,IAAA,GAAA,YAAA;AACA,UAAA,GAAA,CAAA,SAAA,GAAA,QAAA;AACA,UAAA,GAAA,CAAA,YAAA,GAAA,QAAA;AACA,UAAA,GAAA,CAAA,SAAA,GAAA,KAAA,CARA,CASA;;AACA,cAAA,aAAA,GAAA,MAAA,CAAA,GAAA,CAAA,gBAAA,CAAA,CAAA,GAAA,CAAA,UAAA,IAAA;AAAA,mBAAA,IAAA,CAAA,QAAA;AAAA,WAAA,EAAA,MAAA,CAAA,UAAA,CAAA,EAAA,CAAA,EAAA,CAAA;AAAA,mBAAA,CAAA,CAAA,OAAA,CAAA,CAAA,MAAA,CAAA;AAAA,WAAA,CAAA,CAVA,CAWA;;AACA,UAAA,aAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA;AACA;AACA,gBAAA,KAAA,GAAA,MAAA,CAAA,GAAA,CAAA,gBAAA,EAAA,MAAA,CAAA,UAAA,GAAA;AAAA,qBAAA,GAAA,CAAA,QAAA,KAAA,CAAA;AAAA,aAAA,CAAA;AACA,YAAA,KAAA,CAAA,OAAA,CAAA,UAAA,MAAA,EAAA;AACA,kBAAA,MAAA,EAAA;AACA,gBAAA,GAAA,CAAA,IAAA,CAAA,MAAA,CAAA,CAAA,EAAA,MAAA,CAAA,CAAA,EAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA,EADA,CAEA;;AACA,gBAAA,GAAA,CAAA,QAAA,CAAA,MAAA,CAAA,IAAA,GAAA,IAAA,GAAA,MAAA,CAAA,UAAA,GAAA,IAAA,EAAA,MAAA,CAAA,CAAA,GAAA,MAAA,CAAA,KAAA,GAAA,CAAA,EAAA,MAAA,CAAA,CAAA,GAAA,EAAA;AACA;AACA,aANA;AAOA,WAXA;AAYA,UAAA,GAAA,CAAA,MAAA;AACA;AACA,OA1CA,CA0CA,IA1CA,CA0CA,IA1CA,CAAA,EA0CA,WA1CA,CAAA;AA2CA,KA5RA;AA6RA,IAAA,SA7RA,uBA6RA;AACA,UAAA,UAAA,GAAA,IAAA,GAAA,EAAA;;AACA,eAAA,aAAA,CAAA,WAAA,EAAA;AACA,YAAA,UAAA,CAAA,GAAA,CAAA,WAAA,CAAA,EAAA;AACA,UAAA,UAAA,CAAA,GAAA,CAAA,WAAA,EAAA;AAAA,iBAAA,WAAA;AAAA,iBAAA,UAAA,CAAA,GAAA,CAAA,WAAA,EAAA,CAAA,GAAA;AAAA,WAAA;AACA,SAFA,MAEA;AACA,UAAA,UAAA,CAAA,GAAA,CAAA,WAAA,EAAA;AAAA,iBAAA,WAAA;AAAA,iBAAA;AAAA,WAAA;AACA;AACA;;AACA,UAAA,OAAA,GAAA,KAAA,kBAAA;AACA,MAAA,OAAA,CAAA,OAAA,CAAA,UAAA,MAAA,EAAA;AACA;AACA,YAAA,WAAA,GAAA,IAAA,CAAA,KAAA,CAAA,MAAA,CAAA,SAAA,CAAA;;AACA,YAAA,KAAA,aAAA,EAAA;AACA;AACA,cAAA,MAAA,CAAA,IAAA,KAAA,KAAA,aAAA,EAAA;AACA,YAAA,aAAA,CAAA,WAAA,CAAA;AACA;AACA,SALA,MAKA;AACA;AACA,UAAA,aAAA,CAAA,WAAA,CAAA;AACA;AACA,OAZA,CAYA,IAZA,CAYA,IAZA,CAAA,EAVA,CAuBA;;AACA,UAAA,kBAAA,GAAA,IAAA,GAAA,CAAA,mBAAA,UAAA,CAAA,OAAA,EAAA,EAAA,KAAA,GAAA,IAAA,CAAA,UAAA,CAAA,EAAA,CAAA;AAAA,eAAA,CAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA,CAAA,CAAA;AAAA,OAAA,CAAA,CAAA;AACA,UAAA,WAAA,GAAA,KAAA,CAAA,IAAA,CAAA,kBAAA,CAAA,MAAA,EAAA,CAAA;AACA,WAAA,MAAA,CAAA,MAAA,CAAA,kBAAA,EAAA,WAAA;AACA,WAAA,MAAA,CAAA,MAAA,CAAA,qBAAA,EAAA,KAAA,aAAA;AACA;AAzTA;AApFA,CAAA","sourcesContent":["<template>\n  <b-container fluid>\n    <b-col>\n      <b-row\n        align-h=\"center\"\n        class=\"my-1\"\n      >\n        <div class=\"wrapper\">\n          Confidence Threshold<br>\n          <input\n            type=\"range\"\n            value=\"90\"\n            min=\"55\"\n            max=\"99\"\n            step=\"1\"\n            @click=\"updateConfidence\"\n          >\n          {{ Confidence }}%<br>\n        </div>\n      </b-row>\n      <div v-if=\"lowerConfidence === true\">\n        {{ lowerConfidenceMessage }}\n      </div>\n      <div\n        v-if=\"isBusy\"\n        class=\"wrapper\"\n      >\n        <Loading />\n      </div>\n      <b-row\n        align-h=\"center\"\n        class=\"my-1\"\n      >\n        <div class=\"wrapper\">\n          <br>\n          <template v-for=\"label in sorted_unique_labels\">\n            <template v-if=\"boxes_available.includes(label[0])\">\n              <!-- Show darker button outline if boxes are available for the label -->\n              <b-button\n                v-b-tooltip.hover\n                variant=\"outline-dark\"\n                :title=\"label[1]\"\n                size=\"sm\"\n                pill\n                @click=\"updateMarkers(label[0])\"\n              >\n                {{ label[0]+\"*\" }}\n              </b-button> &nbsp;\n            </template>\n            <template v-else>\n              <b-button\n                v-b-tooltip.hover\n                variant=\"outline-secondary\"\n                :title=\"label[1]\"\n                size=\"sm\"\n                pill\n                @click=\"updateMarkers(label[0])\"\n              >\n                {{ label[0] }}\n              </b-button> &nbsp;\n            </template>\n          </template>\n        </div>\n      </b-row>\n      <b-row\n        align-h=\"center\"\n        class=\"my-1\"\n      >\n        <div\n          v-if=\"isBusy === false\"\n          class=\"wrapper\"\n        >\n          <br><p class=\"text-muted\">\n            ({{ count_labels }} identified objects, {{ count_distinct_labels }} unique)\n          </p>\n          <hr>\n          <p class=\"text-muted\">\n            * Indicates bounding boxes are available.\n          </p>\n        </div>\n      </b-row>\n    </b-col>\n    <b-button\n      type=\"button\"\n      @click=\"saveFile()\"\n    >\n      Download Data\n    </b-button>\n    <br>\n    <b-button\n        :pressed=\"false\"\n        size=\"sm\"\n        variant=\"link\"\n        class=\"text-decoration-none\"\n        @click=\"showElasticsearchApiRequest = true\"\n    >\n      Show API request to get these results\n    </b-button>\n    <b-modal\n        v-model=\"showElasticsearchApiRequest\"\n        scrollable\n        title=\"SEARCH API\"\n        ok-only\n    >\n      <label>Request URL:</label>\n      <pre v-highlightjs><code class=\"bash\">GET {{ SEARCH_ENDPOINT }}workflow/execution</code></pre>\n      <label>Search query:</label>\n      <pre v-highlightjs=\"JSON.stringify(searchQuery)\"><code class=\"json\"></code></pre>\n      <label>Sample command:</label>\n      <pre v-highlightjs=\"curlCommand\"><code class=\"bash\"></code></pre>\n    </b-modal>\n  </b-container>\n</template>\n\n<script>\n  import Loading from '@/components/Loading.vue'\n  import { mapState } from 'vuex'\n\n  export default {\n    name: \"FaceDetection\",\n    components: {\n      Loading\n    },\n    props: {\n      mediaType: {\n        type: String,\n        default: \"\"\n      },\n    },\n    data() {\n      return {\n        curlCommand: '',\n        searchQuery: '',\n        showElasticsearchApiRequest: false,\n        Confidence: 90,\n        high_confidence_data: [],\n        elasticsearch_data: [],\n        count_distinct_labels: 0,\n        count_labels: 0,\n        isBusy: false,\n        operator: 'face_detection',\n        canvasRefreshInterval: undefined,\n        timeseries: new Map(),\n        selectedLabel: '',\n        boxes_available: [],\n        lowerConfidence: false,\n        lowerConfidenceMessage: 'Try lowering confidence threshold'\n      }\n    },\n    computed: {\n      ...mapState(['player']),\n      sorted_unique_labels() {\n        // This function sorts and counts unique labels for mouse over events on label buttons\n        const es_data = this.elasticsearch_data;\n        const unique_labels = new Map();\n        // sort and count unique labels for label mouse over events\n        es_data.forEach(function (record) {\n          unique_labels.set(record.Name, unique_labels.get(record.Name) ? unique_labels.get(record.Name) + 1 : 1);\n          if (record.BoundingBox) {\n            // Save this label name to a list of labels that have bounding boxes\n            this.saveBoxedLabel(record.Name)\n          }\n        }.bind(this));\n        const sorted_unique_labels = new Map([...unique_labels.entries()].slice().sort((a, b) => b[1] - a[1]));\n        // If Elasticsearch returned undefined labels then delete them:\n        sorted_unique_labels.delete(undefined);\n        this.countLabels(sorted_unique_labels.size, es_data.length);\n        return sorted_unique_labels\n      }\n    },\n    watch: {\n      // These watches update the line chart\n      selectedLabel: function() {\n        this.chartData();\n      },\n      elasticsearch_data: function() {\n        this.chartData();\n      },\n    },\n    deactivated: function () {\n      console.log('activated component:', this.operator);\n      this.boxes_available = [];\n      this.selectedLabel = '';\n      clearInterval(this.canvasRefreshInterval);\n      const canvas = document.getElementById('canvas');\n      let ctx;\n      if (canvas) ctx = canvas.getContext('2d');\n      if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);\n    },\n    activated: function () {\n      console.log('activated component:', this.operator);\n      this.fetchAssetData();\n    },\n    mounted: function() {\n      this.getCurlCommand();\n    },\n    beforeDestroy: function () {\n      this.high_confidence_data = [];\n      this.elasticsearch_data = [];\n      this.count_distinct_labels = 0;\n      this.count_labels = 0;\n    },\n    methods: {\n      getCurlCommand() {\n        this.searchQuery = 'AssetId:'+this.$route.params.asset_id+' Confidence:>'+this.Confidence+' Operator:'+this.operator;\n        // get curl command to search elasticsearch\n        this.curlCommand = 'awscurl -X GET --profile default --service es --region ' + this.AWS_REGION + ' \\'' + this.SEARCH_ENDPOINT + '/_search?q=' + encodeURIComponent(this.searchQuery) + '\\''\n      },\n      async fetchAssetData () {\n          let apiName = 'contentAnalysisElasticsearch';\n          let path = '/_search';\n          let apiParams = {\n            headers: {'Content-Type': 'application/json'},\n            queryStringParameters: {'q': this.searchQuery, 'default_operator': 'AND', 'size': 10000}\n          };\n          let response = await this.$Amplify.API.get(apiName, path, apiParams);\n          if (!response) {\n            this.showElasticSearchAlert = true\n          }\n          else {\n            let result = await response;\n            let data = result.hits.hits;\n            let es_data = [];\n            if (data.length === 0 && this.Confidence > 55) {\n              this.lowerConfidence = true;\n              this.lowerConfidenceMessage = 'Try lowering confidence threshold'\n            } else {\n              this.lowerConfidence = false;\n              for (let i = 0, len = data.length; i < len; i++) {\n                let item = data[i]._source;\n                if (\"Emotions\" in item) {\n                  for (let emotion = 0, emotionsLen = item.Emotions.length; emotion < emotionsLen; emotion++) {\n                    if (item.Emotions[emotion].Confidence >= this.Confidence) {\n                      es_data.push({\"Name\": item.Emotions[emotion].Type, \"Timestamp\": item.Timestamp})\n                    }\n                  }\n                }\n                if (\"Beard\" in item) {\n                  if (item.Beard.Confidence > this.Confidence) {\n                    es_data.push({\"Name\": \"Beard\", \"Timestamp\": item.Timestamp})\n                  }\n                }\n                if (\"Eyeglasses\" in item) {\n                  if (item.Eyeglasses.Confidence > this.Confidence) {\n                    es_data.push({\"Name\": \"Eyeglasses\", \"Timestamp\": item.Timestamp})\n                  }\n                }\n                if (\"EyesOpen\" in item) {\n                  if (item.EyesOpen.Confidence > this.Confidence) {\n                    es_data.push({\"Name\": \"EyesOpen\", \"Timestamp\": item.Timestamp})\n                  }\n                }\n                if (\"MouthOpen\" in item) {\n                  if (item.MouthOpen.Confidence > this.Confidence) {\n                    es_data.push({\"Name\": \"MouthOpen\", \"Timestamp\": item.Timestamp})\n                  }\n                }\n                if (\"Mustache\" in item) {\n                  if (item.Mustache.Confidence > this.Confidence) {\n                    es_data.push({\"Name\": \"Mustache\", \"Timestamp\": item.Timestamp})\n                  }\n                }\n                if (\"Smile\" in item) {\n                  if (item.Smile.Confidence > this.Confidence) {\n                    es_data.push({\"Name\": \"Smile\", \"Timestamp\": item.Timestamp})\n                  }\n                }\n                if (\"Sunglasses\" in item) {\n                  if (item.Sunglasses.Confidence > this.Confidence) {\n                    es_data.push({\"Name\": \"Sunglasses\", \"Timestamp\": item.Timestamp})\n                  }\n                }\n                if (\"Gender\" in item) {\n                  es_data.push({\"Name\": item.Gender.Value, \"Timestamp\": item.Timestamp})\n                }\n                if (\"BoundingBox\" in item) {\n                  es_data.push({\n                    \"Name\": \"Face\",\n                    \"Timestamp\": item.Timestamp,\n                    \"Confidence\": item.Confidence,\n                    \"BoundingBox\": {\n                      \"Width\": item.BoundingBox.Width,\n                      \"Height\": item.BoundingBox.Height,\n                      \"Left\": item.BoundingBox.Left,\n                      \"Top\": item.BoundingBox.Top\n                    }\n                  })\n                }\n              }\n            }\n            this.elasticsearch_data = JSON.parse(JSON.stringify(es_data));\n            this.isBusy = false\n        }\n      },\n      saveBoxedLabel(label_name) {\n        if (!this.boxes_available.includes(label_name)) {\n          this.boxes_available.push(label_name);\n        }\n      },\n      countLabels(unique_count, total_count) {\n        this.count_distinct_labels = unique_count;\n        this.count_labels = total_count;\n      },\n      saveFile() {\n        const elasticsearch_data = JSON.stringify(this.elasticsearch_data);\n        const blob = new Blob([elasticsearch_data], {type: 'text/plain'});\n        const e = document.createEvent('MouseEvents'),\n          a = document.createElement('a');\n        a.download = \"data.json\";\n        a.href = window.URL.createObjectURL(blob);\n        a.dataset.downloadurl = ['text/json', a.download, a.href].join(':');\n        e.initEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n        a.dispatchEvent(e);\n      },\n      updateConfidence (event) {\n        this.isBusy = true;\n        this.Confidence = event.target.value;\n        if (this.mediaType === \"video\") {\n          // redraw markers on video timeline\n          this.player.markers.removeAll();\n        }\n        this.getCurlCommand()\n        this.fetchAssetData()\n      },\n      // updateMarkers updates markers in the video player and is called when someone clicks on a label button\n      updateMarkers (label) {\n        // clear canvas for redrawing\n        this.boxes_available = [];\n        clearInterval(this.canvasRefreshInterval);\n        const canvas = document.getElementById('canvas');\n        const ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.strokeStyle = \"red\";\n        ctx.font = \"15px Arial\";\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillStyle = \"red\";\n        if (this.selectedLabel === label) {\n          // keep the canvas clear canvas if user clicked the label button a second consecutive time\n          this.selectedLabel = \"\";\n          return\n        }\n        this.selectedLabel = label;\n        // initialize lists of boxes and markers to be drawn\n        const boxMap = new Map();\n        let markers = [];\n        const es_data = this.elasticsearch_data;\n        let instance = 0;\n        let i=0;\n        es_data.forEach(function (record) {\n          if (record.Name === label) {\n            markers.push({'time': record.Timestamp/1000, 'text': record.Name, 'overlayText': record.Name});\n            // Save bounding box info if it exists\n            if (record.BoundingBox) {\n              // TODO: move image processing to a separate component\n              if (this.mediaType === \"image\") {\n                const boxinfo = {\n                  'instance': i,\n                  'name': record.Name,\n                  'confidence': (record.Confidence * 1).toFixed(2),\n                  'x': record.BoundingBox.Left * canvas.width,\n                  'y': record.BoundingBox.Top * canvas.height,\n                  'width': record.BoundingBox.Width * canvas.width,\n                  'height': record.BoundingBox.Height * canvas.height\n                };\n                boxMap.set(i++, [boxinfo])\n              } else {\n                // Use time resolution of 0.1 second\n                const timestamp = Math.round(record.Timestamp / 100);\n                if (boxMap.has(timestamp)) {\n                  const boxinfo = {\n                    'instance': instance++,\n                    'timestamp': Math.ceil(record.Timestamp / 100),\n                    'name': record.Name,\n                    'confidence': (record.Confidence * 1).toFixed(2),\n                    'x': record.BoundingBox.Left * canvas.width,\n                    'y': record.BoundingBox.Top * canvas.height,\n                    'width': record.BoundingBox.Width * canvas.width,\n                    'height': record.BoundingBox.Height * canvas.height\n                  };\n                  boxMap.get(timestamp).push(boxinfo)\n                } else {\n                  instance = 0;\n                  const boxinfo = {\n                    'instance': instance++,\n                    'timestamp': Math.ceil(record.Timestamp / 100),\n                    'name': record.Name,\n                    'confidence': (record.Confidence * 1).toFixed(2),\n                    'x': record.BoundingBox.Left * canvas.width,\n                    'y': record.BoundingBox.Top * canvas.height,\n                    'width': record.BoundingBox.Width * canvas.width,\n                    'height': record.BoundingBox.Height * canvas.height\n                  };\n                  boxMap.set(timestamp, [boxinfo])\n                }\n              }\n            }\n          }\n        }.bind(this));\n        if (boxMap.size > 0) {\n          this.drawBoxes(boxMap);\n        }\n        // TODO: move image processing to a separate component\n        if (this.mediaType === \"video\") {\n          // redraw markers on video timeline\n          this.player.markers.removeAll();\n          this.player.markers.add(markers);\n        }\n      },\n      drawBoxes: function(boxMap) {\n        const canvas = document.getElementById('canvas');\n        const ctx = canvas.getContext('2d');\n        // TODO: move image processing to a separate component\n        if (this.mediaType === \"image\") {\n          ctx.clearRect(0, 0, canvas.width, canvas.height);\n          ctx.beginPath();\n          ctx.strokeStyle = \"red\";\n          ctx.font = \"15px Arial\";\n          ctx.textAlign = \"center\";\n          ctx.textBaseline = \"middle\";\n          ctx.fillStyle = \"red\";\n          // For each box instance...\n          boxMap.forEach( i => {\n            let drawMe = i[0];\n            if (drawMe) {\n              ctx.rect(drawMe.x, drawMe.y, drawMe.width, drawMe.height);\n              // Draw object name and confidence score\n              ctx.fillText(drawMe.name + \" (\" + drawMe.confidence + \"%)\", (drawMe.x + drawMe.width / 2), drawMe.y - 10);\n              ctx.stroke();\n            }\n          });\n          // now return so we avoid rendering any of the video related components below\n          return\n        }\n        // If user just clicked a new label...\n        if (this.canvasRefreshInterval !== undefined) {\n          // ...then reset the old canvas refresh interval.\n          clearInterval(this.canvasRefreshInterval)\n        }\n        // Look for and draw bounding boxes every 100ms\n        const interval_ms = 100;\n        const erase_on_iteration = 2;\n        let i = 0;\n        this.canvasRefreshInterval = setInterval(function () {\n          i++;\n          // erase old bounding boxes\n          if (!this.player.paused() && i % erase_on_iteration === 0) {\n            i=0;\n            ctx.clearRect(0, 0, canvas.width, canvas.height);\n            ctx.beginPath();\n            ctx.strokeStyle = \"red\";\n            ctx.font = \"15px Arial\";\n            ctx.textAlign = \"center\";\n            ctx.textBaseline = \"middle\";\n            ctx.fillStyle = \"red\";\n          }\n          // Get current player timestamp to the nearest 1/10th second\n          const player_timestamp = Math.round(this.player.currentTime()*10.0);\n          // If we have a box for the player's timestamp...\n          if (boxMap.has(player_timestamp)) {\n            i=0;\n            ctx.clearRect(0, 0, canvas.width, canvas.height);\n            ctx.beginPath();\n            ctx.strokeStyle = \"red\";\n            ctx.font = \"15px Arial\";\n            ctx.textAlign = \"center\";\n            ctx.textBaseline = \"middle\";\n            ctx.fillStyle = \"red\";\n            // ...then get a list of box instances\n            const instance_list = (boxMap.get(player_timestamp)).map( item => item.instance).filter((v, i, a) => a.indexOf(v) === i);\n            // For each box instance...\n            instance_list.forEach( i => {\n              // ...get all of the boxes belonging to this instance\n              // at the current timestamp.\n              const boxes = boxMap.get(player_timestamp).filter(box => box.instance === i);\n              boxes.forEach (drawMe => {\n                if (drawMe) {\n                  ctx.rect(drawMe.x, drawMe.y, drawMe.width, drawMe.height);\n                  // Draw object name and confidence score\n                  ctx.fillText(drawMe.name + \" (\" + drawMe.confidence + \"%)\", (drawMe.x + drawMe.width / 2), drawMe.y - 10);\n                }\n              })\n            });\n            ctx.stroke();\n          }\n        }.bind(this), interval_ms);\n      },\n      chartData() {\n        let timeseries = new Map();\n        function saveTimestamp (millisecond) {\n          if (timeseries.has(millisecond)) {\n            timeseries.set(millisecond, {\"x\": millisecond, \"y\": timeseries.get(millisecond).y + 1})\n          } else {\n            timeseries.set(millisecond, {\"x\": millisecond, \"y\":1})\n          }\n        }\n        const es_data = this.elasticsearch_data;\n        es_data.forEach( function(record) {\n          // Define timestamp with millisecond resolution\n          const millisecond = Math.round(record.Timestamp);\n          if (this.selectedLabel) {\n            // No label has been selected, so enumerate timestamps for all label names.\n            if (record.Name === this.selectedLabel) {\n              saveTimestamp(millisecond);\n            }\n          } else {\n            // Label is undefined. Enumerate timestamps for all label names.\n            saveTimestamp(millisecond);\n          }\n        }.bind(this));\n        //sort the timeseries map by its millisecond key\n        const ordered_timeseries = new Map([...timeseries.entries()].slice().sort((a, b) => a[0] - b[0]));\n        const chartTuples = Array.from(ordered_timeseries.values());\n        this.$store.commit('updateTimeseries', chartTuples);\n        this.$store.commit('updateSelectedLabel', this.selectedLabel);\n      },\n    }\n  }\n</script>\n"],"sourceRoot":"src/components"}]}